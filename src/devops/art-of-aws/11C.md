---
lang: ko-KR
title: 11C. S3 세부 설정하기
description: 아마존 웹 서비스를 다루는 기술 > 11C. S3 세부 설정하기
category:
  - AWS
tag: 
  - crashcourse
  - pyrasis
  - aws 
  - amazon-web-services
head:
  - - meta:
    - property: og:title
      content: 아마존 웹 서비스를 다루는 기술 > 11C. S3 세부 설정하기
    - property: og:description
      content: 11C. S3 세부 설정하기
    - property: og:url
      content: https://chanhi2000.github.io/crashcourse/devops/art-of-aws/11C.html
---

# {{ $frontmatter.title }} 관련

```component VPCard
{
  "title": "목차",
  "desc": "아마존 웹 서비스를 다루는 기술",
  "link": "/devops/art-of-aws/README.md",
  "logo": "https://pyrasis.com/assets/images/pyrasis.png",
  "background": "rgba(31,41,55,0.2)"
}
```

[[toc]]

---

```component VPCard
{
  "title": "11장 - 3. S3 세부 설정하기",
  "desc": "아마존 웹 서비스를 다루는 기술",
  "link": "https://pyrasis.com/book/TheArtOfAmazonWebServices/Chapter11/03",
  "logo": "https://pyrasis.com/favicon.ico",
  "background": "rgba(31,41,55,0.2)"
}
```

이제 S3의 다양한 기능을 활용해보겠습니다. S3는 버킷과 객체를 어떻게 설정하느냐에 따라 기능이 달라집니다. 권한 설정은 파일을 전체 공개하거나 특정 사용자에게만 공개하고 싶을 때 사용합니다. 그리고 버킷 정책을 설정하는 것에 따라 다양한 접근 제어가 가능합니다. 따라서 특정 도메인에서만 S3 객체를 링크할 수 있도록 허용하고 싶을 때, HTTP Referer(Referrer) 접근 제어 설정을 활용할 수 있습니다.

버킷을 정적 웹 서버(정적 웹 호스팅)로 사용하도록 설정하면 버킷 자체로 간단한 웹사이트 운영이 가능합니다. 또한, 버킷 로그 기록 그리고 객체의 스토리지 옵션, 버저닝, 수명 주기^Lifecycle^ 관리도 할 수 있습니다.

---

## S3 객체 권한 관리하기

S3에 올라간 파일을 객체라고 표현합니다. S3에서는 이 객체마다 각각의 접근 권한을 설정할 수 있습니다. 가장 간단한 예제로 S3에 올린 파일을 인터넷에 공개해보겠습니다. S3 버킷의 객체 목록에서 파일을 선택하고 위쪽의 Properties 버튼을 클릭하면 그림 11-17과 같이 객체의 세부 내용이 표시됩니다(파일을 선택하고 마우스 오른쪽 버튼을 클릭해서 나오는 팝업 메뉴에도 Properties가 있습니다). 여기서 Link 부분을 보면 그림 파일의 URL이 표시됩니다.

![이 링크를 클릭합니다.](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/17_.png)

웹 브라우저의 새 창이 열리고 링크의 내용이 표시됩니다.

![하지만 `AccessDenied`라는 에러가 표시되고 그림 파일은 열리지 않습니다.](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/18_.png)

S3 객체 목록에서 파일을 선택하고 마우스 오른쪽 버튼을 클릭하면 팝업 메뉴가 나옵니다(위쪽 Actions 버튼을 클릭해도 같은 메뉴가 나옵니다).

![<FontIcon icon="iconfont icon-select"/>`[Make Public]`를 클릭합니다. <FontIcon icon="iconfont icon-select"/>`[Make Public]`은 객체를 인터넷에 공개(Public)하겠다는 것입니다.](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/19_.png)

![파일을 공개하겠냐는 경고 창이 표시되면 <FontIcon icon="iconfont icon-select"/>`[확인]` 버튼을 클릭합니다.](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/20_.png)

Make Public이 완료되었다는 것이 오른쪽에 표시됩니다. 

![위의 <FontIcon icon="iconfont icon-select"/>`[Properties]` 버튼을 클릭합니다.](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/21_.png)

Link 부분을 보면 노란색 자물쇠 아이콘에서 파란색 전파 아이콘으로 바뀐 것을 확인할 수 있습니다. 

![이제 이 링크를 클릭합니다.](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/22_.png)

웹 브라우저에 S3 객체의 링크 내용이 잘 표시됩니다.

![이제 이 그림 파일은 인터넷에 공개된 상태이기 때문에 다른 곳에 링크를 가져가서 이 그림 파일을 보여줄 수 있습니다.](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/23_.png)

많은 파일을 하나하나 Make Public으로 설정하기에는 귀찮은 면이 있습니다. 이럴 때에는 처음에 파일을 올릴 때 S3 버킷에 파일 올리기 부분에서 Set Permissions 화면의 Make everything public에 체크하면 됩니다.

이미 파일을 올렸다면 S3 객체 목록은 파일을 여러 개 선택할 수 있으므로 공개하고자 하는 파일을 모두 선택한 뒤 Make Public으로 설정해주면 됩니다. 방금 공개한 그림 파일을 선택하고 <FontIcon icon="iconfont icon-select"/>`[Properties]` 버튼을 클릭한 뒤 <FontIcon icon="iconfont icon-select"/>`[Permissions]` 탭을 클릭합니다. 

![Grantee에 Everyone이 설정되어 있고 Open/Download가 체크되어 있는 것을 볼 수 있습니다. 이것은 Make Public을 실행하면 자동으로 설정됩니다.](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/24_.png)

.<FontIcon icon="iconfont icon-select"/>`[Permissions]` 탭에서 수동으로 Grantee에 Everyone을 설정하고 Open/Download에 체크한 후 <FontIcon icon="iconfont icon-select"/>`[Save]` 버튼을 클릭하면 Make Public을 실행한 것과 똑같은 효과를 가집니다.

.<FontIcon icon="iconfont icon-select"/>`[Permissions]` 탭에서 <FontIcon icon="iconfont icon-select"/>`[Add more permission]`를 클릭했을 때 다음 항목을 볼 수 있습니다.

- **Grantee**: 권한을 부여할 대상입니다. 보통 여기서는 Everyone과 자기 자신의 ID(Me도 자기자신의 ID를 뜻합니다.)을 선택합니다.
- 추가적으로 계정을 발급하여 계정 별로 권한을 부여하고 싶을 때가 있습니다. ['16장 사용자와 그룹을 생성하여 접근제어 및 권한관리를 제공하는 IAM'](16.md) 부분을 참조하여 계정을 생성하면 이곳에서 선택할 수 있게 됩니다. IAM 계정은 Access Key와 Secret Key를 이용하여 API로 접근 할 때 사용하게 됩니다.
- **Open/Download**: 파일을 열고 다운로드할 수 있는 권한입니다.
- **View Permissions**: 권한 내역을 볼 수 있는 권한입니다.
- **Edit Permissions**: 권한을 수정할 수 있는 권한입니다. 보통 이런 경우 S3 객체 목록을 이용하지 않고 IAM 계정을 통해 API로 접근하게 됩니다.

---

## S3 버킷 권한 관리하기

```component VPCard
{
  "title": "11장 - 3.2. S3 버킷 권한 관리하기",
  "desc": "아마존 웹 서비스를 다루는 기술",
  "link": "https://pyrasis.com/book/TheArtOfAmazonWebServices/Chapter11/03/02",
  "logo": "https://pyrasis.com/favicon.ico",
  "background": "rgba(31,41,55,0.2)"
}
```

이제 버킷에 권한을 설정해보겠습니다. 버킷에 권한을 설정하면 버킷 안에 든 모든 객체에 적용됩니다. 예제로 버킷의 내용 전체를 인터넷에 공개하는 방법을 알아보겠습니다.

['11.2 S3 버킷에 파일 올리기/받기'](11B.md)를 참조하여 버킷에 그림 파일을 하나 더 올립니다. 저는 <FontIcon icon="iconfont icon-flower"/>`Jellyfish.jpg`라는 그림 파일을 새로 올렸습니다. 새로 올린 파일을 선택하고 위쪽의 <FontIcon icon="iconfont icon-select"/>`[Properties]` 버튼을 클릭합니다. Link 부분을 보면 URL의 아이콘이 노란색 자물쇠 모양인 것을 확인할 수 있습니다. 

![이 링크를 클릭합니다.](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/25_.png)

![이 URL은 웹 브라우저로 접속해도 그림 파일이 열리지 않는 상태입니다.](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/26_.png)

위쪽의 All Bucket을 클릭하면 모든 버킷의 목록이 표시됩니다.

![버킷을 선택하고 위쪽의 <FontIcon icon="iconfont icon-select"/>`Properties` 버튼클 클릭한 뒤 <FontIcon icon="iconfont icon-select"/>`[Permissions]` 탭을 클릭합니다. 그리고 <FontIcon icon="iconfont icon-select"/>`[Add bucket policy]` 버튼을 클릭합니다(버킷을 선택하고 마우스 오른쪽 버튼을 클릭하면 나오는 팝업 메뉴에도 Properties가 있습니다).](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/27_.png)

::: info

Add more permissions를 클릭했을 때 나오는 내용은 '11.3.1 S3 객체 권한 관리하기'와 동일합니다. 단 여기서는 버킷 전체에 대해 설정하는 것이므로 버킷 안에 들어있는 모든 객체에 적용됩니다.

:::

버킷 정책 편집기^Bucket^ ^Policy^ ^Editor^가 표시됩니다. 이곳에 JSON^JavaScript^ ^Object^ ^Notation^ 형태의 정책을 입력하면 됩니다. 이 정책은 다소 복잡하기 때문에 AWS에서는 이 정책을 생성해주는 페이지를 제공하고 있습니다. 아래쪽 AWS Policy Generator 링크를 클릭합니다.

![Bucket Policy Editor](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/28_.png)

그림 11-19처럼 웹 브라우저의 새 창에서 AWS Policy Generator 페이지가 열렸습니다.

- **Select Type of Policy**: SNS Topic Policy, IAM Policy, SQS Queue Policy, S3 Bucket Policy를 선택할 수 있습니다. 여기서는 S3 Bucket Policy를 선택합니다.
- **Effect**: 허용(Allow), 거부(Deny)를 선택할 수 있습니다. 기본값 그대로 Allow를 선택합니다.
- **Principal**: 권한을 적용할 사용자입니다. IAM 계정을 사용할 수 있습니다. 여기서는 인터넷에 전체 공개할 것이므로 `*`을 입력합니다.
- **AWS Service**: 처음 Select Type of Policy를 선택하면 그에 맞는 서비스가 자동으로 선택됩니다. 기본값 그대로 사용합니다.
- **Actions**: S3의 모든 액션이 표시됩니다. 우리는 파일을 받는 액션만 사용할 것이므로 GetObject를 선택합니다.
- **Amazon Resource Name(ARN)**: 아마존의 리소스를 고유하게 표현하는 방식입니다. `arn:aws:s3:::examplebucket10/*`을 입력합니다. 이것은 AWS의 S3에서 examplebucket10 아래 모든 파일을 뜻합니다. `/*` 대신 `/Jellyfish.jpg` 등으로 특정 파일을 지정해 줄 수도 있습니다.

![AWS Policy Generator로 정책 생성](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/29_.png)

Add Conditions에서 UserAgent, SourceIP 등 다양한 조건을 사용할 수 있습니다. 여러분들이 필요할 때 하나하나 사용해보기 바랍니다. 

![설정이 완료되었으면 <FontIcon icon="iconfont icon-select"/>`[Add Statement]` 버튼을 클릭합니다.](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/30_.png)

설정한 내용이 Statements 목록에 추가되었습니다. 

![아래쪽 <FontIcon icon="iconfont icon-select"/>`[Generate Policy]` 버튼을 클릭합니다.](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/31_.png)

AWS 정책이 생성되었습니다. 이 JSON 텍스트를 전체 선택 한 뒤 복사합니다.

![JSON 형태의 AWS Policy](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/32_.png)

이제 다시 버킷 정책 편집기^Bucket^ ^Policy^ ^Editor^에 방금 AWS Policy Generator에서 복사한 JSON 텍스트를 붙여넣습니다. 

![붙여넣기가 완료되었다면 아래쪽 <FontIcon icon="iconfont icon-select"/>`[Save]` 버튼을 클릭합니다.](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/33_.png)

S3 버킷(`examplebucket10`)을 클릭하여 객체 목록으로 들어옵니다. 

![방금 올린 파일을 선택하고 위쪽 <FontIcon icon="iconfont icon-select"/>`[Properties]` 버튼을 클릭합니다. Link 부분을 보면 URL의 노란색 자물쇠 모양 아이콘이 사라졌습니다. 이제 이 링크를 클릭합니다.](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/34_.png)

웹 브라우저에서 그림 파일이 잘 표시됩니다. 

![버킷 전체를 공개하도록 권한 설정을 했으므로 이제부터 이 버킷에 올리는 모든 파일은 인터넷에 자동으로 공개됩니다.](https://pyrasis.com/assets/images/TheArtOfAmazonWebServicesChapter11/35_.png)

---

## S3 정적 웹사이트 호스팅 사용하기

```component VPCard
{
  "title": "11장 - 3.3. S3 정적 웹사이트 호스팅 사용하기",
  "desc": "아마존 웹 서비스를 다루는 기술",
  "link": "https://pyrasis.com/book/TheArtOfAmazonWebServices/Chapter11/03/03",
  "logo": "https://pyrasis.com/favicon.ico",
  "background": "rgba(31,41,55,0.2)"
}
```

---

## HTTP Referer로 S3 접근 제한하기

```component VPCard
{
  "title": "11장 - 3.4. HTTP Referer로 S3 접근 제한하기",
  "desc": "아마존 웹 서비스를 다루는 기술",
  "link": "https://pyrasis.com/book/TheArtOfAmazonWebServices/Chapter11/03/04",
  "logo": "https://pyrasis.com/favicon.ico",
  "background": "rgba(31,41,55,0.2)"
}
```

---

## S3 객체 스토리지 클래스, 암호화 설정하기

```component VPCard
{
  "title": "11장 - 3.5. S3 객체 스토리지 클래스, 암호화 설정하기",
  "desc": "아마존 웹 서비스를 다루는 기술",
  "link": "https://pyrasis.com/book/TheArtOfAmazonWebServices/Chapter11/03/05",
  "logo": "https://pyrasis.com/favicon.ico",
  "background": "rgba(31,41,55,0.2)"
}
```

---

## S3 객체 메타데이터 설정하기

```component VPCard
{
  "title": "11장 - 3.6. S3 객체 메타데이터 설정하기",
  "desc": "아마존 웹 서비스를 다루는 기술",
  "link": "https://pyrasis.com/book/TheArtOfAmazonWebServices/Chapter11/03/06",
  "logo": "https://pyrasis.com/favicon.ico",
  "background": "rgba(31,41,55,0.2)"
}
```

---

## S3 버킷 로그 설정하기

```component VPCard
{
  "title": "11장 - 3.7. S3 버킷 로그 설정하기",
  "desc": "아마존 웹 서비스를 다루는 기술",
  "link": "https://pyrasis.com/book/TheArtOfAmazonWebServices/Chapter11/03/07",
  "logo": "https://pyrasis.com/favicon.ico",
  "background": "rgba(31,41,55,0.2)"
}
```

---

## S3 버킷 버저닝 설정하기

```component VPCard
{
  "title": "11장 - 3.8. S3 버킷 버저닝 설정하기",
  "desc": "아마존 웹 서비스를 다루는 기술",
  "link": "https://pyrasis.com/book/TheArtOfAmazonWebServices/Chapter11/03/08",
  "logo": "https://pyrasis.com/favicon.ico",
  "background": "rgba(31,41,55,0.2)"
}
```

---

## S3 버킷 수명 주기 설정하기

```component VPCard
{
  "title": "11장 - 3.9. S3 버킷 수명 주기 설정하기",
  "desc": "아마존 웹 서비스를 다루는 기술",
  "link": "https://pyrasis.com/book/TheArtOfAmazonWebServices/Chapter11/03/09",
  "logo": "https://pyrasis.com/favicon.ico",
  "background": "rgba(31,41,55,0.2)"
}
```

---

## S3 버킷 기타 설정


```component VPCard
{
  "title": "11장 - 3.10. S3 버킷 기타 설정",
  "desc": "아마존 웹 서비스를 다루는 기술",
  "link": "https://pyrasis.com/book/TheArtOfAmazonWebServices/Chapter11/03/10",
  "logo": "https://pyrasis.com/favicon.ico",
  "background": "rgba(31,41,55,0.2)"
}
```

---

<TagLinks />
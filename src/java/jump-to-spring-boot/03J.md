---
lang: ko-KR
title: 3-10. ìˆ˜ì •ê³¼ ì‚­ì œ
description: ğŸƒJump to Spring Boot > 3-10. ìˆ˜ì •ê³¼ ì‚­ì œ
category:
  - â˜•ï¸Java
  - ğŸƒSpring
  - ğŸ“¦AWS
tag: 
  - crashcourse
  - java
  - jdk
  - jdk8
  - stream
  - spring
  - springframework
  - springboot
  - aws
  - aws-ec2
head:
  - - meta:
    - property: og:title
      content: ğŸƒJump to Spring Boot > 3-10. ìˆ˜ì •ê³¼ ì‚­ì œ
    - property: og:description
      content: 3-10. ìˆ˜ì •ê³¼ ì‚­ì œ
    - property: og:url
      content: https://chanhi2000.github.io/crashcourse/java-jump-to-spring-boot/03J.html
---

# {{ $frontmatter.title }} ê´€ë ¨

> {{ $frontmatter.description }}

[[toc]]

---

```component VPCard
{
  "title": "3-10. ìˆ˜ì •ê³¼ ì‚­ì œ",
  "desc": "ì í”„ íˆ¬ ìŠ¤í”„ë§ë¶€íŠ¸ - WikiDocs",
  "link": "https://wikidocs.net/162416",
  "logo": "https://wikidocs.net/static/img/favicon.ico",
  "background": "rgba(255,255,255,0.2)"
}
```

---

> [<FontIcon icon="iconfont icon-github"/> `pahkey/sbb3` - <FontIcon icon="iconfont icon-folder"/> `3-10`](https://github.com/pahkey/sbb3/tree/3-10)

<VidStack src="youtube/MgNtg1ysCx8"/>

ì´ë²ˆì¥ì—ì„œëŠ” ì‘ì„±í•œ ì§ˆë¬¸ê³¼ ë‹µë³€ì„ ìˆ˜ì •í•˜ê³  ì‚­ì œí•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì¶”ê°€í•´ ë³´ì.

ì´ë²ˆì¥ì€ ë¹„ìŠ·í•œ ê¸°ëŠ¥ì„ ë°˜ë³µì ìœ¼ë¡œ êµ¬í˜„í•´ì•¼ í•˜ë¯€ë¡œ ì¡°ê¸ˆ ì§€ë£¨í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ìŠ¤í”„ë§ë¶€íŠ¸ì˜ íŒ¨í„´ì— ìµìˆ™í•´ ì§ˆ ìˆ˜ ìˆëŠ” ì¢‹ì€ ê¸°íšŒë¼ê³  ìƒê°í•˜ê³  ë”°ë¼í•´ ë³´ì.

---

## ìˆ˜ì • ì¼ì‹œ

ë¨¼ì € ì§ˆë¬¸ì´ë‚˜ ë‹µë³€ì´ ì–¸ì œ ìˆ˜ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ `Question`ê³¼ `Answer` ì—”í‹°í‹°ì— ìˆ˜ì • ì¼ì‹œë¥¼ ì˜ë¯¸í•˜ëŠ” `modifyDate` ì†ì„±ì„ ì¶”ê°€í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/question/`<FontIcon icon="iconfont icon-java"/>`Question.java`

```java{4}
// (... ìƒëµ ...)
public class Question {
    // (... ìƒëµ ...)
    private LocalDateTime modifyDate;
}  
```

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/answer/`<FontIcon icon="iconfont icon-java"/>`Answer.java`

```java{4}
// (... ìƒëµ ...)
public class Answer {
    // (... ìƒëµ ...)
    private LocalDateTime modifyDate;
}
```

![ì´ì™€ê°™ì´ ìˆ˜ì •í•˜ë©´ ë‹¤ìŒì²˜ëŸ¼ í…Œì´ë¸”ì— `modify_date` ì»¬ëŸ¼ì´ ì¶”ê°€ëœë‹¤.](https://wikidocs.net/images/page/162416/C_3-10_1.png)

---

## ì§ˆë¬¸ ìˆ˜ì •

ì‘ì„±í•œ ì§ˆë¬¸ì„ ìˆ˜ì •í•˜ë ¤ë©´ ì§ˆë¬¸ ìƒì„¸ í™”ë©´ì—ì„œ "ìˆ˜ì •" ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ìˆ˜ì • í™”ë©´ìœ¼ë¡œ ì§„ì…í•´ì•¼ í•œë‹¤.

### ì§ˆë¬¸ ìˆ˜ì • ë²„íŠ¼

ì§ˆë¬¸ ìƒì„¸ í™”ë©´ì— ë‹¤ìŒê³¼ ê°™ì´ ì§ˆë¬¸ ìˆ˜ì • ë²„íŠ¼ì„ ì¶”ê°€í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/resources/templates/`<FontIcon icon="iconfont icon-page"/>`question_detail.html`

```html{15-20}
<!-- (... ìƒëµ ...) -->
<!-- ì§ˆë¬¸ -->
<h2 class="border-bottom py-2" th:text="${question.subject}"></h2>
<div class="card my-3">
    <div class="card-body">
        <div class="card-text" style="white-space: pre-line;" th:text="${question.content}"></div>
        <div class="d-flex justify-content-end">
            <div class="badge bg-light text-dark p-2 text-start">
                <div class="mb-2">
                    <span th:if="${question.author != null}" th:text="${question.author.username}"></span>
                </div>
                <div th:text="${#temporals.format(question.createDate, 'yyyy-MM-dd HH:mm')}"></div>
            </div>
        </div>
        <div class="my-3">
            <a th:href="@{|/question/modify/${question.id}|}" class="btn btn-sm btn-outline-secondary"
                sec:authorize="isAuthenticated()"
                th:if="${question.author != null and #authentication.getPrincipal().getUsername() == question.author.username}"
                th:text="ìˆ˜ì •"></a>
        </div>
    </div>
</div>
<!-- (... ìƒëµ ...) -->
```

ìˆ˜ì • ë²„íŠ¼ì€ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì™€ ê¸€ì“´ì´ê°€ ë™ì¼í•œ ê²½ìš°ì—ë§Œ ë…¸ì¶œë˜ë„ë¡ `#authentication.getPrincipal().getUsername() == question.author.username`ì„ ì ìš©í•˜ì˜€ë‹¤. ë§Œì•½ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì™€ ê¸€ì“´ì´ê°€ ë‹¤ë¥´ë‹¤ë©´ ìˆ˜ì • ë²„íŠ¼ì€ ë³´ì´ì§€ ì•Šì„ ê²ƒì´ë‹¤.

> `#authentication.getPrincipal()`ì€ Principal ê°ì²´ë¥¼ ë¦¬í„´í•˜ëŠ” íƒ€ì„ë¦¬í”„ì˜ ìœ í‹¸ë¦¬í‹°ì´ë‹¤.

### `QuestionController`

ê·¸ë¦¬ê³  ìœ„ì˜ ìˆ˜ì • ë²„íŠ¼ì— GET ë°©ì‹ì˜ `@{|/question/modify/${question.id}|}` ë§í¬ê°€ ì¶”ê°€ë˜ì—ˆìœ¼ë¯€ë¡œ ì§ˆë¬¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/question/`<FontIcon icon="iconfont icon-java"/>`QuestionController.java`

```java{2-3,9-19}
// (... ìƒëµ ...)
import org.springframework.http.HttpStatus;
import org.springframework.web.server.ResponseStatusException;
// (... ìƒëµ ...)
public class QuestionController {

    // (... ìƒëµ ...)

    @PreAuthorize("isAuthenticated()")
    @GetMapping("/modify/{id}")
    public String questionModify(QuestionForm questionForm, @PathVariable("id") Integer id, Principal principal) {
        Question question = this.questionService.getQuestion(id);
        if(!question.getAuthor().getUsername().equals(principal.getName())) {
            throw new ResponseStatusException(HttpStatus.BAD_REQUEST, "ìˆ˜ì •ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.");
        }
        questionForm.setSubject(question.getSubject());
        questionForm.setContent(question.getContent());
        return "question_form";
    }
}
```

ìœ„ì™€ ê°™ì´ `questionModify` ë©”ì„œë“œë¥¼ ì¶”ê°€í–ˆë‹¤. ë§Œì•½ í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì™€ ì§ˆë¬¸ì˜ ì‘ì„±ìê°€ ë™ì¼í•˜ì§€ ì•Šì„ ê²½ìš°ì—ëŠ” "ìˆ˜ì •ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤." ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë„ë¡ í–ˆë‹¤. ê·¸ë¦¬ê³  ìˆ˜ì •í•  ì§ˆë¬¸ì˜ ì œëª©ê³¼ ë‚´ìš©ì„ í™”ë©´ì— ë³´ì—¬ì£¼ê¸° ìœ„í•´ `questionForm` ê°ì²´ì— ê°’ì„ ë‹´ì•„ì„œ í…œí”Œë¦¿ìœ¼ë¡œ ì „ë‹¬í–ˆë‹¤. (ì´ ê³¼ì •ì´ ì—†ë‹¤ë©´ í™”ë©´ì— "ì œëª©", "ë‚´ìš©"ì˜ ê°’ì´ ì±„ì›Œì§€ì§€ ì•Šì•„ ë¹„ì›Œì ¸ ë³´ì¸ë‹¤.)

ê·¸ë¦¬ê³  ì—¬ê¸°ì„œ ëˆˆì—¬ê²¨ ë³´ì•„ì•¼ í•  ë¶€ë¶„ì€ ì§ˆë¬¸ ë“±ë¡ì‹œ ì‚¬ìš©í–ˆë˜ "`question_form`" í…œí”Œë¦¿ì„ ì§ˆë¬¸ ìˆ˜ì •ì—ì„œë„ ì‚¬ìš©í•œë‹¤ëŠ” ì ì´ë‹¤. ì§ˆë¬¸ ë“±ë¡ í…œí”Œë¦¿ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ê²½ìš° ì§ˆë¬¸ì„ ìˆ˜ì •í•˜ê³  "ì €ì¥í•˜ê¸°" ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì§ˆë¬¸ì´ ìˆ˜ì •ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ìƒˆë¡œìš´ ì§ˆë¬¸ì´ ë“±ë¡ëœë‹¤. ì´ ë¬¸ì œëŠ” í…œí”Œë¦¿ í¼ íƒœê·¸ì˜ `action`ì„ ì˜ í™œìš©í•˜ë©´ ìœ ì—°í•˜ê²Œ ëŒ€ì²˜í• ìˆ˜ ìˆë‹¤. ì–´ë–»ê²Œ ëŒ€ì²˜í•  ìˆ˜ ìˆëŠ”ì§€ í…œí”Œë¦¿ì„ ìˆ˜ì •í•˜ë©´ì„œ ì‚´í´ë³´ì.

### <FontIcon icon="iconfont icon-page"/>`question_form.html`

ì§ˆë¬¸ ìˆ˜ì •ì‹œì—ë„ ì§ˆë¬¸ ë“±ë¡ê³¼ ë™ì¼í•œ í…œí”Œë¦¿ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ì•½ê°„ì˜ íŠ¸ë¦­ì´ í•„ìš”í•˜ë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ì§ˆë¬¸ë“±ë¡ í…œí”Œë¦¿ì„ ìˆ˜ì •í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/resources/templates/`<FontIcon icon="iconfont icon-page"/>`question_form.html`

```html{4-5}
<html layout:decorate="~{layout}">
<div layout:fragment="content" class="container">
    <h5 class="my-3 border-bottom pb-2">ì§ˆë¬¸ë“±ë¡</h5>
    <form th:object="${questionForm}" method="post">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <div th:replace="~{form_errors :: formErrorsFragment}"></div>
        <div class="mb-3">
            <label for="subject" class="form-label">ì œëª©</label>
            <input type="text" th:field="*{subject}" class="form-control">
        </div>
        <div class="mb-3">
            <label for="content" class="form-label">ë‚´ìš©</label>
            <textarea th:field="*{content}" class="form-control" rows="10"></textarea>
        </div>
        <input type="submit" value="ì €ì¥í•˜ê¸°" class="btn btn-primary my-2">
    </form>
</div>
</html>
```

í¼ íƒœê·¸ì˜ `th:action` ì†ì„±ì„ ì‚­ì œí•˜ì. ê·¸ë¦¬ê³  `th:action` ì†ì„±ì„ ì‚­ì œí•˜ë©´ CSRF ê°’ì´ ìë™ìœ¼ë¡œ ìƒì„±ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ìœ„ì™€ ê°™ì´ CSRF ê°’ì„ ì„¤ì •í•˜ê¸° ìœ„í•œ `hidden` í˜•íƒœì˜ `input` ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì¶”ê°€í•œë‹¤.

> CSRF ê°’ì„ ìˆ˜ë™ìœ¼ë¡œ ì¶”ê°€í•˜ê¸° ìœ„í•´ì„œëŠ” ìœ„ì™€ ê°™ì´ í•´ì•¼í•œë‹¤. ì´ê²ƒì€ ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì˜ ê·œì¹™ì´ë‹¤.

í¼ íƒœê·¸ì˜ `action` ì†ì„± ì—†ì´ í¼ì„ ì „ì†¡(submit)í•˜ë©´ í¼ì˜ `action`ì€ í˜„ì¬ì˜ URL(ë¸Œë¼ìš°ì €ì— í‘œì‹œë˜ëŠ” URLì£¼ì†Œ)ì„ ê¸°ì¤€ìœ¼ë¡œ ì „ì†¡ì´ ëœë‹¤. ì¦‰, ì§ˆë¬¸ ë“±ë¡ì‹œì— ë¸Œë¼ìš°ì €ì— í‘œì‹œë˜ëŠ” URLì€ `/question/create`ì´ê¸° ë•Œë¬¸ì— POSTë¡œ í¼ ì „ì†¡ì‹œ `action` ì†ì„±ì— `/question/create`ê°€ ì„¤ì •ì´ ë˜ê³ , ì§ˆë¬¸ ìˆ˜ì •ì‹œì— ë¸Œë¼ìš°ì €ì— í‘œì‹œë˜ëŠ” URLì€ `/question/modify/2` í˜•íƒœì˜ URLì´ê¸° ë•Œë¬¸ì— POSTë¡œ í¼ ì „ì†¡ì‹œ `action` ì†ì„±ì— `/question/modify/2` í˜•íƒœì˜ URLì´ ì„¤ì •ë˜ëŠ” ê²ƒì´ë‹¤.

> í¼ íƒœê·¸ì˜ `th:action` ì†ì„±ì„ ì‚­ì œí•˜ë”ë¼ë„ ì§ˆë¬¸ ë“±ë¡ ë° ìˆ˜ì • ê¸°ëŠ¥ì´ ì •ìƒ ë™ì‘í•œë‹¤.

### <FontIcon icon="iconfont icon-java"/>`QuestionService`

ê·¸ë¦¬ê³  ì§ˆë¬¸ ë°ì´í„°ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆë„ë¡ QuestionServiceë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/question/`<FontIcon icon="iconfont icon-java"/>`QuestionService.java`

```java{6-11}
// (... ìƒëµ ...)
public class QuestionService {

    // (... ìƒëµ ...)

    public void modify(Question question, String subject, String content) {
        question.setSubject(subject);
        question.setContent(content);
        question.setModifyDate(LocalDateTime.now());
        this.questionRepository.save(question);
    }
}
```

ì§ˆë¬¸ ë°ì´í„°ë¥¼ ìˆ˜ì •í• ìˆ˜ ìˆëŠ” `modify` ë©”ì„œë“œë¥¼ ì¶”ê°€í–ˆë‹¤.

### <FontIcon icon="iconfont icon-java"/>`QuestionController`

ê·¸ë¦¬ê³  ì§ˆë¬¸ ìˆ˜ì •í™”ë©´ì—ì„œ ì§ˆë¬¸ì˜ ì œëª©ì´ë‚˜ ë‚´ìš©ì„ ë³€ê²½í•˜ê³  <FontIcon icon="iconfont icon-select"/>`["ì €ì¥í•˜ê¸°"]` ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ í˜¸ì¶œë˜ëŠ” POST ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ `QuestionController`ì— ë‹¤ìŒê³¼ ê°™ì€ ë©”ì„œë“œë¥¼ ì¶”ê°€í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/question/`<FontIcon icon="iconfont icon-java"/>`QuestionController.java`

```java{6-19}
// (... ìƒëµ ...)
public class QuestionController {

    // (... ìƒëµ ...)

    @PreAuthorize("isAuthenticated()")
    @PostMapping("/modify/{id}")
    public String questionModify(@Valid QuestionForm questionForm, BindingResult bindingResult, 
            Principal principal, @PathVariable("id") Integer id) {
        if (bindingResult.hasErrors()) {
            return "question_form";
        }
        Question question = this.questionService.getQuestion(id);
        if (!question.getAuthor().getUsername().equals(principal.getName())) {
            throw new ResponseStatusException(HttpStatus.BAD_REQUEST, "ìˆ˜ì •ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.");
        }
        this.questionService.modify(question, questionForm.getSubject(), questionForm.getContent());
        return String.format("redirect:/question/detail/%s", id);
    }
}
```

POST í˜•ì‹ì˜ `/question/modify/{id}` ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ `questionModify` ë©”ì„œë“œë¥¼ ì¶”ê°€í–ˆë‹¤. `questionForm`ì˜ ë°ì´í„°ë¥¼ ê²€ì¦í•˜ê³  ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì™€ ìˆ˜ì •í•˜ë ¤ëŠ” ì§ˆë¬¸ì˜ ì‘ì„±ìê°€ ë™ì¼í•œì§€ë„ ê²€ì¦í•œë‹¤. ê²€ì¦ì´ í†µê³¼ë˜ë©´ `QuestionService`ì—ì„œ ì‘ì„±í•œ `modify` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ì§ˆë¬¸ ë°ì´í„°ë¥¼ ìˆ˜ì •í•œë‹¤. ê·¸ë¦¬ê³  ìˆ˜ì •ì´ ì™„ë£Œë˜ë©´ ì§ˆë¬¸ ìƒì„¸ í™”ë©´ì„ ë‹¤ì‹œ í˜¸ì¶œí•œë‹¤.

### ì§ˆë¬¸ ìˆ˜ì • í™•ì¸

![ì´ì œ ë¡œê·¸ì¸ ì‚¬ìš©ìì™€ ê¸€ì“´ì´ê°€ ê°™ìœ¼ë©´ ì§ˆë¬¸ ìƒì„¸ í™”ë©´ì— <FontIcon icon="iconfont icon-select"/>`<ìˆ˜ì •>` ë²„íŠ¼ì´ ë³´ì¼ ê²ƒì´ë‹¤.](https://wikidocs.net/images/page/162416/C_3-10_2.png)

ìˆ˜ì • ê¸°ëŠ¥ì´ ì˜ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•´ ë³´ì.

---

## ì§ˆë¬¸ ì‚­ì œ

ì´ë²ˆì—ëŠ” ì§ˆë¬¸ì„ ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥ì„ ì¶”ê°€í•´ ë³´ì. ì‘ì„±í•œ ì§ˆë¬¸ì„ ì‚­ì œí•˜ë ¤ë©´ ì§ˆë¬¸ ìˆ˜ì •ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ì§ˆë¬¸ ìƒì„¸ í™”ë©´ì—ì„œ <FontIcon icon="iconfont icon-select"/>`["ì‚­ì œ"]` ë²„íŠ¼ì„ ìƒì„±í•˜ì—¬ ì‚­ì œí•´ì•¼ í•œë‹¤.

### ì§ˆë¬¸ ì‚­ì œ ë²„íŠ¼

ì‘ì„±í•œ ê¸€ì„ ì‚­ì œí•  ìˆ˜ ìˆëŠ” ë²„íŠ¼ì„ ë‹¤ìŒì²˜ëŸ¼ ì¶”ê°€í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>` /sbb/src/main/resources/templates/`<FontIcon icon="iconfont icon-page"/>`question_detail.html`

```html{12-15}
<!-- (... ìƒëµ ...) -->
<!-- ì§ˆë¬¸ -->
<h2 class="border-bottom py-2" th:text="${question.subject}"></h2>
<div class="card my-3">
    <div class="card-body">
        <!-- (... ìƒëµ ...) -->
        <div class="my-3">
            <a th:href="@{|/question/modify/${question.id}|}" class="btn btn-sm btn-outline-secondary"
                sec:authorize="isAuthenticated()"
                th:if="${question.author != null and #authentication.getPrincipal().getUsername() == question.author.username}"
                th:text="ìˆ˜ì •"></a>
            <a href="javascript:void(0);" th:data-uri="@{|/question/delete/${question.id}|}"
                class="delete btn btn-sm btn-outline-secondary" sec:authorize="isAuthenticated()"
                th:if="${question.author != null and #authentication.getPrincipal().getUsername() == question.author.username}"
                th:text="ì‚­ì œ"></a>
        </div>
    </div>
</div>
<!-- (... ìƒëµ ...) -->
```

.<FontIcon icon="iconfont icon-select"/>`[<ì‚­ì œ>]` ë²„íŠ¼ì€ <FontIcon icon="iconfont icon-select"/>`[<ìˆ˜ì •>]` ë²„íŠ¼ê³¼ëŠ” ë‹¬ë¦¬ href ì†ì„±ê°’ì„ `javascript:void(0)`ë¡œ ì„¤ì •í–ˆë‹¤. ê·¸ë¦¬ê³  ì‚­ì œë¥¼ ì‹¤í–‰í•  URLì„ ì–»ê¸° ìœ„í•´ `th:data-uri` ì†ì„±ì„ ì¶”ê°€í•˜ê³ , <FontIcon icon="iconfont icon-select"/>`[<ì‚­ì œ>]` ë²„íŠ¼ì´ ëˆŒë¦¬ëŠ” ì´ë²¤íŠ¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ `class` ì†ì„±ì— `"delete"` í•­ëª©ì„ ì¶”ê°€í•´ ì£¼ì—ˆë‹¤.

> `data-uri` ì†ì„±ì€ ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ í´ë¦­ ì´ë²¤íŠ¸ ë°œìƒì‹œ `this.dataset.uri`ì™€ ê°™ì´ ì‚¬ìš©í•˜ì—¬ ê·¸ ê°’ì„ ì–»ì„ ìˆ˜ ìˆë‹¤.

`href`ì— ì‚­ì œ URLì„ ì§ì ‘ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì´ëŸ¬í•œ ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” <FontIcon icon="iconfont icon-select"/>`[ <ì‚­ì œ>]`ë²„íŠ¼ì„ í´ë¦­í–ˆì„ë•Œ "ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?" ì™€ ê°™ì€ í™•ì¸ ì ˆì°¨ê°€ í•„ìš”í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

### ìë°”ìŠ¤í¬ë¦½íŠ¸

ì‚­ì œ ë²„íŠ¼ì„ ëˆŒë €ì„ë•Œ í™•ì¸ì°½ì„ í˜¸ì¶œí•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œê°€ í•„ìš”í•˜ë‹¤.

ì•„ë˜ ì½”ë“œë¥¼ ì•„ì§ ì¶”ê°€í•˜ì§€ ë§ì. ì§€ê¸ˆì€ ëˆˆìœ¼ë¡œë§Œ ë³´ì.

```html
<script type='text/javascript'>
const delete_elements = document.getElementsByClassName("delete");
Array.from(delete_elements).forEach(function(element) {
    element.addEventListener('click', function() {
        if(confirm("ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
            location.href = this.dataset.uri;
        };
    });
});
</script>
```

ì´ ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ì˜ë¯¸ëŠ” `delete`ë¼ëŠ” í´ë˜ìŠ¤ë¥¼ í¬í•¨í•˜ëŠ” ì»´í¬ë„ŒíŠ¸(ì˜ˆ:ë²„íŠ¼ì´ë‚˜ ë§í¬)ë¥¼ í´ë¦­í•˜ë©´ "ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?" ë¼ëŠ” ì§ˆë¬¸ì„ í•˜ê³  <FontIcon icon="iconfont icon-select"/>`["í™•ì¸"]`ì„ ì„ íƒí–ˆì„ë•Œ í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ì˜ data-uri ê°’ìœ¼ë¡œ URL í˜¸ì¶œì„ í•˜ë¼ëŠ” ì˜ë¯¸ì´ë‹¤. <FontIcon icon="iconfont icon-select"/>`["í™•ì¸"]` ëŒ€ì‹  <FontIcon icon="iconfont icon-select"/>`["ì·¨ì†Œ"]`ë¥¼ ì„ íƒí•˜ë©´ ì•„ë¬´ëŸ° ì¼ë„ ë°œìƒí•˜ì§€ ì•Šì„ ê²ƒì´ë‹¤.

> â€» `delete` í´ë˜ìŠ¤ëŠ” ë‹µë³€ ì‚­ì œì—ë„ ì‚¬ìš©ëœë‹¤.

ë”°ë¼ì„œ ì´ì™€ ê°™ì€ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¶”ê°€í•˜ë©´ <FontIcon icon="iconfont icon-select"/>`["ì‚­ì œ"]` ë²„íŠ¼ì„ í´ë¦­í•˜ê³  <FontIcon icon="iconfont icon-select"/>`["í™•ì¸"]`ì„ ì„ íƒí•˜ë©´ data-uri ì†ì„±ì— í•´ë‹¹í•˜ëŠ” `@{|/question/delete/${question.id}|}`ì´ í˜¸ì¶œë  ê²ƒì´ë‹¤.

### ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¸”ë¡

ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” HTML êµ¬ì¡°ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ `</body>` íƒœê·¸ ë°”ë¡œ ìœ„ì— ì‚½ì…í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤.

```html
<html>
<head>
(... ìƒëµ ...)
</head>
<body>
(... ìƒëµ ...)
<!-- ì´ê³³ì— ì¶”ê°€ -->
</body>
</html>
```

ì™œëƒí•˜ë©´ í™”ë©´ ë Œë”ë§ì´ ì™„ë£Œëœ í›„ì— ìë°”ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì´ë‹¤. í™”ë©´ ë Œë”ë§ì´ ì™„ë£Œë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí• ìˆ˜ë„ ìˆê³  í™”ë©´ ë¡œë”©ì´ ì§€ì—°ë˜ëŠ” ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ë„ ìˆë‹¤.

ë”°ë¼ì„œ í…œí”Œë¦¿ì—ì„œ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ `</body>` íƒœê·¸ ë°”ë¡œ ìœ„ì— ì‚½ì…í•˜ë ¤ë©´ ë‹¤ìŒì²˜ëŸ¼ <FontIcon icon="iconfont icon-page"/>`layout.html`ì„ ìˆ˜ì •í•´ì•¼ í•œë‹¤.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/resources/templates/`<FontIcon icon="iconfont icon-page"/>`layout.html`

```html{21-23}
<!doctype html>
<html lang="ko">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" type="text/css" th:href="@{/bootstrap.min.css}">
    <!-- sbb CSS -->
    <link rel="stylesheet" type="text/css" th:href="@{/style.css}">
    <title>Hello, sbb!</title>
</head>
<body>
<!-- ë„¤ë¹„ê²Œì´ì…˜ë°” -->
<nav th:replace="~{navbar :: navbarFragment}"></nav>
<!-- ê¸°ë³¸ í…œí”Œë¦¿ ì•ˆì— ì‚½ì…ë  ë‚´ìš© Start -->
<th:block layout:fragment="content"></th:block>
<!-- ê¸°ë³¸ í…œí”Œë¦¿ ì•ˆì— ì‚½ì…ë  ë‚´ìš© End -->
<!-- Bootstrap JS -->
<script th:src="@{/bootstrap.min.js}"></script>
<!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ Start -->
<th:block layout:fragment="script"></th:block>
<!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ End -->
</body>
</html>
```

.<FontIcon icon="iconfont icon-page"/>`layout.html` ì„ ìƒì†í•˜ëŠ” í…œí”Œë¦¿ë“¤ì—ì„œ `content` ë¸”ë¡ì„ êµ¬í˜„í•˜ê²Œ í–ˆë˜ê²ƒê³¼ ë§ˆì°¬ê°€ì§€ ë°©ë²•ìœ¼ë¡œ script ë¸”ë¡ì„ êµ¬í˜„í• ìˆ˜ ìˆë„ë¡ í–ˆë‹¤. `</body>` íƒœê·¸ ë°”ë¡œ ìœ„ì— `<th:block layout:fragment="script"></th:block>` ë¸”ë¡ì„ ì¶”ê°€í–ˆë‹¤.

ì´ë ‡ê²Œ í•˜ë©´ ì´ì œ <FontIcon icon="iconfont icon-page"/>`layout.html`ì„ ìƒì†í•˜ëŠ” í…œí”Œë¦¿ì€ ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ì‚½ì… ìœ„ì¹˜ë¥¼ ì‹ ê²½ì“¸ í•„ìš”ì—†ì´ ìŠ¤í¬ë¦½íŠ¸ ë¸”ë¡ì„ ì‚¬ìš©í•˜ì—¬ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ë©´ ëœë‹¤.

.<FontIcon icon="iconfont icon-page"/>`question_detail.html` í•˜ë‹¨ì— ìŠ¤í¬ë¦½íŠ¸ ë¸”ë¡ì„ ë‹¤ìŒì²˜ëŸ¼ ì¶”ê°€í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/resources/templates/`<FontIcon icon="iconfont icon-page"/>`question_detail.html`

```html{5-14}
<html layout:decorate="~{layout}">
<div layout:fragment="content" class="container my-3">
    <!-- (... ìƒëµ ...) -->
</div>
<script layout:fragment="script" type='text/javascript'>
const delete_elements = document.getElementsByClassName("delete");
Array.from(delete_elements).forEach(function(element) {
    element.addEventListener('click', function() {
        if(confirm("ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
            location.href = this.dataset.uri;
        };
    });
});
</script>
</html>
```

ìŠ¤í¬ë¦½íŠ¸ ë¸”ë¡ì— ì§ˆë¬¸ì„ ì‚­ì œí•  ìˆ˜ ìˆëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì˜€ë‹¤.

### <FontIcon icon="iconfont icon-java"/>`QuestionService`

ê·¸ë¦¬ê³  ì§ˆë¬¸ì„ ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥ì„ `QuestionService`ì— ì¶”ê°€í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/question/`<FontIcon icon="iconfont icon-java"/>`QuestionService.java`

```java{6-8}
// (... ìƒëµ ...)
public class QuestionService {

    // (... ìƒëµ ...)

    public void delete(Question question) {
        this.questionRepository.delete(question);
    }
}
```

`Question` ê°ì²´ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ `Question` ë¦¬í¬ì§€í„°ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì§ˆë¬¸ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ëŠ” `delete` ë©”ì„œë“œë¥¼ ì¶”ê°€í–ˆë‹¤.

### <FontIcon icon="iconfont icon-java"/>`QuestionController`

ê·¸ë¦¬ê³  `@{|/question/delete/${question.id}|}` URLì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ê¸°ëŠ¥ì„ `QuestionController`ì— ë‹¤ìŒê³¼ ê°™ì´ ì¶”ê°€í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/question/`<FontIcon icon="iconfont icon-java"/>`QuestionController.java`

```java{6-15}
// (... ìƒëµ ...)
public class QuestionController {

    // (... ìƒëµ ...)

    @PreAuthorize("isAuthenticated()")
    @GetMapping("/delete/{id}")
    public String questionDelete(Principal principal, @PathVariable("id") Integer id) {
        Question question = this.questionService.getQuestion(id);
        if (!question.getAuthor().getUsername().equals(principal.getName())) {
            throw new ResponseStatusException(HttpStatus.BAD_REQUEST, "ì‚­ì œê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.");
        }
        this.questionService.delete(question);
        return "redirect:/";
    }
}
```

URLë¡œ ì „ë‹¬ë°›ì€ idê°’ì„ ì‚¬ìš©í•˜ì—¬ `Question` ë°ì´í„°ë¥¼ ì¡°íšŒí•œí›„ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì™€ ì§ˆë¬¸ ì‘ì„±ìê°€ ë™ì¼í•  ê²½ìš° ìœ„ì—ì„œ ì‘ì„±í•œ ì„œë¹„ìŠ¤ì˜ `delete` ë©”ì„œë“œë¡œ ì§ˆë¬¸ì„ ì‚­ì œí•œë‹¤. ì§ˆë¬¸ ë°ì´í„° ì‚­ì œí›„ì—ëŠ” ì§ˆë¬¸ ëª©ë¡ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°ˆ ìˆ˜ ìˆë„ë¡ ë£¨íŠ¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•œë‹¤.

### ì§ˆë¬¸ ì‚­ì œ í™•ì¸

ì§ˆë¬¸ì„ ì‘ì„±í•œ ì‚¬ìš©ìì™€ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ë™ì¼í•  ê²½ìš° ë‹¤ìŒì²˜ëŸ¼ ìƒì„¸ì¡°íšŒ í™”ë©´ì— <FontIcon icon="iconfont icon-select"/>`["ì‚­ì œ"]` ë²„íŠ¼ì´ ë…¸ì¶œë  ê²ƒì´ë‹¤.

![<FontIcon icon="iconfont icon-select"/>`["ì‚­ì œ"]` ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì‚­ì œê°€ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•´ ë³´ì.](https://wikidocs.net/images/page/162416/C_3-10_3.png)

---

## ë‹µë³€ ìˆ˜ì •

ì´ë²ˆì—ëŠ” ë‹µë³€ ìˆ˜ì • ê¸°ëŠ¥ì„ êµ¬í˜„í•´ ë³´ì. ì§ˆë¬¸ ìˆ˜ì •ê³¼ ê±°ì˜ ë¹„ìŠ·í•œ ë°©ë²•ìœ¼ë¡œ ì§„í–‰í•  ê²ƒì´ë‹¤. ë‹¤ë§Œ ë‹µë³€ ìˆ˜ì •ì€ ë‹µë³€ ë“±ë¡ í…œí”Œë¦¿ì´ ë”°ë¡œ ì—†ìœ¼ë¯€ë¡œ ë‹µë³€ ìˆ˜ì •ì— ì‚¬ìš©í•  í…œí”Œë¦¿ì´ ì¶”ê°€ë¡œ í•„ìš”í•˜ë‹¤.

ë‹µë³€ ìˆ˜ì • ê¸°ëŠ¥ì€ ì§ˆë¬¸ ìˆ˜ì •ê³¼ í¬ê²Œ ì°¨ì´ ë‚˜ì§€ ì•Šìœ¼ë¯€ë¡œ ê°„ë‹¨íˆ ì„¤ëª…í•˜ê³  ë„˜ì–´ê°€ê² ë‹¤.

### ë‹µë³€ ìˆ˜ì • ë²„íŠ¼

ë‹µë³€ ëª©ë¡ì´ ì¶œë ¥ë˜ëŠ” ë¶€ë¶„ì— ë‹µë³€ ìˆ˜ì • ë²„íŠ¼ì„ ì¶”ê°€í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/resources/templates/`<FontIcon icon="iconfont icon-page"/>`question_detail.html`

```html{14-19}
<!-- (... ìƒëµ ...) -->
<!-- ë‹µë³€ ë°˜ë³µ ì‹œì‘ -->
<div class="card my-3" th:each="answer : ${question.answerList}">
    <div class="card-body">
        <div class="card-text" style="white-space: pre-line;" th:text="${answer.content}"></div>
        <div class="d-flex justify-content-end">
            <div class="badge bg-light text-dark p-2 text-start">
                <div class="mb-2">
                    <span th:if="${answer.author != null}" th:text="${answer.author.username}"></span>
                </div>
                <div th:text="${#temporals.format(answer.createDate, 'yyyy-MM-dd HH:mm')}"></div>
            </div>
        </div>
        <div class="my-3">
            <a th:href="@{|/answer/modify/${answer.id}|}" class="btn btn-sm btn-outline-secondary"
                sec:authorize="isAuthenticated()"
                th:if="${answer.author != null and #authentication.getPrincipal().getUsername() == answer.author.username}"
                th:text="ìˆ˜ì •"></a>
        </div>
    </div>
</div>
<!-- ë‹µë³€ ë°˜ë³µ ë  -->
<!-- (... ìƒëµ ...) -->
```

ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì™€ ë‹µë³€ ì‘ì„±ìê°€ ë™ì¼í•œ ê²½ìš° ë‹µë³€ì˜ <FontIcon icon="iconfont icon-select"/>`["ìˆ˜ì •"]` ë²„íŠ¼ì´ ë…¸ì¶œë˜ë„ë¡ í–ˆë‹¤. ë‹µë³€ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ `/answer/modify/ë‹µë³€ID` í˜•íƒœì˜ URLì´ GET ë°©ì‹ìœ¼ë¡œ ìš”ì²­ë  ê²ƒì´ë‹¤.

### <FontIcon icon="iconfont icon-java"/>`AnswerService`

`AnswerController`ë¥¼ ìˆ˜ì •í•˜ê¸° ì „ì— `AnswerController`ì—ì„œ í•„ìš”í•œ ë‹µë³€ì¡°íšŒì™€ ë‹µë³€ìˆ˜ì • ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/answer/`<FontIcon icon="iconfont icon-java"/>`AnswerService.java`

```java{2-3,9-22}
// (... ìƒëµ ...)
import java.util.Optional;
import com.mysite.sbb.DataNotFoundException;
// (... ìƒëµ ...)
public class AnswerService {

    // (... ìƒëµ ...)

    public Answer getAnswer(Integer id) {
        Optional<Answer> answer = this.answerRepository.findById(id);
        if (answer.isPresent()) {
            return answer.get();
        } else {
            throw new DataNotFoundException("answer not found");
        }
    }

    public void modify(Answer answer, String content) {
        answer.setContent(content);
        answer.setModifyDate(LocalDateTime.now());
        this.answerRepository.save(answer);
    }
}
```

ë‹µë³€ ì•„ì´ë””ë¡œ ë‹µë³€ì„ ì¡°íšŒí•˜ëŠ” `getAnswer` ë©”ì„œë“œì™€ ë‹µë³€ì˜ ë‚´ìš©ìœ¼ë¡œ ë‹µë³€ì„ ìˆ˜ì •í•˜ëŠ” `modify` ë©”ì„œë“œë¥¼ ì¶”ê°€í–ˆë‹¤.

### <FontIcon icon="iconfont icon-java"/>`AnswerController`

ê·¸ë¦¬ê³  ë²„íŠ¼ í´ë¦­ì‹œ ìš”ì²­ë˜ëŠ” GETë°©ì‹ì˜ `/answer/modify/ë‹µë³€ID` í˜•íƒœì˜ URLì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì´ `AnswerController`ë¥¼ ìˆ˜ì •í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/answer/`<FontIcon icon="iconfont icon-java"/>`AnswerController.java`

```java{2-4,10-19}
// (... ìƒëµ ...)
import org.springframework.http.HttpStatus;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.server.ResponseStatusException;
// (... ìƒëµ ...)
public class AnswerController {

    // (... ìƒëµ ...)

    @PreAuthorize("isAuthenticated()")
    @GetMapping("/modify/{id}")
    public String answerModify(AnswerForm answerForm, @PathVariable("id") Integer id, Principal principal) {
        Answer answer = this.answerService.getAnswer(id);
        if (!answer.getAuthor().getUsername().equals(principal.getName())) {
            throw new ResponseStatusException(HttpStatus.BAD_REQUEST, "ìˆ˜ì •ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.");
        }
        answerForm.setContent(answer.getContent());
        return "answer_form";
    }
}
```

ìœ„ì™€ ê°™ì´ `answerModify` ë©”ì„œë“œë¥¼ ì¶”ê°€í–ˆë‹¤. URLì˜ ë‹µë³€ ì•„ì´ë””ë¥¼ í†µí•´ ì¡°íšŒí•œ ë‹µë³€ ë°ì´í„°ì˜ "ë‚´ìš©"ì„ `AnswerForm` ê°ì²´ì— ëŒ€ì…í•˜ì—¬ <FontIcon icon="iconfont icon-page"/>`answer_form.html` í…œí”Œë¦¿ì—ì„œ ì‚¬ìš©í• ìˆ˜ ìˆë„ë¡ í–ˆë‹¤. <FontIcon icon="iconfont icon-page"/>`answer_form.html`ì€ ë‹µë³€ì„ ìˆ˜ì •í•˜ê¸° ìœ„í•œ í…œí”Œë¦¿ìœ¼ë¡œ ì‹ ê·œë¡œ ì‘ì„±í•´ì•¼ í•œë‹¤.

> ë‹µë³€ ìˆ˜ì •ì‹œ ê¸°ì¡´ì˜ ë‚´ìš©ì´ í•„ìš”í•˜ë¯€ë¡œ `AnswerForm` ê°ì²´ì— ì¡°íšŒí•œ ê°’ì„ ì €ì¥í•´ì•¼ í•œë‹¤.

### <FontIcon icon="iconfont icon-page"/>`answer_form.html`

ê·¸ë¦¬ê³  ë‹µë³€ ìˆ˜ì •ì„ ìœ„í•œ <FontIcon icon="iconfont icon-page"/>`answer_form.html` í…œí”Œë¦¿ì„ ë‹¤ìŒê³¼ ê°™ì´ ì‹ ê·œë¡œ ì‘ì„±í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/resources/templates/`<FontIcon icon="iconfont icon-page"/>`answer_form.html`

```html
<html layout:decorate="~{layout}">
<div layout:fragment="content" class="container">
    <h5 class="my-3 border-bottom pb-2">ë‹µë³€ ìˆ˜ì •</h5>
    <form th:object="${answerForm}" method="post">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <div th:replace="~{form_errors :: formErrorsFragment}"></div>
        <div class="mb-3">
            <label for="content" class="form-label">ë‚´ìš©</label>
            <textarea th:field="*{content}" class="form-control" rows="10"></textarea>
        </div>
        <input type="submit" value="ì €ì¥í•˜ê¸°" class="btn btn-primary my-2">
    </form>
</div>
</html>
```

ë‹µë³€ ì‘ì„±ì‹œ ì‚¬ìš©í•˜ëŠ” í¼ íƒœê·¸ì—ë„ ì—­ì‹œ action ì†ì„±ì„ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ë‹¤. ì•ì„œ ì„¤ëª…í–ˆë“¯ì´ `action` ì†ì„±ì„ ìƒëµí•˜ë©´ í˜„ì¬ í˜¸ì¶œëœ URLë¡œ í¼ì´ ì „ì†¡ëœë‹¤. `th:action` ì†ì„±ì´ ì—†ìœ¼ë¯€ë¡œ csrf í•­ëª©ë„ ìˆ˜ë™ìœ¼ë¡œ ì¶”ê°€í–ˆë‹¤.

### <FontIcon icon="iconfont icon-java"/>`AnswerController`

ì´ì œ í¼ì„ í†µí•´ ìš”ì²­ë˜ëŠ” POSTë°©ì‹ì˜ `/answer/modify/ë‹µë³€ID` í˜•íƒœì˜ URLì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì´ `AnswerController`ë¥¼ ìˆ˜ì •í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/answer/`<FontIcon icon="iconfont icon-java"/>`AnswerController.java`

```java{6-19}
// (... ìƒëµ ...)
public class AnswerController {

    // (... ìƒëµ ...)

    @PreAuthorize("isAuthenticated()")
    @PostMapping("/modify/{id}")
    public String answerModify(@Valid AnswerForm answerForm, BindingResult bindingResult,
            @PathVariable("id") Integer id, Principal principal) {
        if (bindingResult.hasErrors()) {
            return "answer_form";
        }
        Answer answer = this.answerService.getAnswer(id);
        if (!answer.getAuthor().getUsername().equals(principal.getName())) {
            throw new ResponseStatusException(HttpStatus.BAD_REQUEST, "ìˆ˜ì •ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.");
        }
        this.answerService.modify(answer, answerForm.getContent());
        return String.format("redirect:/question/detail/%s", answer.getQuestion().getId());
    }
}
```

POST ë°©ì‹ì˜ ë‹µë³€ ìˆ˜ì •ì„ ì²˜ë¦¬í•˜ëŠ” `answerModify` ë©”ì„œë“œë¥¼ ì¶”ê°€í–ˆë‹¤.

> ë‹µë³€ ìˆ˜ì •ì„ ì™„ë£Œí•œ í›„ì—ëŠ” ì§ˆë¬¸ ìƒì„¸ í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸° ìœ„í•´ `answer.getQuestion.getId()`ë¡œ ì§ˆë¬¸ì˜ ì•„ì´ë””ë¥¼ ê°€ì ¸ì™”ë‹¤.

### ë‹µë³€ ìˆ˜ì • í™•ì¸

![ë‹µë³€ ìˆ˜ì •ë„ ì§ˆë¬¸ ìˆ˜ì •ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ë‹µë³€ ë“±ë¡ ì‚¬ìš©ìì™€ ë¡œê·¸ì¸ ì‚¬ìš©ìê°€ ë™ì¼í•  ë•Œë§Œ <FontIcon icon="iconfont icon-select"/>`[<ìˆ˜ì •>]` ë²„íŠ¼ì´ ë‚˜íƒ€ë‚œë‹¤.](https://wikidocs.net/images/page/162416/C_3-10_4.png)

ë‹µë³€ ìˆ˜ì • ê¸°ëŠ¥ì´ ì˜ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•´ ë³´ì.

---

## ë‹µë³€ ì‚­ì œ

ì´ë²ˆì—ëŠ” ë‹µë³€ì„ ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥ì„ ì¶”ê°€í•´ ë³´ì. ë‹µë³€ ì‚­ì œë„ ì§ˆë¬¸ ì‚­ì œì™€ ë™ì¼í•œ ë°©ë²•ì´ë¯€ë¡œ ë¹ ë¥´ê²Œ ì•Œì•„ë³´ì.

### ë‹µë³€ ì‚­ì œ ë²„íŠ¼

ì§ˆë¬¸ ìƒì„¸ í™”ë©´ì—ì„œ ë‹µë³€ì„ ì‚­ì œí•  ìˆ˜ ìˆëŠ” ë²„íŠ¼ì„ ë‹¤ìŒê³¼ ê°™ì´ ì¶”ê°€í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/resources/templates/`<FontIcon icon="iconfont icon-page"/>`question_detail.html`

```html{11-14}
<!-- (... ìƒëµ ...) -->
<!-- ë‹µë³€ ë°˜ë³µ ì‹œì‘ -->
<div class="card my-3" th:each="answer : ${question.answerList}">
    <div class="card-body">
        <!-- (... ìƒëµ ...) -->
        <div class="my-3">
            <a th:href="@{|/answer/modify/${answer.id}|}" class="btn btn-sm btn-outline-secondary"
                sec:authorize="isAuthenticated()"
                th:if="${answer.author != null and #authentication.getPrincipal().getUsername() == answer.author.username}"
                th:text="ìˆ˜ì •"></a>
            <a href="javascript:void(0);" th:data-uri="@{|/answer/delete/${answer.id}|}"
                class="delete btn btn-sm btn-outline-secondary" sec:authorize="isAuthenticated()"
                th:if="${answer.author != null and #authentication.getPrincipal().getUsername() == answer.author.username}"
                th:text="ì‚­ì œ"></a>
        </div>
    </div>
</div>
<!-- ë‹µë³€ ë°˜ë³µ ë  -->
<!-- (... ìƒëµ ...) -->
```

.<FontIcon icon="iconfont icon-select"/>`[<ìˆ˜ì •>]` ë²„íŠ¼ ì˜†ì— <FontIcon icon="iconfont icon-select"/>`[<ì‚­ì œ>]` ë²„íŠ¼ì„ ì¶”ê°€í–ˆë‹¤. ì§ˆë¬¸ì˜ <FontIcon icon="iconfont icon-select"/>`[<ì‚­ì œ>]` ë²„íŠ¼ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ <FontIcon icon="iconfont icon-select"/>`[<ì‚­ì œ>]` ë²„íŠ¼ì— `delete` í´ë˜ìŠ¤ë¥¼ ì ìš©í–ˆìœ¼ë¯€ë¡œ <FontIcon icon="iconfont icon-select"/>`[<ì‚­ì œ>]` ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ `data-uri` ì†ì„±ì— ì„¤ì •í•œ urlì´ ì‹¤í–‰ë  ê²ƒì´ë‹¤.

### <FontIcon icon="iconfont icon-java"/>`AnswerService`

`AnswerService`ì— ë‹¤ìŒì²˜ëŸ¼ ë‹µë³€ì„ ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/answer/`<FontIcon icon="iconfont icon-java"/>`AnswerService.java`

```java{6-8}
// (... ìƒëµ ...)
public class AnswerService {

    // (... ìƒëµ ...)

    public void delete(Answer answer) {
        this.answerRepository.delete(answer);
    }
}
```

ì…ë ¥ìœ¼ë¡œ ë°›ì€ `Answer` ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹µë³€ì„ ì‚­ì œí•˜ëŠ” `delete` ë©”ì„œë“œë¥¼ ì¶”ê°€í–ˆë‹¤.

### <FontIcon icon="iconfont icon-java"/>`AnswerController`

ì´ì œ ë‹µë³€ ì‚­ì œ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ìš”ì²­ë˜ëŠ” GETë°©ì‹ì˜ `/answer/delete/ë‹µë³€ID` í˜•íƒœì˜ URLì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì´ `AnswerController`ë¥¼ ìˆ˜ì •í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/answer/`<FontIcon icon="iconfont icon-java"/>`AnswerController.java`

```java{6-15}
// (... ìƒëµ ...)
public class AnswerController {

    // (... ìƒëµ ...)

    @PreAuthorize("isAuthenticated()")
    @GetMapping("/delete/{id}")
    public String answerDelete(Principal principal, @PathVariable("id") Integer id) {
        Answer answer = this.answerService.getAnswer(id);
        if (!answer.getAuthor().getUsername().equals(principal.getName())) {
            throw new ResponseStatusException(HttpStatus.BAD_REQUEST, "ì‚­ì œê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.");
        }
        this.answerService.delete(answer);
        return String.format("redirect:/question/detail/%s", answer.getQuestion().getId());
    }
}
```

ë‹µë³€ì„ ì‚­ì œí•˜ëŠ” `answerDelete` ë©”ì„œë“œë¥¼ ì¶”ê°€í–ˆë‹¤. ë‹µë³€ì„ ì‚­ì œí•œ í›„ì—ëŠ” í•´ë‹¹ ë‹µë³€ì´ ìˆë˜ ì§ˆë¬¸ìƒì„¸ í™”ë©´ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ í•œë‹¤.

### ë‹µë³€ ì‚­ì œ í™•ì¸

![ì§ˆë¬¸ ìƒì„¸ í™”ë©´ì—ì„œ ë‹µë³€ì„ ì‘ì„±í•œ ì‚¬ìš©ìì™€ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ê°™ìœ¼ë©´ <FontIcon icon="iconfont icon-select"/>`[<ì‚­ì œ>]` ë²„íŠ¼ì´ ë‚˜íƒ€ë‚  ê²ƒì´ë‹¤.](https://wikidocs.net/images/page/162416/C_3-10_5.png)

ì˜ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•´ ë³´ì.

---

## ìˆ˜ì •ì¼ì‹œ í‘œì‹œí•˜ê¸°

ë§ˆì§€ë§‰ìœ¼ë¡œ ì§ˆë¬¸ ìƒì„¸ í™”ë©´ì—ì„œ ìˆ˜ì •ì¼ì‹œë¥¼ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ í…œí”Œë¦¿ì„ ìˆ˜ì •í•´ ë³´ì. ì§ˆë¬¸ê³¼ ë‹µë³€ì—ëŠ” ì´ë¯¸ ì‘ì„±ì¼ì‹œë¥¼ í‘œì‹œí•˜ê³  ìˆë‹¤. ì‘ì„±ì¼ì‹œ ë°”ë¡œ ì™¼ìª½ì— ìˆ˜ì •ì¼ì‹œë¥¼ ì¶”ê°€í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/resources/templates/`<FontIcon icon="iconfont icon-page"/>`question_detail.html`

```html{8-11,28-31}
<!-- (... ìƒëµ ...) -->
<!-- ì§ˆë¬¸ -->
<h2 class="border-bottom py-2" th:text="${question.subject}"></h2>
<div class="card my-3">
    <div class="card-body">
        <div class="card-text" style="white-space: pre-line;" th:text="${question.content}"></div>
        <div class="d-flex justify-content-end">
            <div th:if="${question.modifyDate != null}" class="badge bg-light text-dark p-2 text-start mx-3">
                <div class="mb-2">modified at</div>
                <div th:text="${#temporals.format(question.modifyDate, 'yyyy-MM-dd HH:mm')}"></div>
            </div>
            <div class="badge bg-light text-dark p-2 text-start">
                <div class="mb-2">
                    <span th:if="${question.author != null}" th:text="${question.author.username}"></span>
                </div>
                <div th:text="${#temporals.format(question.createDate, 'yyyy-MM-dd HH:mm')}"></div>
            </div>
        </div>
        <!-- (... ìƒëµ ...) -->
    </div>
</div>
<!-- (... ìƒëµ ...) -->
<!-- ë‹µë³€ ë°˜ë³µ ì‹œì‘ -->
<div class="card my-3" th:each="answer : ${question.answerList}">
    <div class="card-body">
        <div class="card-text" style="white-space: pre-line;" th:text="${answer.content}"></div>
        <div class="d-flex justify-content-end">
            <div th:if="${answer.modifyDate != null}" class="badge bg-light text-dark p-2 text-start mx-3">
                <div class="mb-2">modified at</div>
                <div th:text="${#temporals.format(answer.modifyDate, 'yyyy-MM-dd HH:mm')}"></div>
            </div>
            <div class="badge bg-light text-dark p-2 text-start">
                <div class="mb-2">
                    <span th:if="${answer.author != null}" th:text="${answer.author.username}"></span>
                </div>
                <div th:text="${#temporals.format(answer.createDate, 'yyyy-MM-dd HH:mm')}"></div>
            </div>
        </div>
        <!-- (... ìƒëµ ...) -->
    </div>
</div>
<!-- ë‹µë³€ ë°˜ë³µ ë  -->
<!-- (... ìƒëµ ...) -->
```

![ì§ˆë¬¸ì´ë‚˜ ë‹µë³€ì— ìˆ˜ì •ì¼ì‹œê°€ ìˆëŠ” ê²½ìš°(`null`ì´ ì•„ë‹Œê²½ìš°) ìˆ˜ì •ì¼ì‹œë¥¼ ì‘ì„±ì¼ì‹œ ë°”ë¡œ ì¢Œì¸¡ì— í‘œì‹œí•˜ë„ë¡ í–ˆë‹¤. ì´ì œ ì§ˆë¬¸ì´ë‚˜ ë‹µë³€ì„ ìˆ˜ì •í•˜ë©´ ë‹¤ìŒì²˜ëŸ¼ ìˆ˜ì •ì¼ì‹œê°€ í‘œì‹œë  ê²ƒì´ë‹¤.](https://wikidocs.net/images/page/162416/C_3-10_6.png)

---

<TagLinks />
---
lang: ko-KR
title: 2-05. ë¦¬í¬ì§€í„°ë¦¬
description: ğŸƒJump to Spring Boot > 2-05. ë¦¬í¬ì§€í„°ë¦¬
category:
  - â˜•ï¸Java
  - ğŸƒSpring
  - ğŸ“¦AWS
tag: 
  - crashcourse
  - java
  - jdk
  - jdk8
  - stream
  - spring
  - springframework
  - springboot
  - aws
  - aws-ec2
head:
  - - meta:
    - property: og:title
      content: ğŸƒJump to Spring Boot > 2-05. ë¦¬í¬ì§€í„°ë¦¬
    - property: og:description
      content:  2-05. ë¦¬í¬ì§€í„°ë¦¬
    - property: og:url
      content: https://chanhi2000.github.io/crashcourse/java/jump-to-spring-boot/02E.html
---

# {{ $frontmatter.title }} ê´€ë ¨

> {{ $frontmatter.description }}

[[toc]]

---

```component VPCard
{
  "title": "2-05. ë¦¬í¬ì§€í„°ë¦¬",
  "desc": "ì í”„ íˆ¬ ìŠ¤í”„ë§ë¶€íŠ¸ - WikiDocs",
  "link": "https://wikidocs.net/160890",
  "logo": "https://wikidocs.net/static/img/favicon.ico",
  "background": "rgba(255,255,255,0.2)"
}
```

---

> [<FontIcon icon="iconfont icon-github"/> `pahkey/sbb3` - <FontIcon icon="iconfont icon-folder"/> `2-05`](https://github.com/pahkey/sbb3/tree/2-05)

<VidStack src="youtube/8xI8YhIgYJU"/>

ì´ë²ˆ ì¥ì—ì„œëŠ” JPAë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•´ ë³´ì.

---

## ë¦¬í¬ì§€í„°ë¦¬

ì—”í‹°í‹°ë§Œìœ¼ë¡œëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ê±°ë‚˜ ì¡°íšŒ í•  ìˆ˜ ì—†ë‹¤. ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•´ì„œëŠ” ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ë™í•˜ëŠ” JPA ë¦¬í¬ì§€í„°ë¦¬ê°€ í•„ìš”í•˜ë‹¤.

::: info ë¦¬í¬ì§€í„°ë¦¬ë€?

ë¦¬í¬ì§€í„°ë¦¬ëŠ” ì—”í‹°í‹°ì— ì˜í•´ ìƒì„±ëœ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì— ì ‘ê·¼í•˜ëŠ” ë©”ì„œë“œë“¤(ì˜ˆ: `findAll`, `save` ë“±)ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì¸í„°í˜ì´ìŠ¤ì´ë‹¤. ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•´ì„œëŠ” í…Œì´ë¸”ì— ì–´ë–¤ ê°’ì„ ë„£ê±°ë‚˜ ê°’ì„ ì¡°íšŒí•˜ëŠ” ë“±ì˜ CRUD(Create, Read, Update, Delete)ê°€ í•„ìš”í•˜ë‹¤. ì´ ë•Œ ì´ëŸ¬í•œ CRUDë¥¼ ì–´ë–»ê²Œ ì²˜ë¦¬í• ì§€ ì •ì˜í•˜ëŠ” ê³„ì¸µì´ ë°”ë¡œ ë¦¬í¬ì§€í„°ë¦¬ì´ë‹¤.

:::

ë‹¤ìŒê³¼ ê°™ì´ `QuestionRepository` ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì„±í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/`<FontIcon icon="iconfont icon-java"/>`QuestionRepository.java`

```java
package com.mysite.sbb;

import org.springframework.data.jpa.repository.JpaRepository;

public interface QuestionRepository extends JpaRepository<Question, Integer> {

}
```

`QuestionRepository`ëŠ” ë¦¬í¬ì§€í„°ë¦¬ë¡œ ë§Œë“¤ê¸° ìœ„í•´ JpaRepository ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì†í–ˆë‹¤. JpaRepositoryë¥¼ ìƒì†í•  ë•ŒëŠ” ì œë„¤ë¦­ìŠ¤ íƒ€ì…ìœ¼ë¡œ `<Question, Integer>` ì²˜ëŸ¼ ë¦¬í¬ì§€í„°ë¦¬ì˜ ëŒ€ìƒì´ ë˜ëŠ” ì—”í‹°í‹°ì˜ íƒ€ì…(Question)ê³¼ í•´ë‹¹ ì—”í‹°í‹°ì˜ PKì˜ ì†ì„± íƒ€ì…(Integer)ì„ ì§€ì •í•´ì•¼ í•œë‹¤. ì´ê²ƒì€ JpaRepositoryë¥¼ ìƒì„±í•˜ê¸° ìœ„í•œ ê·œì¹™ì´ë‹¤.

> Question ì—”í‹°í‹°ì˜ PK(Primary Key) ì†ì„±ì¸ `id`ì˜ íƒ€ì…ì€ `Integer` ì´ë‹¤.

ë§ˆì°¬ê°€ì§€ë¡œ `AnswerRepository`ë„ ë‹¤ìŒê³¼ ê°™ì´ ìƒì„±í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/`<FontIcon icon="iconfont icon-java"/>`AnswerRepository.java`

```java
package com.mysite.sbb;

import org.springframework.data.jpa.repository.JpaRepository;

public interface AnswerRepository extends JpaRepository<Answer, Integer> {

}
```

ì´ì œ `QuestionRepository`, `AnswerRepositoryë¥¼` ì´ìš©í•˜ì—¬ `question`, `answer` í…Œì´ë¸”ì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ê±°ë‚˜ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.

---

## ë°ì´í„° ì €ì¥í•˜ê¸°

ì‘ì„±í•œ ë¦¬í¬ì§€í„°ë¦¬ë¥¼ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ì„œ JUnit ê¸°ë°˜ì˜ ìŠ¤í”„ë§ë¶€íŠ¸ì˜ í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•´ ë³´ì.

![ìœ„ íŒŒì¼ì„ ì—´ê³  ë‹¤ìŒì²˜ëŸ¼ ìˆ˜ì •í•˜ì.](https://wikidocs.net/images/page/160890/C_2-05_1.png)

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/test/java/com/mysite/sbb/`<FontIcon icon="iconfont icon-java"/>`SbbApplicationTests.java`

```java
package com.mysite.sbb;

import java.time.LocalDateTime;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;


@SpringBootTest
class SbbApplicationTests {

    @Autowired
    private QuestionRepository questionRepository;

    @Test
    void testJpa() {        
        Question q1 = new Question();
        q1.setSubject("sbbê°€ ë¬´ì—‡ì¸ê°€ìš”?");
        q1.setContent("sbbì— ëŒ€í•´ì„œ ì•Œê³  ì‹¶ìŠµë‹ˆë‹¤.");
        q1.setCreateDate(LocalDateTime.now());
        this.questionRepository.save(q1);  // ì²«ë²ˆì§¸ ì§ˆë¬¸ ì €ì¥

        Question q2 = new Question();
        q2.setSubject("ìŠ¤í”„ë§ë¶€íŠ¸ ëª¨ë¸ ì§ˆë¬¸ì…ë‹ˆë‹¤.");
        q2.setContent("idëŠ” ìë™ìœ¼ë¡œ ìƒì„±ë˜ë‚˜ìš”?");
        q2.setCreateDate(LocalDateTime.now());
        this.questionRepository.save(q2);  // ë‘ë²ˆì§¸ ì§ˆë¬¸ ì €ì¥
    }
}
```

`@SpringBootTest` ì• ë„ˆí…Œì´ì…˜ì€ `SbbApplicationTests` í´ë˜ìŠ¤ê°€ ìŠ¤í”„ë§ë¶€íŠ¸ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì„ì„ ì˜ë¯¸í•œë‹¤. ê·¸ë¦¬ê³  `@Autowired` ì• ë„ˆí…Œì´ì…˜ì€ ìŠ¤í”„ë§ì˜ DI ê¸°ëŠ¥ìœ¼ë¡œ `questionRepository` ê°ì²´ë¥¼ ìŠ¤í”„ë§ì´ ìë™ìœ¼ë¡œ ìƒì„±í•´ ì¤€ë‹¤.

> DI(Dependency Injection) - ìŠ¤í”„ë§ì´ ê°ì²´ë¥¼ ëŒ€ì‹  ìƒì„±í•˜ì—¬ ì£¼ì…í•œë‹¤.

::: info @Autowired

ê°ì²´ë¥¼ ì£¼ì…í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ìŠ¤í”„ë§ì˜ ì• ë„ˆí…Œì´ì…˜ì´ë‹¤. ê°ì²´ë¥¼ ì£¼ì…í•˜ëŠ” ë°©ì‹ì—ëŠ” `@Autowired` ì™¸ì— Setter ë˜ëŠ” ìƒì„±ìë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ ìˆë‹¤. ìˆœí™˜ì°¸ì¡° ë¬¸ì œì™€ ê°™ì€ ì´ìœ ë¡œ `@Autowired` ë³´ë‹¤ëŠ” ìƒì„±ìë¥¼ í†µí•œ ê°ì²´ ì£¼ì…ë°©ì‹ì´ ê¶Œì¥ëœë‹¤. í•˜ì§€ë§Œ í…ŒìŠ¤íŠ¸ ì½”ë“œì˜ ê²½ìš°ì—ëŠ” ìƒì„±ìë¥¼ í†µí•œ ê°ì²´ì˜ ì£¼ì…ì´ ë¶ˆê°€ëŠ¥í•˜ë¯€ë¡œ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì‹œì—ë§Œ `@Autowired`ë¥¼ ì‚¬ìš©í•˜ê³  ì‹¤ì œ ì½”ë“œ ì‘ì„±ì‹œì—ëŠ” ìƒì„±ìë¥¼ í†µí•œ ê°ì²´ ì£¼ì…ë°©ì‹ì„ ì‚¬ìš©í•˜ê² ë‹¤.

:::

`testJpa` ë©”ì„œë“œ ìœ„ì˜ `@Test` ì• ë„ˆí…Œì´ì…˜ì€ `testJpa` ë©”ì„œë“œê°€ í…ŒìŠ¤íŠ¸ ë©”ì„œë“œì„ì„ ë‚˜íƒ€ë‚¸ë‹¤. ìœ„ í´ë˜ìŠ¤ë¥¼ JUnitìœ¼ë¡œ ì‹¤í–‰í•˜ë©´ `@Test` ì• ë„ˆí…Œì´ì…˜ì´ ë¶™ì€ ë©”ì„œë“œê°€ ì‹¤í–‰ëœë‹¤.

> JUnitì€ í…ŒìŠ¤íŠ¸ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  ì‘ì„±í•œ í…ŒìŠ¤íŠ¸ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ìë°”ì˜ í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ì´ë‹¤.

`testJpa` ë©”ì„œë“œì˜ ë‚´ìš©ì„ ì ì‹œ ì‚´í´ë³´ì. `testJpa` ë©”ì„œë“œëŠ” `q1`, `q2` ë¼ëŠ” `Question` ì—”í‹°í‹° ê°ì²´ë¥¼ ìƒì„±í•˜ê³  `QuestionRepository`ë¥¼ ì´ìš©í•˜ì—¬ ê·¸ ê°’ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ëŠ” ì½”ë“œì´ë‹¤.

![ì´ì œ ì‘ì„±í•œ `SbbApplicationTests` í´ë˜ìŠ¤ë¥¼ ì‹¤í–‰í•´ ë³´ì. ë‹¤ìŒì²˜ëŸ¼ <FontIcon icon="iconfont icon-select"/>`[Run -> Run As -> JUnit Test]`ë¥¼ ì„ íƒí•˜ë©´ `SbbApplicationTests` í´ë˜ìŠ¤ë¥¼ ì‹¤í–‰í• ìˆ˜ ìˆë‹¤.](https://wikidocs.net/images/page/160890/C_2-05_2.png)


í•˜ì§€ë§Œ ë¡œì»¬ì„œë²„ê°€ ì´ë¯¸ êµ¬ë™ì¤‘ì´ë¼ë©´ `The file is locked: nio:/Users/pahkey/local.mv.db` ì™€ ë¹„ìŠ·í•œ ì˜¤ë¥˜ê°€ ë°œìƒí•  ê²ƒì´ë‹¤. H2 ë°ì´í„°ë² ì´ìŠ¤ëŠ” íŒŒì¼ ê¸°ë°˜ì˜ ë°ì´í„°ë² ì´ìŠ¤ì´ê¸° ë•Œë¬¸ì— ì´ë¯¸ ë¡œì»¬ì„œë²„ê°€ ì ìœ í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ì´ëŸ¬í•œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ëŠ” ê²ƒì´ë‹¤. ë”°ë¼ì„œ í…ŒìŠ¤íŠ¸ë¥¼ í•˜ê¸° ìœ„í•´ì„œëŠ” ë¡œì»¬ ì„œë²„ë¥¼ ì¤‘ì§€í•´ì•¼ í•œë‹¤.

ë¡œì»¬ì„œë²„ë¥¼ ì¤‘ì§€í•˜ê³  ë‹¤ì‹œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•´ ë³´ì. ê·¸ëŸ¬ë©´ ë‹¤ìŒê³¼ ê°™ì€ JUnit í™”ë©´ì´ ë‚˜íƒ€ë‚˜ê³  ì˜¤ë¥˜ì—†ì´ ì˜ ì‹¤í–‰ë  ê²ƒì´ë‹¤.

![ë‹¤ìŒ í™”ë©´ì²˜ëŸ¼ ì´ˆë¡ìƒ‰ì´ í‘œì‹œë˜ë©´ ì„±ê³µì´ê³  ë¹¨ê°„ìƒ‰ì´ í‘œì‹œë˜ë©´ ì‹¤íŒ¨ì´ë‹¤.](https://wikidocs.net/images/page/160890/O_2-05_3.png)

ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ì— ê°’ì´ ì˜ ë“¤ì–´ê°”ëŠ”ì§€ í™•ì¸í•´ ë³´ê¸° ìœ„í•´ ë‹¤ì‹œ ë¡œì»¬ì„œë²„ë¥¼ ì‹œì‘í•˜ê³  H2 ì½˜ì†”ì— ì ‘ì†í•˜ì—¬ ë‹¤ìŒ ì¿¼ë¦¬ë¬¸ì„ ì‹¤í–‰í•´ ë³´ì.

```sql
SELECT * FROM QUESTION 
```

![ê·¸ëŸ¬ë©´ ë‹¤ìŒì²˜ëŸ¼ ìš°ë¦¬ê°€ ì €ì¥í•œ `Question` ê°ì²´ì˜ ê°’ì´ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ëœ ê²ƒì„ í™•ì¸í•œ ìˆ˜ ìˆë‹¤.](https://wikidocs.net/images/page/160890/C_2-05_4.png)

`id`ëŠ” `Question` ì—”í‹°í‹°ì˜ ê¸°ë³¸ í‚¤(Primary Key)ì´ë‹¤. `id`ëŠ” ì•ì—ì„œ ì—”í‹°í‹°ë¥¼ ìƒì„±í•  ë•Œ ì„¤ì •í–ˆë˜ëŒ€ë¡œ ë°ì´í„°ë¥¼ ìƒì„±í•  ë•Œ ì†ì„±ê°’ì´ ìë™ìœ¼ë¡œ 1ì”© ì¦ê°€í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

> Question ì—”í‹°í‹°ì˜ idëŠ” `@GeneratedValue` ì„¤ì •ì„ í–ˆë‹¤.

---

## ë°ì´í„° ì¡°íšŒí•˜ê¸°

ì´ë²ˆì—ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ëœ ë°ì´í„°ë¥¼ ì¡°íšŒí•´ ë³´ì.

### `findAll`

ì‘ì„±í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ë‹¤ìŒì²˜ëŸ¼ ìˆ˜ì •í•´ ë³´ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/test/java/com/mysite/sbb/`<FontIcon icon="iconfont icon-java"/>`SbbApplicationTests.java`

```java{3,5,20-21,23-24}
package com.mysite.sbb;

import static org.junit.jupiter.api.Assertions.assertEquals;

import java.util.List;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;


@SpringBootTest
class SbbApplicationTests {

    @Autowired
    private QuestionRepository questionRepository;

    @Test
    void testJpa() {
        List<Question> all = this.questionRepository.findAll();
        assertEquals(2, all.size());

        Question q = all.get(0);
        assertEquals("sbbê°€ ë¬´ì—‡ì¸ê°€ìš”?", q.getSubject());
    }
}
```

`question` í…Œì´ë¸”ì— ì €ì¥ëœ ëª¨ë“  ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ê¸° ìœ„í•´ì„œ ë¦¬í¬ì§€í„°ë¦¬ì˜ `findAll` ë©”ì„œë“œë¥¼ ì‚¬ìš©í–ˆë‹¤.

> `findAll`ì€ ë°ì´í„°ë¥¼ ì¡°íšŒí• ë•Œ ì‚¬ìš©í•˜ëŠ” ë©”ì„œë“œì´ë‹¤.

ìš°ë¦¬ëŠ” ì´ 2ê±´ì˜ ë°ì´í„°ë¥¼ ì €ì¥í–ˆê¸° ë•Œë¬¸ì— ë°ì´í„°ì˜ ì‚¬ì´ì¦ˆëŠ” 2ê°€ ë˜ì–´ì•¼ í•œë‹¤. ë°ì´í„° ì‚¬ì´ì¦ˆê°€ 2ì¸ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ JUnitì˜ `assertEquals` ë©”ì„œë“œë¥¼ ì‚¬ìš©í–ˆë‹¤. `assertEquals`ëŠ” `assertEquals(ê¸°ëŒ€ê°’, ì‹¤ì œê°’)`ì™€ ê°™ì´ ì‚¬ìš©í•˜ê³  ê¸°ëŒ€ê°’ê³¼ ì‹¤ì œê°’ì´ ë™ì¼í•œì§€ë¥¼ ì¡°ì‚¬í•œë‹¤. ë§Œì•½ ê¸°ëŒ€ê°’ê³¼ ì‹¤ì œê°’ì´ ë™ì¼í•˜ì§€ ì•Šë‹¤ë©´ í…ŒìŠ¤íŠ¸ëŠ” ì‹¤íŒ¨ë¡œ ì²˜ë¦¬ëœë‹¤. ê·¸ë¦¬ê³  ìš°ë¦¬ê°€ ì €ì¥í•œ ì²«ë²ˆì§¸ ë°ì´í„°ì˜ ì œëª©ì´ "sbbê°€ ë¬´ì—‡ì¸ê°€ìš”?"ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ë„ í…ŒìŠ¤íŠ¸í–ˆë‹¤.

í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ì„œëŠ” ë¡œì»¬ ì„œë²„ë¥¼ ì¤‘ì§€í•˜ê³  ë‹¤ì‹œí•œë²ˆ `[Run -> Run As -> JUnit Test]`ì„ ì‹¤í–‰í•˜ë©´ ëœë‹¤. í…ŒìŠ¤íŠ¸ëŠ” ì˜ í†µê³¼ë  ê²ƒì´ë‹¤.

ìš°ë¦¬ëŠ” í¸ì˜ìƒ `testJpa` ë©”ì„œë“œ í•˜ë‚˜ë§Œì„ ê°€ì§€ê³  JPAì˜ ì—¬ëŸ¬ê¸°ëŠ¥ì„ í…ŒìŠ¤íŠ¸í•  ê²ƒì´ë‹¤.

### `findById`

ì´ë²ˆì—ëŠ” `Question` ì—”í‹°í‹°ì˜ Idê°’ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì¡°íšŒí•´ ë³´ì. í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/test/java/com/mysite/sbb/`<FontIcon icon="iconfont icon-java"/>`SbbApplicationTests.java`

```java{5,20-24}
package com.mysite.sbb;

import static org.junit.jupiter.api.Assertions.assertEquals;

import java.util.Optional;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;


@SpringBootTest
class SbbApplicationTests {

    @Autowired
    private QuestionRepository questionRepository;

    @Test
    void testJpa() {
        Optional<Question> oq = this.questionRepository.findById(1);
        if(oq.isPresent()) {
            Question q = oq.get();
            assertEquals("sbbê°€ ë¬´ì—‡ì¸ê°€ìš”?", q.getSubject());
        }
    }
}
```

id ê°’ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ê¸° ìœ„í•´ì„œëŠ” ë¦¬í¬ì§€í„°ë¦¬ì˜ `findById` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤. í•˜ì§€ë§Œ `findById`ì˜ ë¦¬í„´ íƒ€ì…ì€ `Question`ì´ ì•„ë‹Œ `Optional`ì„ì— ì£¼ì˜í•˜ì. `Optional`ì€ `null` ì²˜ë¦¬ë¥¼ ìœ ì—°í•˜ê²Œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” í´ë˜ìŠ¤ë¡œ ìœ„ì™€ ê°™ì´ `isPresent`ë¡œ `null`ì´ ì•„ë‹Œì§€ë¥¼ í™•ì¸í•œ í›„ì— getìœ¼ë¡œ ì‹¤ì œ `Question` ê°ì²´ ê°’ì„ ì–»ì–´ì•¼ í•œë‹¤.

### `findBySubject`

ì´ë²ˆì—ëŠ” Question ì—”í‹°í‹°ì˜ subject ê°’ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì¡°íšŒí•´ ë³´ì.

í•˜ì§€ë§Œ ì•„ì‰½ê²Œë„ `Question` ë¦¬í¬ì§€í„°ë¦¬ëŠ” `findBySubject`ì™€ ê°™ì€ ë©”ì„œë“œë¥¼ ê¸°ë³¸ì ìœ¼ë¡œ ì œê³µí•˜ì§€ëŠ” ì•ŠëŠ”ë‹¤. findBySubject ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ë‹¤ìŒì²˜ëŸ¼ `QuestionRepository` ì¸í„°í˜ì´ìŠ¤ë¥¼ ë³€ê²½í•´ì•¼ í•œë‹¤.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/`<FontIcon icon="iconfont icon-java"/>`QuestionRepository.java`

```java{6}
package com.mysite.sbb;

import org.springframework.data.jpa.repository.JpaRepository;

public interface QuestionRepository extends JpaRepository<Question, Integer> {
    Question findBySubject(String subject);
}
```

ê·¸ëŸ¬ë©´ ë‹¤ìŒì²˜ëŸ¼ ì œëª©ìœ¼ë¡œ í…Œì´ë¸” ë°ì´í„°ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/test/java/com/mysite/sbb/`<FontIcon icon="iconfont icon-java"/>`SbbApplicationTests.java`

```java{18-19}
package com.mysite.sbb;

import static org.junit.jupiter.api.Assertions.assertEquals;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;


@SpringBootTest
class SbbApplicationTests {

    @Autowired
    private QuestionRepository questionRepository;

    @Test
    void testJpa() {
        Question q = this.questionRepository.findBySubject("sbbê°€ ë¬´ì—‡ì¸ê°€ìš”?");
        assertEquals(1, q.getId());
    }
}
```

í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•´ ë³´ë©´ í…ŒìŠ¤íŠ¸ëŠ” ì•„ì£¼ ì˜ í†µê³¼ëœë‹¤. ì•„ë§ˆ ì—¬ëŸ¬ë¶„ì€ ë‹¤ìŒê³¼ ê°™ì€ ì§ˆë¬¸ê³¼ í•¨ê»˜ í° í˜¼ë€ì´ ì°¾ì•„ ì˜¬ì§€ë„ ëª¨ë¥¸ë‹¤. "ì¸í„°í˜ì´ìŠ¤ì— `findBySubject` ë¼ëŠ” ë©”ì„œë“œë¥¼ ì„ ì–¸ë§Œ í•˜ê³  êµ¬í˜„ì€ í•˜ì§€ ì•Šì•˜ëŠ”ë° ë„ëŒ€ì²´ ì–´ë–»ê²Œ ì‹¤í–‰ì´ ë˜ëŠ” ê±°ì§€?"

ì´ëŸ¬í•œ ë§ˆë²•ì€ JpaRepositoryë¥¼ ìƒì†í•œ `QuestionRepository` ê°ì²´ê°€ ìƒì„±ë ë•Œ ë²Œì–´ì§„ë‹¤. (DIì— ì˜í•´ ìŠ¤í”„ë§ì´ ìë™ìœ¼ë¡œ `QuestionRepository` ê°ì²´ë¥¼ ìƒì„±í•œë‹¤. ì´ ë•Œ í”„ë¡ì‹œ íŒ¨í„´ì´ ì‚¬ìš©ëœë‹¤ê³  í•œë‹¤.) ë¦¬í¬ì§€í„°ë¦¬ ê°ì²´ì˜ ë©”ì„œë“œê°€ ì‹¤í–‰ë ë•Œ JPAê°€ í•´ë‹¹ ë©”ì„œë“œëª…ì„ ë¶„ì„í•˜ì—¬ ì¿¼ë¦¬ë¥¼ ë§Œë“¤ê³  ì‹¤í–‰í•œë‹¤.

ì¦‰, ì—¬ëŸ¬ë¶„ì€ `findBy` + ì—”í‹°í‹°ì˜ ì†ì„±ëª…(ì˜ˆ:`findBySubject`)ê³¼ ê°™ì€ ë¦¬í¬ì§€í„°ë¦¬ ë©”ì„œë“œë¥¼ ì‘ì„±í•˜ë©´ í•´ë‹¹ ì†ì„±ì˜ ê°’ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì¡°íšŒí• ìˆ˜ ìˆë‹¤.

`findBySubject` ë©”ì„œë“œë¥¼ í˜¸ì¶œí• ë•Œ ì‹¤ì œ ì–´ë–¤ ì¿¼ë¦¬ê°€ ì‹¤í–‰ë˜ëŠ”ì§€ ì‚´í´ë³´ì. ì‹¤í–‰ë˜ëŠ” ì¿¼ë¦¬ë¥¼ ë¡œê·¸ì—ì„œ ë³´ë ¤ë©´ `application.properties` íŒŒì¼ì„ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•´ì•¼ í•œë‹¤.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/resources/`<FontIcon icon="iconfont icon-file"/>`application.properties`

```properties{12,13}
# DATABASE
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console
spring.datasource.url=jdbc:h2:~/local
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=

# JPA
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.H2Dialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.show_sql=true
```

ê·¸ë¦¬ê³  ë‹¤ì‹œí•œë²ˆ í…ŒìŠ¤íŠ¸ì½”ë“œë¥¼ ì‹¤í–‰í•´ ë³´ì. ê·¸ëŸ¬ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì½˜ì†”ë¡œê·¸ì—ì„œ ì‹¤í–‰ëœ ì¿¼ë¦¬ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

![ì‹¤í–‰ëœ ì¿¼ë¦¬ì˜ `where` ì¡°ê±´ì— `subject`ê°€ í¬í•¨ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.](https://wikidocs.net/images/page/160890/C_2-05_5.png)

### `findBySubjectAndContent`

ì´ë²ˆì—ëŠ” ì œëª©ê³¼ ë‚´ìš©ì„ í•¨ê»˜ ì¡°íšŒí•´ ë³´ì. ë‘ ê°œì˜ ì†ì„±ì„ And ì¡°ê±´ìœ¼ë¡œ ì¡°íšŒí• ë•ŒëŠ” ë¦¬í¬ì§€í„°ë¦¬ì— ë‹¤ìŒê³¼ ê°™ì€ ë©”ì„œë“œë¥¼ ì¶”ê°€í•´ì•¼ í•œë‹¤.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/`<FontIcon icon="iconfont icon-java"/>`QuestionRepository.java`

```java{5}
package com.mysite.sbb;

import org.springframework.data.jpa.repository.JpaRepository;

public interface QuestionRepository extends JpaRepository<Question, Integer> {
    Question findBySubject(String subject);
    Question findBySubjectAndContent(String subject, String content);
}
```

ê·¸ë¦¬ê³  í…ŒìŠ¤íŠ¸ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/test/java/com/mysite/sbb/`<FontIcon icon="iconfont icon-java"/>`SbbApplicationTests.java`

```java{18-20}
package com.mysite.sbb;

import static org.junit.jupiter.api.Assertions.assertEquals;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;


@SpringBootTest
class SbbApplicationTests {

    @Autowired
    private QuestionRepository questionRepository;

    @Test
    void testJpa() {
        Question q = this.questionRepository.findBySubjectAndContent(
                "sbbê°€ ë¬´ì—‡ì¸ê°€ìš”?", "sbbì— ëŒ€í•´ì„œ ì•Œê³  ì‹¶ìŠµë‹ˆë‹¤.");
        assertEquals(1, q.getId());
    }
}
```

í…ŒìŠ¤íŠ¸ëŠ” ì˜ í†µê³¼ë  ê²ƒì´ë‹¤. ê·¸ë¦¬ê³  ì‹¤ì œ ì¿¼ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ ì½˜ì†” ë¡œê·¸ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

```sql{9-10}
SELECT
    question0_.id as id1_1_,
    question0_.content as content2_1_,
    question0_.create_date as create_d3_1_,
    question0_.subject as subject4_1_ 
from
    question question0_ 
WHERE
    question0_.subject=? 
    AND question0_.content=?
```

`subject`, `content` ì»¬ëŸ¼ì´ `AND` ì¡°ê±´ìœ¼ë¡œ `WHERE`ë¬¸ì— ì‚¬ìš©ë˜ì—ˆë‹¤.

ì´ë ‡ë“¯ ë¦¬í¬ì§€í„°ë¦¬ì˜ ë©”ì„œë“œëª…ì€ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ëŠ” ì¿¼ë¦¬ë¬¸ì˜ `WHERE` ì¡°ê±´ì„ ê²°ì •í•˜ëŠ” ì—­í• ì„ í•œë‹¤. ì—¬ê¸°ì„œëŠ” `findBySubject`, `findBySubjectAndContent` ë‘ ê°œë§Œ ì•Œì•„ë´¤ì§€ë§Œ ìƒë‹¹íˆ ë§ì€ ì¡°í•©ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ê·¸ê²ƒë“¤ì— ëŒ€í•´ì„œ ê°„ë‹¨í•˜ê²Œ í‘œë¡œ ì •ë¦¬í•´ ë³´ì•˜ë‹¤.

| í•­ëª© | ì˜ˆì œ | ì„¤ëª… |
| :--- | :--- | :--- |
| And | `findBySubjectAndContent(String subject, String content)` | ì—¬ëŸ¬ ì»¬ëŸ¼ì„ and ë¡œ ê²€ìƒ‰ |
| Or | `findBySubjectOrContent(String subject, String content)` | ì—¬ëŸ¬ ì»¬ëŸ¼ì„ or ë¡œ ê²€ìƒ‰ |
| Between | `findByCreateDateBetween(LocalDateTime fromDate, LocalDateTime toDate)` | ì»¬ëŸ¼ì„ betweenìœ¼ë¡œ ê²€ìƒ‰ |
| LessThan | `findByIdLessThan(Integer id)` | ì‘ì€ í•­ëª© ê²€ìƒ‰ |
| GreaterThanEqual | `findByIdGraterThanEqual(Integer id)` | í¬ê±°ë‚˜ ê°™ì€ í•­ëª© ê²€ìƒ‰ |
| Like | `findBySubjectLike(String subject)` | `LIKE` ê²€ìƒ‰ |
| In | `findBySubjectIn(String[] subjects)` | ì—¬ëŸ¬ ê°’ì¤‘ì— í•˜ë‚˜ì¸ í•­ëª© ê²€ìƒ‰ |
| OrderBy | `findBySubjectOrderByCreateDateAsc(String subject)` | ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì •ë ¬í•˜ì—¬ ì „ë‹¬ |

> ë‹¨, ì‘ë‹µ ê²°ê³¼ê°€ ì—¬ëŸ¬ê±´ì¸ ê²½ìš°ì—ëŠ” ë¦¬í¬ì§€í„°ë¦¬ ë©”ì„œë“œì˜ ë¦¬í„´ íƒ€ì…ì„ `Question`ì´ ì•„ë‹Œ `List<Question>` ìœ¼ë¡œ í•´ì•¼ í•œë‹¤.

ë³´ë‹¤ ìì„¸í•œ ë‚´ìš©ì€ ì¿¼ë¦¬ ìƒì„± ê·œì¹™ì— ëŒ€í•œ ë‹¤ìŒì˜ ê³µì‹ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì.

- [https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#jpa.query-methods.query-creation](https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#jpa.query-methods.query-creation)

### `findBySubjectLike`

ì´ë²ˆì—ëŠ” ì œëª©ì— íŠ¹ì • ë¬¸ìì—´ì´ í¬í•¨ë˜ì–´ ìˆëŠ” ë°ì´í„°ë¥¼ ì¡°íšŒí•´ ë³´ì. Question ë¦¬í¬ì§€í„°ë¦¬ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/`<FontIcon icon="iconfont icon-java"/>`QuestionRepository.java`

```java{10}
package com.mysite.sbb;

import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;

public interface QuestionRepository extends JpaRepository<Question, Integer> {
    Question findBySubject(String subject);
    Question findBySubjectAndContent(String subject, String content);
    List<Question> findBySubjectLike(String subject);
}
```

í…ŒìŠ¤íŠ¸ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/test/java/com/mysite/sbb/`<FontIcon icon="iconfont icon-java"/>`SbbApplicationTests.java`

```java{5,20-22}
package com.mysite.sbb;

import static org.junit.jupiter.api.Assertions.assertEquals;

import java.util.List;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;


@SpringBootTest
class SbbApplicationTests {

    @Autowired
    private QuestionRepository questionRepository;

    @Test
    void testJpa() {
        List<Question> qList = this.questionRepository.findBySubjectLike("sbb%");
        Question q = qList.get(0);
        assertEquals("sbbê°€ ë¬´ì—‡ì¸ê°€ìš”?", q.getSubject());
    }
}
```

í…ŒìŠ¤íŠ¸ëŠ” ì˜ í†µê³¼ë  ê²ƒì´ë‹¤. Like ê²€ìƒ‰ì„ ìœ„í•´ì„œëŠ” findBySubjectLike ë©”ì„œë“œì˜ ì…ë ¥ ë¬¸ìì—´ë¡œ "sbb%"ì™€ ê°™ì´ "%"ë¥¼ ì ì–´ì£¼ì–´ì•¼ í•œë‹¤. % í‘œê¸°ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì˜ë¯¸ë¥¼ ê°–ëŠ”ë‹¤.

- `sbb%`: "sbb"ë¡œ ì‹œì‘í•˜ëŠ” ë¬¸ìì—´
- `%sbb`: "sbb"ë¡œ ëë‚˜ëŠ” ë¬¸ìì—´
- `%sbb%`: "sbb"ë¥¼ í¬í•¨í•˜ëŠ” ë¬¸ìì—´

---

## ë°ì´í„° ìˆ˜ì •í•˜ê¸°

ì´ë²ˆì—ëŠ” ì§ˆë¬¸ ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•´ ë³´ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/test/java/com/mysite/sbb/`<FontIcon icon="iconfont icon-java"/>`SbbApplicationTests.java`

```java{3,5,20-24}
package com.mysite.sbb;

import static org.junit.jupiter.api.Assertions.assertTrue;

import java.util.Optional;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;


@SpringBootTest
class SbbApplicationTests {

    @Autowired
    private QuestionRepository questionRepository;

    @Test
    void testJpa() {
        Optional<Question> oq = this.questionRepository.findById(1);
        assertTrue(oq.isPresent());
        Question q = oq.get();
        q.setSubject("ìˆ˜ì •ëœ ì œëª©");
        this.questionRepository.save(q);
    }
}
```

> `assertTrue`(ê°’)ì€ ê°’ì´ `true`ì¸ì§€ë¥¼ í…ŒìŠ¤íŠ¸í•œë‹¤.

ì§ˆë¬¸ ë°ì´í„°ë¥¼ ì¡°íšŒí•œ ë‹¤ìŒ subjectë¥¼ "ìˆ˜ì •ëœ ì œëª©" ì´ë¼ëŠ” ê°’ìœ¼ë¡œ ìˆ˜ì •í–ˆë‹¤. ë³€ê²½ëœ `Question` ë°ì´í„°ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ì„œëŠ” `this.questionRepository.save(q)` ì²˜ëŸ¼ ë¦¬í¬ì§€í„°ë¦¬ì˜ `save` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œë‹¤.

í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•´ ë³´ë©´ ì½˜ì†” ë¡œê·¸ì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ `UPDATE` ë¬¸ì´ ì‹¤í–‰ë˜ì—ˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

```sql
UPDATE
    question 
SET
    content=?,
    create_date=?,
    subject=? 
WHERE
    id=?
```

---

## ë°ì´í„° ì‚­ì œí•˜ê¸°

ì´ì–´ì„œ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ëŠ” ê²ƒë„ ì‹¤ìŠµí•´ ë³´ì. ì—¬ê¸°ì„œëŠ” ì²« ë²ˆì§¸ ì§ˆë¬¸ì„ ì‚­ì œí•´ ë³´ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/test/java/com/mysite/sbb/`<FontIcon icon="iconfont icon-java"/>`SbbApplicationTests.java`

```java{3,21-26}
package com.mysite.sbb;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertTrue;

import java.util.Optional;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;


@SpringBootTest
class SbbApplicationTests {

    @Autowired
    private QuestionRepository questionRepository;

    @Test
    void testJpa() {
        assertEquals(2, this.questionRepository.count());
        Optional<Question> oq = this.questionRepository.findById(1);
        assertTrue(oq.isPresent());
        Question q = oq.get();
        this.questionRepository.delete(q);
        assertEquals(1, this.questionRepository.count());
    }
}
```

ë¦¬í¬ì§€í„°ë¦¬ì˜ `count()` ë©”ì„œë“œëŠ” í•´ë‹¹ ë¦¬í¬ì§€í„°ë¦¬ì˜ ì´ ë°ì´í„°ê±´ìˆ˜ë¥¼ ë¦¬í„´í•œë‹¤.

`Question` ë¦¬í¬ì§€í„°ë¦¬ì˜ `delete` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì‚­ì œí–ˆë‹¤. ì‚­ì œí•˜ê¸° ì „ì—ëŠ” ë°ì´í„° ê±´ìˆ˜ê°€ 2, ì‚­ì œí•œ í›„ì—ëŠ” ë°ì´í„° ê±´ìˆ˜ê°€ 1ì¸ì§€ë¥¼ í…ŒìŠ¤íŠ¸í–ˆë‹¤. í…ŒìŠ¤íŠ¸ëŠ” ì˜ í†µê³¼ë  ê²ƒì´ë‹¤.

---

## ë‹µë³€ ë°ì´í„° ìƒì„± í›„ ì €ì¥í•˜ê¸°

ì´ë²ˆì—ëŠ” ë‹µë³€(`Answer`) ë°ì´í„°ë¥¼ ìƒì„±í•˜ê³  ì €ì¥í•´ ë³´ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/test/java/com/mysite/sbb/`<FontIcon icon="iconfont icon-java"/>`SbbApplicationTests.java`

```java{6,20-21,25-33}
package com.mysite.sbb;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertTrue;

import java.time.LocalDateTime;
import java.util.Optional;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;


@SpringBootTest
class SbbApplicationTests {

    @Autowired
    private QuestionRepository questionRepository;

    @Autowired
    private AnswerRepository answerRepository;

    @Test
    void testJpa() {
        Optional<Question> oq = this.questionRepository.findById(2);
        assertTrue(oq.isPresent());
        Question q = oq.get();

        Answer a = new Answer();
        a.setContent("ë„¤ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.");
        a.setQuestion(q);  // ì–´ë–¤ ì§ˆë¬¸ì˜ ë‹µë³€ì¸ì§€ ì•Œê¸°ìœ„í•´ì„œ Question ê°ì²´ê°€ í•„ìš”í•˜ë‹¤.
        a.setCreateDate(LocalDateTime.now());
        this.answerRepository.save(a);
    }
}
```

ë‹µë³€ ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•´ì„œëŠ” ë‹µë³€ ë¦¬í¬ì§€í„°ë¦¬ê°€ í•„ìš”í•˜ë¯€ë¡œ `AnswerRepository` ê°ì²´ë¥¼ `@Autowired`ë¡œ ì£¼ì…í–ˆë‹¤. ë‹µë³€ ë°ì´í„°ë¥¼ ìƒì„±í•˜ë ¤ë©´ ì§ˆë¬¸ ë°ì´í„°ê°€ í•„ìš”í•˜ë¯€ë¡œ ìš°ì„  ì§ˆë¬¸ ë°ì´í„°ë¥¼ êµ¬í•´ì•¼ í•œë‹¤. idê°€ 2ì¸ ì§ˆë¬¸ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ ë‹¤ìŒ Answer ì—”í‹°í‹°ì˜ `question` ì†ì„±ì— ë°©ê¸ˆ ê°€ì ¸ì˜¨ ì§ˆë¬¸ ë°ì´í„°ë¥¼ ëŒ€ì…í•´(`a.setQuestion(q)`) ë‹µë³€ ë°ì´í„°ë¥¼ ìƒì„±í–ˆë‹¤. `Answer` ì—”í‹°í‹°ì—ëŠ” ì–´ë–¤ ì§ˆë¬¸ì— í•´ë‹¹í•˜ëŠ” ë‹µë³€ì¸ì§€ ì—°ê²°í•  ëª©ì ìœ¼ë¡œ `question` ì†ì„±ì´ í•„ìš”í•˜ë‹¤.

í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•´ ë³´ì. ë‹µë³€ ë°ì´í„°ê°€ ì˜ ìƒì„±ë  ê²ƒì´ë‹¤.

---

## ë‹µë³€ ì¡°íšŒí•˜ê¸°

`Answer`ë„ `Question` ì—”í‹°í‹°ì™€ ë§ˆì°¬ê°€ì§€ë¡œ id ì†ì„±ì´ ê¸°ë³¸ í‚¤ì´ë¯€ë¡œ ê°’ì´ ìë™ìœ¼ë¡œ ìƒì„±ëœë‹¤. ë‹¤ìŒì²˜ëŸ¼ id ê°’ì„ ì´ìš©í•´ ë°ì´í„°ë¥¼ ì¡°íšŒí•´ ë³´ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/test/java/com/mysite/sbb/`<FontIcon icon="iconfont icon-java"/>`SbbApplicationTests.java`

```java{24-27}
package com.mysite.sbb;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertTrue;

import java.util.Optional;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;


@SpringBootTest
class SbbApplicationTests {

    @Autowired
    private QuestionRepository questionRepository;

    @Autowired
    private AnswerRepository answerRepository;

    @Test
    void testJpa() {
        Optional<Answer> oa = this.answerRepository.findById(1);
        assertTrue(oa.isPresent());
        Answer a = oa.get();
        assertEquals(2, a.getQuestion().getId());
    }
}
```

id ê°’ì´ 1ì¸ ë‹µë³€ì„ ì¡°íšŒí–ˆë‹¤. ê·¸ë¦¬ê³  ê·¸ ë‹µë³€ì˜ ì§ˆë¬¸ idê°€ 2ì¸ì§€ë„ í…ŒìŠ¤íŠ¸í•´ ë³´ì•˜ë‹¤.

---

## ë‹µë³€ì— ì—°ê²°ëœ ì§ˆë¬¸ ì°¾ê¸° vs ì§ˆë¬¸ì— ë‹¬ë¦° ë‹µë³€ ì°¾ê¸°

ì•ì—ì„œ êµ¬ì„±í•œ `Answer` ì—”í‹°í‹°ì˜ `question` ì†ì„±ì„ ì´ìš©í•˜ë©´ "ë‹µë³€ì— ì—°ê²°ëœ ì§ˆë¬¸"ì„ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.

```java
a.getQuestion()
```

ë‹µë³€ì— ì—°ê²°ëœ ì§ˆë¬¸ ì°¾ê¸°ëŠ” `Answer` ì—”í‹°í‹°ì— `question` ì†ì„±ì´ ì •ì˜ë˜ì–´ ìˆì–´ì„œ ë§¤ìš° ì‰½ë‹¤. ê·¸ëŸ°ë° ë°˜ëŒ€ì˜ ê²½ìš°ë„ ê°€ëŠ¥í• ê¹Œ? ì¦‰, ì§ˆë¬¸ì—ì„œ ë‹µë³€ì„ ì°¾ì„ìˆ˜ ìˆì„ê¹Œ?

ë‹¤ìŒê³¼ ê°™ì´ ì§ˆë¬¸ ì—”í‹°í‹°ì— ì •ì˜í•œ `answerList`ë¥¼ ì‚¬ìš©í•˜ë©´ ì—­ì‹œ ì‰½ê²Œ êµ¬í• ìˆ˜ ìˆë‹¤.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/test/java/com/mysite/sbb/`<FontIcon icon="iconfont icon-java"/>`SbbApplicationTests.java`

```java{6,22-29}
package com.mysite.sbb;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertTrue;

import java.util.List;
import java.util.Optional;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;


@SpringBootTest
class SbbApplicationTests {

    @Autowired
    private QuestionRepository questionRepository;

    @Test
    void testJpa() {
        Optional<Question> oq = this.questionRepository.findById(2);
        assertTrue(oq.isPresent());
        Question q = oq.get();

        List<Answer> answerList = q.getAnswerList();

        assertEquals(1, answerList.size());
        assertEquals("ë„¤ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.", answerList.get(0).getContent());
    }
}
```

ì§ˆë¬¸ ê°ì²´ë¡œë¶€í„° ë‹µë³€ ë¦¬ìŠ¤íŠ¸ë¥¼ êµ¬í•˜ëŠ” í…ŒìŠ¤íŠ¸ì½”ë“œì´ë‹¤. idê°€ 2ì¸ ì§ˆë¬¸ì— ë‹µë³€ì„ í•œ ê°œ ë“±ë¡í–ˆìœ¼ë¯€ë¡œ ìœ„ì™€ ê°™ì´ ê²€ì¦í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ìœ„ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.

```yaml
org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.mysite.sbb.Question.answerList, could not initialize proxy - no Session
(... ìƒëµ ...)
```

ì™œëƒí•˜ë©´ `Question` ë¦¬í¬ì§€í„°ë¦¬ê°€ `findByIdë¥¼ `í˜¸ì¶œí•˜ì—¬ `Question` ê°ì²´ë¥¼ ì¡°íšŒí•˜ê³  ë‚˜ë©´ DBì„¸ì…˜ì´ ëŠì–´ì§€ê¸° ë•Œë¬¸ì´ë‹¤. ê·¸ ì´í›„ì— ì‹¤í–‰ë˜ëŠ” `q.getAnswerList()` ë©”ì„œë“œëŠ” ì„¸ì…˜ì´ ì¢…ë£Œë˜ì–´ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤. ë‹µë³€ ë°ì´í„° ë¦¬ìŠ¤íŠ¸ëŠ” q ê°ì²´ë¥¼ ì¡°íšŒí• ë•Œ ê°€ì ¸ì˜¤ì§€ ì•Šê³  `q.getAnswerList()` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ì‹œì ì— ê°€ì ¸ì˜¤ê¸° ë•Œë¬¸ì´ë‹¤.

> ì´ë ‡ê²Œ í•„ìš”í•œ ì‹œì ì— ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë°©ì‹ì„ Lazy ë°©ì‹ì´ë¼ê³  í•œë‹¤. ì´ì™€ ë°˜ëŒ€ë¡œ q ê°ì²´ë¥¼ ì¡°íšŒí• ë•Œ ë‹µë³€ ë¦¬ìŠ¤íŠ¸ë¥¼ ëª¨ë‘ ê°€ì ¸ì˜¤ëŠ” ë°©ì‹ì€ Eager ë°©ì‹ì´ë¼ê³  í•œë‹¤. `@OneToMany`, `@ManyToOne` ì• ë„ˆí…Œì´ì…˜ì˜ ì˜µì…˜ìœ¼ë¡œ `fetch=FetchType.LAZY` ë˜ëŠ” `fetch=FetchType.EAGER` ì²˜ëŸ¼ ê°€ì ¸ì˜¤ëŠ” ë°©ì‹ì„ ì„¤ì •í•  ìˆ˜ ìˆëŠ”ë° ì´ ì±…ì—ì„œëŠ” ë”°ë¡œ ì§€ì •í•˜ì§€ ì•Šê³  í•­ìƒ ë””í´íŠ¸ ê°’ì„ ì‚¬ìš©í•  ê²ƒì´ë‹¤.

ì‚¬ì‹¤ ì´ ë¬¸ì œëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œë§Œ ë°œìƒí•œë‹¤. ì‹¤ì œ ì„œë²„ì—ì„œ JPA í”„ë¡œê·¸ë¨ë“¤ì„ ì‹¤í–‰í•  ë•ŒëŠ” DB ì„¸ì…˜ì´ ì¢…ë£Œë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ìœ„ì™€ ê°™ì€ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤. í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ìˆ˜í–‰í•  ë•Œ ìœ„ì™€ ê°™ì€ ì˜¤ë¥˜ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆëŠ” ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•ì€ ë‹¤ìŒì²˜ëŸ¼ `@Transactional` ì• ë„ˆí…Œì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤. `@Transactional` ì• ë„ˆí…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ ë©”ì„œë“œê°€ ì¢…ë£Œë  ë•Œê¹Œì§€ DB ì„¸ì…˜ì´ ìœ ì§€ëœë‹¤.

```java{12,21}
package com.mysite.sbb;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertTrue;

import java.util.List;
import java.util.Optional;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.transaction.annotation.Transactional;


@SpringBootTest
class SbbApplicationTests {

    @Autowired
    private QuestionRepository questionRepository;

    @Transactional
    @Test
    void testJpa() {
        Optional<Question> oq = this.questionRepository.findById(2);
        assertTrue(oq.isPresent());
        Question q = oq.get();

        List<Answer> answerList = q.getAnswerList();

        assertEquals(1, answerList.size());
        assertEquals("ë„¤ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.", answerList.get(0).getContent());
    }
}
```

ìœ„ì™€ ê°™ì´ `testJpa` ë©”ì„œë“œì— `@Transactional` ì• ë„ˆí…Œì´ì…˜ì„ ì¶”ê°€í•˜ë©´ ì˜¤ë¥˜ì—†ì´ ì˜ ìˆ˜í–‰ë  ê²ƒì´ë‹¤.

---
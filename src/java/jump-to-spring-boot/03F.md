---
lang: ko-KR
title: 3-06. íšŒì›ê°€ì…
description: ğŸƒJump to Spring Boot > 3-06. íšŒì›ê°€ì…
tags: ["crashcourse", "java", "spring", "spring-boot" , "jdk", "wikidocs"]
meta:
  - name: ğŸƒJump to Spring Boot > 3ì¥ - SBB ì„œë¹„ìŠ¤ ê°œë°œ! > 3-06. íšŒì›ê°€ì…
    content: 3-06. íšŒì›ê°€ì…
  - property: og:title
    content: 3-06. íšŒì›ê°€ì…
  - property: og:description
    content: ğŸƒJump to Spring Boot > 3ì¥ - SBB ì„œë¹„ìŠ¤ ê°œë°œ! > 3-06. íšŒì›ê°€ì…
  - property: og:url
    content: https://chanhi2000.github.io/crashcourse/java-jump-to-spring-boot/03F.html
---

# {{ $frontmatter.title }} ê´€ë ¨

> {{ $frontmatter.description }}

[[toc]]

---

```card
title: 3-06. íšŒì›ê°€ì…
desc: ì í”„ íˆ¬ ìŠ¤í”„ë§ë¶€íŠ¸ - WikiDocs
link: https://wikidocs.net/162141
logo: https://wikidocs.net/static/img/favicon.ico
color: rgba(255, 255, 255, 0.2)
```

---

> [<FontIcon icon="iconfont icon-github"/> `pahkey/sbb3` - <FontIcon icon="iconfont icon-folder"/> `3-06`](https://github.com/pahkey/sbb3/tree/3-06)

<YouTube id="VEEu1N7Edws"/>

ì´ë²ˆì—ëŠ” SBBì— íšŒì›ê°€ì… ê¸°ëŠ¥ì„ êµ¬í˜„í•´ ë³´ì.

> íšŒì›ê°€ì… ê¸°ëŠ¥ì„ ë§Œë“¤ì–´ ë³´ì•˜ë‹¤ë©´ ì›¹ í”„ë¡œê·¸ë˜ë°ì€ ê±°ì˜ ë§ˆìŠ¤í„°í–ˆë‹¤ê³  í•  ìˆ˜ ìˆë‹¤. ê·¸ë§Œí¼ íšŒì›ê°€ì… ê¸°ëŠ¥ì€ ì›¹ ì‚¬ì´íŠ¸ì—ì„œ í•µì‹¬ ì¤‘ì˜ í•µì‹¬ì´ë¼ í•  ìˆ˜ ìˆë‹¤.

---

## íšŒì› ì •ë³´ë¥¼ ìœ„í•œ ì—”í‹°í‹°

ì§€ê¸ˆê¹Œì§€ëŠ” ì§ˆë¬¸, ë‹µë³€ ì—”í‹°í‹°ë§Œ ì‚¬ìš©í–ˆë‹¤ë©´ ì´ì œ íšŒì› ì •ë³´ë¥¼ ìœ„í•œ ì—”í‹°í‹°ê°€ í•„ìš”í•˜ë‹¤. íšŒì› ì •ë³´ ì—”í‹°í‹°ì—ëŠ” ìµœì†Œí•œ ë‹¤ìŒê³¼ ê°™ì€ ì†ì„±ì´ í•„ìš”í•˜ë‹¤.

| ì†ì„± | ì„¤ëª… |
| :--- | :--- |
| `username` | ì‚¬ìš©ì ì´ë¦„ (ì‚¬ìš©ì ID) |
| `password` | ë¹„ë°€ë²ˆí˜¸ |
| `email` | ì´ë©”ì¼ |

### User ë„ë©”ì¸

ê·¸ë¦¬ê³  íšŒì›ì€ ì§ˆë¬¸, ë‹µë³€ ë„ë©”ì¸ì´ ì•„ë‹ˆë¯€ë¡œ `user`ë¼ëŠ” ë„ë©”ì¸ì„ ì‚¬ìš©í•  ê²ƒì´ë‹¤. ë‹¤ìŒê³¼ ê°™ì´ `com.mysite.sbb.user` íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•˜ì.

![06_1](https://wikidocs.net/images/page/162141/C_3-06_1.png)

### `SiteUser` ì—”í‹°í‹°

ê·¸ë¦¬ê³  ì‚¬ìš©ìë¥¼ ê´€ë¦¬í•  `SiteUser` ì—”í‹°í‹°ë¥¼ ë‹¤ìŒì²˜ëŸ¼ ì‘ì„±í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/user/`<FontIcon icon="iconfont icon-java"/>`SiteUser.java`

```java
package com.mysite.sbb.user;

import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.GenerationType;
import jakarta.persistence.Id;

import lombok.Getter;
import lombok.Setter;

@Getter
@Setter
@Entity
public class SiteUser {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(unique = true)
    private String username;

    private String password;

    @Column(unique = true)
    private String email;
}
```

`Question`, `Answer` ì—”í‹°í‹°ì™€ ë™ì¼í•œ ë°©ë²•ìœ¼ë¡œ `SiteUser` ì—”í‹°í‹°ë¥¼ ë§Œë“¤ì—ˆë‹¤. ì—”í‹°í‹°ëª…ì„ `User` ëŒ€ì‹  `SiteUser`ë¡œ í•œ ì´ìœ ëŠ” ìŠ¤í”„ë§ ì‹œíë¦¬í‹°ì— ì´ë¯¸ `User` í´ë˜ìŠ¤ê°€ ìˆê¸° ë•Œë¬¸ì´ë‹¤. ë¬¼ë¡  íŒ¨í‚¤ì§€ëª…ì´ ë‹¬ë¼ `User`ë¼ëŠ” ì´ë¦„ì„ ì‚¬ìš©í• ìˆ˜ ìˆì§€ë§Œ íŒ¨í‚¤ì§€ ì˜¤ìš©ìœ¼ë¡œ ì¸í•œ ì˜¤ë¥˜ê°€ ë°œìƒí• ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì´ ì±…ì—ì„œëŠ” `User` ëŒ€ì‹  `SiteUser`ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ëª…ëª…í•˜ì˜€ë‹¤.

ê·¸ë¦¬ê³  `username`, `email` ì†ì„±ì—ëŠ” `@Column(unique = true)` ì²˜ëŸ¼ `unique = true`ë¥¼ ì§€ì •í–ˆë‹¤. `unique = true`ëŠ” ìœ ì¼í•œ ê°’ë§Œ ì €ì¥í•  ìˆ˜ ìˆìŒì„ ì˜ë¯¸í•œë‹¤. ì¦‰, ê°’ì„ ì¤‘ë³µë˜ê²Œ ì €ì¥í•  ìˆ˜ ì—†ìŒì„ ëœ»í•œë‹¤. ì´ë ‡ê²Œ í•´ì•¼ `username`ê³¼ `email`ì— ë™ì¼í•œ ê°’ì´ ì €ì¥ë˜ì§€ ì•ŠëŠ”ë‹¤.

### `SiteUser` í…Œì´ë¸”

`SiteUser` ì—”í‹°í‹°ë¥¼ ì‘ì„±í•˜ê³  H2 ì½˜ì†”ì— ì ‘ì†í•˜ì—¬ í…Œì´ë¸”ì´ ì˜ ë§Œë“¤ì–´ì¡ŒëŠ”ì§€ í™•ì¸í•´ ë³´ì.

![06_2](https://wikidocs.net/images/page/162141/C_3-06_2.png)

`SITE_USER` í…Œì´ë¸”ê³¼ ì»¬ëŸ¼ë“¤ ê·¸ë¦¬ê³  `unique`ë¡œ ì„¤ì •í•œ ì†ì„±ë“¤ë¡œ ì¸í•´ ìƒê¸´ UK_ë¡œ ì‹œì‘í•˜ëŠ” ì¸ë±ìŠ¤ë“¤ì´ ë³´ì¼ ê²ƒì´ë‹¤.

---

## `User` ë¦¬í¬ì§€í„°ë¦¬ì™€ ì„œë¹„ìŠ¤

ì‚¬ìš©ì ì—”í‹°í‹°ê°€ ì¤€ë¹„ë˜ì—ˆìœ¼ë‹ˆ ì´ì œ `User` ë¦¬í¬ì§€í„°ë¦¬ì™€ `User` ì„œë¹„ìŠ¤ë¥¼ ë§Œë“¤ì–´ ë³´ì.

### `User` ë¦¬í¬ì§€í„°ë¦¬

ë‹¤ìŒê³¼ ê°™ì´ `UserRepository`ë¥¼ ì‘ì„±í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/user/`<FontIcon icon="iconfont icon-java"/>`UserRepository.java`

```java
package com.mysite.sbb.user;

import org.springframework.data.jpa.repository.JpaRepository;

public interface UserRepository extends JpaRepository<SiteUser, Long> {
}
```

`SiteUser`ì˜ PKì˜ íƒ€ì…ì€ `Long`ì´ë‹¤. ë”°ë¼ì„œ `JpaRepository<SiteUser, Long>`ì²˜ëŸ¼ ì‚¬ìš©í–ˆë‹¤.

### User ì„œë¹„ìŠ¤

ê·¸ë¦¬ê³  ë‹¤ìŒê³¼ ê°™ì´ UserServiceë¥¼ ì‘ì„±í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/user/`<FontIcon icon="iconfont icon-java"/>`UserService.java`

```java
package com.mysite.sbb.user;

import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.stereotype.Service;

import lombok.RequiredArgsConstructor;

@RequiredArgsConstructor
@Service
public class UserService {

    private final UserRepository userRepository;

    public SiteUser create(String username, String email, String password) {
        SiteUser user = new SiteUser();
        user.setUsername(username);
        user.setEmail(email);
        BCryptPasswordEncoder passwordEncoder = new BCryptPasswordEncoder();
        user.setPassword(passwordEncoder.encode(password));
        this.userRepository.save(user);
        return user;
    }
}
```

`User` ì„œë¹„ìŠ¤ì—ëŠ” `User` ë¦¬í¬ì§€í„°ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ `User` ë°ì´í„°ë¥¼ ìƒì„±í•˜ëŠ” create ë©”ì„œë“œë¥¼ ì¶”ê°€í–ˆë‹¤. ì´ ë•Œ ì‚¬ìš©ìì˜ ë¹„ë°€ë²ˆí˜¸ëŠ” ë³´ì•ˆì„ ìœ„í•´ ë°˜ë“œì‹œ ì•”í˜¸í™”í•˜ì—¬ ì €ì¥í•´ì•¼ í•œë‹¤. ì•”í˜¸í™”ë¥¼ ìœ„í•´ ì‹œíë¦¬í‹°ì˜ `BCryptPasswordEncoder` í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì•”í˜¸í™”í•˜ì—¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì €ì¥í–ˆë‹¤.

> `BCryptPasswordEncoder`ëŠ” BCrypt í•´ì‹± í•¨ìˆ˜(BCrypt hashing function)ë¥¼ ì‚¬ìš©í•´ì„œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì•”í˜¸í™”í•œë‹¤.

í•˜ì§€ë§Œ ì´ë ‡ê²Œ `BCryptPasswordEncoder` ê°ì²´ë¥¼ ì§ì ‘ newë¡œ ìƒì„±í•˜ëŠ” ë°©ì‹ë³´ë‹¤ëŠ” `PasswordEncoder` ë¹ˆ(bean)ìœ¼ë¡œ ë“±ë¡í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. ì™œëƒí•˜ë©´ ì•”í˜¸í™” ë°©ì‹ì„ ë³€ê²½í•˜ë©´ `BCryptPasswordEncoder`ë¥¼ ì‚¬ìš©í•œ ëª¨ë“  í”„ë¡œê·¸ë¨ì„ ì¼ì¼ì´ ì°¾ì•„ì„œ ìˆ˜ì •í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

> `PasswordEncoder`ëŠ” `BCryptPasswordEncoder`ì˜ ì¸í„°í˜ì´ìŠ¤ì´ë‹¤.

`PasswordEncoder` ë¹ˆ(bean)ì„ ë§Œë“œëŠ” ê°€ì¥ ì‰¬ìš´ ë°©ë²•ì€ `@Configuration`ì´ ì ìš©ëœ `SecurityConfig`ì— `@Bean` ë©”ì„œë“œë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì´ë‹¤. ë‹¤ìŒê³¼ ê°™ì´ `SecurityConfig`ë¥¼ ìˆ˜ì •í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/`<FontIcon icon="iconfont icon-java"/>`SecurityConfig.java`

```java{2-3,23-26}
// (... ìƒëµ ...)
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;
// (... ìƒëµ ...)

@Configuration
@EnableWebSecurity
public class SecurityConfig {
    @Bean
    SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            .authorizeHttpRequests((authorizeHttpRequests) -> authorizeHttpRequests
                .requestMatchers(new AntPathRequestMatcher("/**")).permitAll())
            .csrf((csrf) -> csrf
                .ignoringRequestMatchers(new AntPathRequestMatcher("/h2-console/**")))
            .headers((headers) -> headers
                .addHeaderWriter(new XFrameOptionsHeaderWriter(
                    XFrameOptionsHeaderWriter.XFrameOptionsMode.SAMEORIGIN)))
        ;
        return http.build();
    }

    @Bean
    PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }
}
```

ì´ë ‡ê²Œ `PasswordEncoder`ë¥¼ `@Bean`ìœ¼ë¡œ ë“±ë¡í•˜ë©´ `UserService`ë„ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í• ìˆ˜ ìˆë‹¤.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/user/`<FontIcon icon="iconfont icon-java"/>`UserService.java`

```java{3,13,19}
package com.mysite.sbb.user;

import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.stereotype.Service;

import lombok.RequiredArgsConstructor;

@RequiredArgsConstructor
@Service
public class UserService {

    private final UserRepository userRepository;
    private final PasswordEncoder passwordEncoder;

    public SiteUser create(String username, String email, String password) {
        SiteUser user = new SiteUser();
        user.setUsername(username);
        user.setEmail(email);
        user.setPassword(passwordEncoder.encode(password));
        this.userRepository.save(user);
        return user;
    }
}
```

`BCryptPasswordEncoder` ê°ì²´ë¥¼ ì§ì ‘ ìƒì„±í•˜ì—¬ ì‚¬ìš©í•˜ì§€ ì•Šê³  ë¹ˆìœ¼ë¡œ ë“±ë¡í•œ `PasswordEncoder` ê°ì²´ë¥¼ ì£¼ì…ë°›ì•„ ì‚¬ìš©í•˜ë„ë¡ ìˆ˜ì •í–ˆë‹¤.

---

## íšŒì›ê°€ì… í¼

ê·¸ë¦¬ê³  íšŒì› ê°€ì…ì„ ìœ„í•œ í¼ í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•˜ì. ë‹¤ìŒì²˜ëŸ¼ `UserCreateForm`ì„ ë§Œë“¤ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/user/`<FontIcon icon="iconfont icon-java"/>`UserCreateForm.java`

```java
package com.mysite.sbb.user;

import jakarta.validation.constraints.Email;
import jakarta.validation.constraints.NotEmpty;
import jakarta.validation.constraints.Size;

import lombok.Getter;
import lombok.Setter;

@Getter
@Setter
public class UserCreateForm {
    @Size(min = 3, max = 25)
    @NotEmpty(message = "ì‚¬ìš©ìIDëŠ” í•„ìˆ˜í•­ëª©ì…ë‹ˆë‹¤.")
    private String username;

    @NotEmpty(message = "ë¹„ë°€ë²ˆí˜¸ëŠ” í•„ìˆ˜í•­ëª©ì…ë‹ˆë‹¤.")
    private String password1;

    @NotEmpty(message = "ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì€ í•„ìˆ˜í•­ëª©ì…ë‹ˆë‹¤.")
    private String password2;

    @NotEmpty(message = "ì´ë©”ì¼ì€ í•„ìˆ˜í•­ëª©ì…ë‹ˆë‹¤.")
    @Email
    private String email;
}
```

`username`ì€ í•„ìˆ˜í•­ëª©ì´ê³  ê¸¸ì´ê°€ 3-25 ì‚¬ì´ì—¬ì•¼ í•œë‹¤ëŠ” ê²€ì¦ì¡°ê±´ì„ ì„¤ì •í–ˆë‹¤. `@Size`ëŠ” í¼ ìœ íš¨ì„± ê²€ì¦ì‹œ ë¬¸ìì—´ì˜ ê¸¸ì´ê°€ ìµœì†Œê¸¸ì´(`min`)ì™€ ìµœëŒ€ê¸¸ì´(`max`) ì‚¬ì´ì— í•´ë‹¹í•˜ëŠ”ì§€ë¥¼ ê²€ì¦í•œë‹¤. `password1`ê³¼ `password2`ëŠ” "ë¹„ë°€ë²ˆí˜¸"ì™€ "ë¹„ë°€ë²ˆí˜¸í™•ì¸"ì— ëŒ€í•œ ì†ì„±ì´ë‹¤. ë¡œê·¸ì¸ í• ë•ŒëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ í•œë²ˆë§Œ í•„ìš”í•˜ì§€ë§Œ íšŒì›ê°€ì…ì‹œì—ëŠ” ì…ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ê°€ ì •í™•í•œì§€ í™•ì¸í•˜ê¸° ìœ„í•´ 2ê°œì˜ í•„ë“œê°€ í•„ìš”í•˜ë‹¤. ê·¸ë¦¬ê³  `email` ì†ì„±ì—ëŠ” `@Email` ì• ë„ˆí…Œì´ì…˜ì´ ì ìš©ë˜ì—ˆë‹¤. `@Email`ì€ í•´ë‹¹ ì†ì„±ì˜ ê°’ì´ ì´ë©”ì¼í˜•ì‹ê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ë¥¼ ê²€ì¦í•œë‹¤.

---

## íšŒì›ê°€ì… ì»¨íŠ¸ë¡¤ëŸ¬

ì´ì œ ì‚¬ìš©ì ì—”í‹°í‹°ì™€ ì„œë¹„ìŠ¤ ê·¸ë¦¬ê³  í¼ì´ ì¤€ë¹„ë˜ì—ˆìœ¼ë‹ˆ íšŒì›ê°€ì…ì„ ìœ„í•œ `User` ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë§Œë“¤ì–´ë³´ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/user/`<FontIcon icon="iconfont icon-java"/>`UserController.java`

```java
package com.mysite.sbb.user;

import jakarta.validation.Valid;

import org.springframework.stereotype.Controller;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;

import lombok.RequiredArgsConstructor;

@RequiredArgsConstructor
@Controller
@RequestMapping("/user")
public class UserController {

    private final UserService userService;

    @GetMapping("/signup")
    public String signup(UserCreateForm userCreateForm) {
        return "signup_form";
    }

    @PostMapping("/signup")
    public String signup(@Valid UserCreateForm userCreateForm, BindingResult bindingResult) {
        if (bindingResult.hasErrors()) {
            return "signup_form";
        }

        if (!userCreateForm.getPassword1().equals(userCreateForm.getPassword2())) {
            bindingResult.rejectValue("password2", "passwordInCorrect", 
                    "2ê°œì˜ íŒ¨ìŠ¤ì›Œë“œê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            return "signup_form";
        }

        userService.create(userCreateForm.getUsername(), 
                userCreateForm.getEmail(), userCreateForm.getPassword1());

        return "redirect:/";
    }
}
```

`/user/signup` URLì´ GETìœ¼ë¡œ ìš”ì²­ë˜ë©´ íšŒì› ê°€ì…ì„ ìœ„í•œ í…œí”Œë¦¿ì„ ë Œë”ë§í•˜ê³  POSTë¡œ ìš”ì²­ë˜ë©´ íšŒì›ê°€ì…ì„ ì§„í–‰í•˜ë„ë¡ í–ˆë‹¤. ê·¸ë¦¬ê³  íšŒì› ê°€ì…ì‹œ `ë¹„ë°€ë²ˆí˜¸1`ê³¼ `ë¹„ë°€ë²ˆí˜¸2`ê°€ ë™ì¼í•œì§€ë¥¼ ê²€ì¦í•˜ëŠ” ë¡œì§ì„ ì¶”ê°€í–ˆë‹¤. ë§Œì•½ 2ê°œì˜ ê°’ì´ ì¼ì¹˜í•˜ì§€ ì•Šì„ ê²½ìš°ì—ëŠ” `bindingResult.rejectValue`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ê²Œ í–ˆë‹¤. `bindingResult.rejectValue`ì˜ ê° íŒŒë¼ë¯¸í„°ëŠ” `bindingResult.rejectValue(í•„ë“œëª…, ì˜¤ë¥˜ì½”ë“œ, ì—ëŸ¬ë©”ì‹œì§€)`ë¥¼ ì˜ë¯¸í•˜ë©° ì—¬ê¸°ì„œ ì˜¤ë¥˜ì½”ë“œëŠ” ì¼ë‹¨ "passwordInCorrect"ë¡œ ì •ì˜í–ˆë‹¤.

> ëŒ€í˜• í”„ë¡œì íŠ¸ì—ì„œëŠ” ë²ˆì—­ê³¼ ê´€ë¦¬ë¥¼ ìœ„í•´ ì˜¤ë¥˜ì½”ë“œë¥¼ ì˜ ì •ì˜í•˜ì—¬ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

---

## íšŒì›ê°€ì… í…œí”Œë¦¿

ì´ì–´ì„œ íšŒì›ê°€ì… í…œí”Œë¦¿ì„ ì‘ì„±í•˜ì. ë‹¤ìŒì²˜ëŸ¼ <FontIcon icon="iconfont icon-page"/>`signup_form.html` íŒŒì¼ì„ ì‘ì„±í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/resources/templates/`<FontIcon icon="iconfont icon-page"/>`signup_form.html`

```html
<html layout:decorate="~{layout}">
<div layout:fragment="content" class="container my-3">
    <div class="my-3 border-bottom">
        <div>
            <h4>íšŒì›ê°€ì…</h4>
        </div>
    </div>
    <form th:action="@{/user/signup}" th:object="${userCreateForm}" method="post">
        <div th:replace="~{form_errors :: formErrorsFragment}"></div>
        <div class="mb-3">
            <label for="username" class="form-label">ì‚¬ìš©ìID</label>
            <input type="text" th:field="*{username}" class="form-control">
        </div>
        <div class="mb-3">
            <label for="password1" class="form-label">ë¹„ë°€ë²ˆí˜¸</label>
            <input type="password" th:field="*{password1}" class="form-control">
        </div>
        <div class="mb-3">
            <label for="password2" class="form-label">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
            <input type="password" th:field="*{password2}" class="form-control">
        </div>
        <div class="mb-3">
            <label for="email" class="form-label">ì´ë©”ì¼</label>
            <input type="email" th:field="*{email}" class="form-control">
        </div>
        <button type="submit" class="btn btn-primary">íšŒì›ê°€ì…</button>
    </form>
</div>
</html>
```

íšŒì›ê°€ì…ì„ ìœ„í•œ "ì‚¬ìš©ì ID", "ë¹„ë°€ë²ˆí˜¸", "ë¹„ë°€ë²ˆí˜¸ í™•ì¸", "ì´ë©”ì¼"ì— í•´ë‹¹ë˜ëŠ” input ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì¶”ê°€í–ˆë‹¤. <FontIcon icon="iconfont icon-select"/>`<íšŒì›ê°€ì…>` ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ í¼ ë°ì´í„°ê°€ POST ë°©ì‹ìœ¼ë¡œ `/user/signup/` URLë¡œ ì „ì†¡ëœë‹¤.

---

## ë‚´ë¹„ê²Œì´ì…˜ ë°”ì— íšŒì›ê°€ì… ë§í¬ ì¶”ê°€í•˜ê¸°

ì´ì œ íšŒì›ê°€ì… í™”ë©´ìœ¼ë¡œ ì´ë™í•  ìˆ˜ ìˆëŠ” ë§í¬ë¥¼ ë‚´ë¹„ê²Œì´ì…˜ ë°”ì— ì¶”ê°€í•˜ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>` /sbb/src/main/resources/templates/`<FontIcon icon="iconfont icon-page"/>`navbar.html`

```html{10-12}
<nav th:fragment="navbarFragment" class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
    <div class="container-fluid">
        <a class="navbar-brand" href="/">SBB</a>
        <!-- (... ìƒëµ ...) -->
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a class="nav-link" href="#">ë¡œê·¸ì¸</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" th:href="@{/user/signup}">íšŒì›ê°€ì…</a>
                </li>
            </ul>
        </div>
    </div>
</nav>
```

---

## íšŒì›ê°€ì… ì‹¤í–‰í•´ ë³´ê¸°

ì´ì œ ë‚´ë¹„ê²Œì´ì…˜ ë°”ì˜ "íšŒì›ê°€ì…" ë§í¬ë¥¼ ëˆ„ë¥´ë©´ ë‹¤ìŒê³¼ ê°™ì€ íšŒì›ê°€ì… í™”ë©´ì´ ë‚˜ì˜¨ë‹¤.

![06_3](https://wikidocs.net/images/page/162141/O_3-06_3.png)

ì…ë ¥ê°’ ì¤‘ì—ì„œ ë¹„ë°€ë²ˆí˜¸, ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì„ ë‹¤ë¥´ê²Œ ì…ë ¥í•˜ê³  <FontIcon icon="iconfont icon-select"/>`<íšŒì›ê°€ì…>`ì„ ëˆ„ë¥´ë©´ ê²€ì¦ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì—¬ í™”ë©´ì— ë‹¤ìŒê³¼ ê°™ì€ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ í‘œì‹œí•´ ì¤„ ê²ƒì´ë‹¤.

![06_4](https://wikidocs.net/images/page/162141/O_3-06_4.png)

ì´ì²˜ëŸ¼ ìš°ë¦¬ê°€ ë§Œë“  íšŒì›ê°€ì… ê¸°ëŠ¥ì—ëŠ” í•„ìˆ«ê°’ ê²€ì¦, ì´ë©”ì¼ ê·œì¹™ ê²€ì¦ ë“±ì´ ì ìš©ë˜ì–´ ìˆë‹¤. ì˜¬ë°”ë¥¸ ì…ë ¥ê°’ìœ¼ë¡œ íšŒì›ê°€ì…ì„ ì™„ë£Œí•˜ë©´ ë©”ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë  ê²ƒì´ë‹¤.

---

## íšŒì›ê°€ì… ë°ì´í„° í™•ì¸í•´ ë³´ê¸°

H2 ì½˜ì†”ì—ì„œ ë‹¤ìŒì˜ SQLì„ ì‹¤í–‰í•˜ì—¬ ë°”ë¡œ ì• ë‹¨ê³„ë¥¼ ê±°ì³ ë§Œë“  íšŒì› ì •ë³´ë¥¼ í™•ì¸í•´ ë³´ì.

```sql
SELECT * FROM SITE_USER 
```

![06_5](https://wikidocs.net/images/page/162141/C_3-06_5.png)

ì¶•í•˜í•œë‹¤. ì´ì œ SBB ì„œë¹„ìŠ¤ì— íšŒì›ê°€ì… ê¸°ëŠ¥ì´ ì¶”ê°€ë˜ì—ˆë‹¤.

---

## ì¤‘ë³µ íšŒì›ê°€ì…

ì´ë²ˆì—ëŠ” ì´ë¯¸ ê°€ì…í•œ ë™ì¼í•œ ì‚¬ìš©ìID, ë˜ëŠ” ë™ì¼í•œ ì´ë©”ì¼ ì£¼ì†Œë¡œ íšŒì›ê°€ì…ì„ ì§„í–‰í•´ ë³´ì. ì•„ë§ˆë„ ë‹¤ìŒê³¼ ê°™ì€ ì˜¤ë¥˜ê°€ ë°œìƒí•  ê²ƒì´ë‹¤.

![06_6](https://wikidocs.net/images/page/162141/O_3-06_6.png)

ë™ì¼í•œ ì‚¬ìš©ìID ë˜ëŠ” ë™ì¼í•œ ì´ë©”ì¼ ì£¼ì†Œë¡œ ì‚¬ìš©ì ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ê²ƒì€ `unique=true` ì„¤ì •ìœ¼ë¡œ ì¸í•´ í—ˆìš©ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì˜¤ë¥˜ê°€ ë°œìƒí•˜ëŠ” ê²ƒì€ ë‹¹ì—°í•˜ë‹¤. í•˜ì§€ë§Œ í™”ë©´ì— ì´ë ‡ê²Œ 500 ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ê·¸ëŒ€ë¡œ ë³´ì—¬ì£¼ëŠ” ê²ƒì€ ì¢‹ì§€ ì•Šë‹¤. ë”°ë¼ì„œ íšŒì›ê°€ì…ì‹œ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì²˜ë¦¬í•´ ì£¼ì.

> íŒŒì¼ëª…: <FontIcon icon="iconfont icon-folder"/>`/sbb/src/main/java/com/mysite/sbb/user/`<FontIcon icon="iconfont icon-java"/>`UserController.java`

```java{4,22,25-33}
package com.mysite.sbb.user;

// (... ìƒëµ ...)
import org.springframework.dao.DataIntegrityViolationException;
// (... ìƒëµ ...)
public class UserController {

    // (... ìƒëµ ...)

    @PostMapping("/signup")
    public String signup(@Valid UserCreateForm userCreateForm, BindingResult bindingResult) {
        if (bindingResult.hasErrors()) {
            return "signup_form";
        }

        if (!userCreateForm.getPassword1().equals(userCreateForm.getPassword2())) {
            bindingResult.rejectValue("password2", "passwordInCorrect", 
                    "2ê°œì˜ íŒ¨ìŠ¤ì›Œë“œê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            return "signup_form";
        }

        try {
            userService.create(userCreateForm.getUsername(), 
                    userCreateForm.getEmail(), userCreateForm.getPassword1());
        }catch(DataIntegrityViolationException e) {
            e.printStackTrace();
            bindingResult.reject("signupFailed", "ì´ë¯¸ ë“±ë¡ëœ ì‚¬ìš©ìì…ë‹ˆë‹¤.");
            return "signup_form";
        }catch(Exception e) {
            e.printStackTrace();
            bindingResult.reject("signupFailed", e.getMessage());
            return "signup_form";
        }

        return "redirect:/";
    }
}
```

ì‚¬ìš©ìID ë˜ëŠ” ì´ë©”ì¼ ì£¼ì†Œê°€ ë™ì¼í•  ê²½ìš°ì—ëŠ” `DataIntegrityViolationException`ì´ ë°œìƒí•˜ë¯€ë¡œ `DataIntegrityViolationException` ì˜ˆì™¸ê°€ ë°œìƒí•  ê²½ìš° "ì´ë¯¸ ë“±ë¡ëœ ì‚¬ìš©ìì…ë‹ˆë‹¤."ë¼ëŠ” ì˜¤ë¥˜ë¥¼ í™”ë©´ì— í‘œì‹œí•˜ë„ë¡ í–ˆë‹¤. ê·¸ë¦¬ê³  ë‹¤ë¥¸ ì˜¤ë¥˜ì˜ ê²½ìš°ì—ëŠ” í•´ë‹¹ ì˜¤ë¥˜ì˜ ë©”ì‹œì§€(`e.getMessage()`)ë¥¼ ì¶œë ¥í•˜ë„ë¡ í–ˆë‹¤.

> `bindingResult.reject(ì˜¤ë¥˜ì½”ë“œ, ì˜¤ë¥˜ë©”ì‹œì§€)`ëŠ” íŠ¹ì • í•„ë“œì˜ ì˜¤ë¥˜ê°€ ì•„ë‹Œ ì¼ë°˜ì ì¸ ì˜¤ë¥˜ë¥¼ ë“±ë¡í• ë•Œ ì‚¬ìš©í•œë‹¤.

ì´ë ‡ê²Œ ìˆ˜ì •í•˜ê³  ë‹¤ì‹œ ë™ì¼í•œ ì‚¬ìš©ìë¡œ íšŒì›ê°€ì…ì„ í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì •ìƒì ì¸ ì˜¤ë¥˜ë¥¼ í‘œì‹œí•˜ëŠ” í™”ë©´ì„ ë³¼ìˆ˜ ìˆë‹¤.

![06_7](https://wikidocs.net/images/page/162141/O_3-06_7.png)

---

<TagLinks />
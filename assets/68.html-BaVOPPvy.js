import{_ as d}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as h,a as n,t as k,b as s,w as t,n as o,g as i,e as c,r,o as m,d as p}from"./app-U_bew1in.js";const w={},g={id:"frontmatter-title-관련",tabindex:"-1"},f={class:"header-anchor",href:"#frontmatter-title-관련"},v={class:"table-of-contents"},b=n("hr",null,null,-1),y=c('<h2 id="project-14-part-1" tabindex="-1"><a class="header-anchor" href="#project-14-part-1"><span>Project 14, part 1</span></a></h2><p>You’ll be pleased to know that today is the easiest day you will have had in a while. That doesn’t mean we’re looking at unimportant stuff, only that the new techniques we’re covering are pretty much guaranteed to be a welcome break from Core Image!</p><p>All I can is this: enjoy it while it lasts! Tomorrow we’re back on to the hard stuff, which I hope shouldn’t come as a surprise given that you’re well past the two-thirds mark in these 100 days.</p><p>Keep going! As Vince Lombardi said, “the only place success comes before work is in the dictionary.”</p><p><strong>Today you have four topics to work through, in which you’ll learn how about implementing <code>Comparable</code>, finding the user’s documents directory, and more.</strong></p><h3 id="bucket-list-introduction" tabindex="-1"><a class="header-anchor" href="#bucket-list-introduction"><span>Bucket List: Introduction</span></a></h3><p>::: deatils Bucket List: Introduction</p>',7),S=c('<p>In this project we’re going to build an app that lets the user build a private list of places on the map that they intend to visit one day, add a description for that place, look up interesting places that are nearby, and save it all to the iOS storage for later.</p><p>To make all that work will mean leveraging some skills you’ve met already, such as forms, sheets, <code>Codable</code>, and <code>URLSession</code>, but also teach you some new skills: how to embed maps in a SwiftUI app, how to store private data safely so that only an authenticated user can access it, how to load and save data outside of <code>UserDefaults</code>, and more.</p><p>So, lots to learn and another great app to make! Anyway, let’s get started with our techniques: create a new iOS project using the App template, and name it BucketList. And now on to our techniques…</p><p>:::</p><h3 id="adding-conformance-to-comparable-for-custom-types" tabindex="-1"><a class="header-anchor" href="#adding-conformance-to-comparable-for-custom-types"><span>Adding conformance to <code>Comparable</code> for custom types</span></a></h3><p>::: deatils Adding conformance to Comparable for custom types</p>',6),q=c(`<p>When you think about it, we take a heck of a lot of stuff for granted when we write Swift code. For example, if we write <code>4 &lt; 5</code>, we expect that to return true – the developers of Swift (and LLVM, larger compiler project that sits behind Swift) have already done all the hard work of checking whether that calculation is actually true, so we don’t have to worry about it.</p><p>But what Swift does <em>really</em> well is extend functionality into lots of places using protocols and protocol extensions. For example, we know that <code>4 &lt; 5</code> is true because we’re able to compare two integers and decide whether the first one comes before or after the second. Swift extends that functionality to arrays of integers: we can compare all the integers in an array to decide whether each one should come before or after the others. Swift then uses that result to sort the array.</p><p>So, in Swift we expect this kind of code to Just Work:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span>  </span>
<span class="line">    <span class="token keyword">let</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">List</span><span class="token punctuation">(</span>values<span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token punctuation">\\</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">(</span><span class="token short-argument">$0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We don’t need to tell <code>sorted()</code> how it should work, because it understands how arrays of integers work.</p><p>Now consider a struct like this one:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">struct</span> <span class="token class-name">User</span><span class="token punctuation">:</span> <span class="token class-name">Identifiable</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token function">UUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">var</span> firstName<span class="token punctuation">:</span> <span class="token class-name">String</span></span>
<span class="line">    <span class="token keyword">var</span> lastName<span class="token punctuation">:</span> <span class="token class-name">String</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We could make an array of those users, and use them inside a <code>List</code> like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> users <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">        <span class="token class-name">User</span><span class="token punctuation">(</span>firstName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Arnold&quot;</span></span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Rimmer&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token class-name">User</span><span class="token punctuation">(</span>firstName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Kristine&quot;</span></span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Kochanski&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token class-name">User</span><span class="token punctuation">(</span>firstName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;David&quot;</span></span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Lister&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">List</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span> <span class="token punctuation">{</span> user <span class="token keyword">in</span></span>
<span class="line">            <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;</span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">user<span class="token punctuation">.</span>lastName</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">, </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">user<span class="token punctuation">.</span>firstName</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That will work just fine, because we made the <code>User</code> struct conform to <code>Identifiable</code>.</p><p>But how about if we wanted to show those users in a sorted order? If we modify the code to this it won’t work:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> users <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token class-name">User</span><span class="token punctuation">(</span>firstName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Arnold&quot;</span></span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Rimmer&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token class-name">User</span><span class="token punctuation">(</span>firstName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Kristine&quot;</span></span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Kochanski&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token class-name">User</span><span class="token punctuation">(</span>firstName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;David&quot;</span></span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Lister&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Swift doesn’t understand what <code>sorted()</code> means here, because it doesn’t know whether to sort by first name, last name, both, or something else.</p><p>One way to do this is by providing a closure to <code>sorted()</code> to do the sorting ourselves. We&#39;ll be handed two objects from the array, <code>$0</code> and <code>$1</code> if you&#39;re using shorthand names, and we should return true if the first object should be sorted before the second, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> users <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token class-name">User</span><span class="token punctuation">(</span>firstName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Arnold&quot;</span></span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Rimmer&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token class-name">User</span><span class="token punctuation">(</span>firstName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Kristine&quot;</span></span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Kochanski&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token class-name">User</span><span class="token punctuation">(</span>firstName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;David&quot;</span></span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Lister&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">.</span>sorted <span class="token punctuation">{</span></span>
<span class="line">    <span class="token short-argument">$0</span><span class="token punctuation">.</span>lastName <span class="token operator">&lt;</span> <span class="token short-argument">$1</span><span class="token punctuation">.</span>lastName</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That absolutely works, but it’s not an ideal solution for two reasons.</p><p>First, this is <em>model</em> data, by which I mean that it’s affecting the way we work with the <code>User</code> struct. That struct and its properties are our data model, and in a well-developed application we don’t really want to tell the model how it should behave inside our SwiftUI code. SwiftUI represents our <em>view</em>, <em>i.e.</em> our layout, and if we put model code in there then things get confused.</p><p>Second, what happens if we want to sort <code>User</code> arrays in multiple places? You might copy and paste the closure once or twice, before realizing you’re just creating a problem for yourself: if you end up changing your sorting logic so that you also use <code>firstName</code> if the last name is the same, then you need to search through all your code to make sure all the closures get updated.</p><p>Swift has a better solution. Arrays of integers get a simple <code>sorted()</code> method with no parameters because Swift understands how to compare two integers. In coding terms, <code>Int</code> conforms to the <code>Comparable</code> protocol, which means it defines a function that takes two integers and returns true if the first should be sorted before the second.</p><p>We can make our own types conform to <code>Comparable</code>, and when we do so we <em>also</em> get a <code>sorted()</code> method with no parameters. This takes two steps:</p><ol><li>Add the <code>Comparable</code> conformance to the definition of <code>User</code>.</li><li>Add a method called <code>&lt;</code> that takes two users and returns true if the first should be sorted before the second.</li></ol><p>Here’s how that looks in code:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">struct</span> <span class="token class-name">User</span><span class="token punctuation">:</span> <span class="token class-name">Identifiable</span><span class="token punctuation">,</span> <span class="token class-name">Comparable</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token function">UUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">var</span> firstName<span class="token punctuation">:</span> <span class="token class-name">String</span></span>
<span class="line">    <span class="token keyword">var</span> lastName<span class="token punctuation">:</span> <span class="token class-name">String</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">static</span> <span class="token keyword">func</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>lhs<span class="token punctuation">:</span> <span class="token class-name">User</span><span class="token punctuation">,</span> rhs<span class="token punctuation">:</span> <span class="token class-name">User</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Bool</span> <span class="token punctuation">{</span></span>
<span class="line">        lhs<span class="token punctuation">.</span>lastName <span class="token operator">&lt;</span> rhs<span class="token punctuation">.</span>lastName</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>There’s not a lot of code in there, but there is still a lot to unpack.</p><p>First, yes the method is just called <code>&lt;</code>, which is the “less than” operator. It’s the job of the method to decide whether one user is “less than” (in a sorting sense) another, so we’re adding functionality to an existing operator. This is called <em>operator overloading</em>, and it can be both a blessing and a curse.</p><p>Second, <code>lhs</code> and <code>rhs</code> are coding conventions short for “left-hand side” and “right-hand side”, and they are used because the <code>&lt;</code> operator has one operand on its left and one on its right.</p><p>Third, this method must return a Boolean, which means we <em>must</em> decide whether one object should be sorted before another. There is no room for “they are the same” here – that’s handled by another protocol called <code>Equatable</code>.</p><p>Fourth, the method must be marked as <code>static</code>, which means it’s called on the <code>User</code> struct directly rather than a single instance of the struct.</p><p>Finally, our logic here is pretty simple: we’re just passing on the comparison to one of our properties, asking Swift to use <code>&lt;</code> for the two last name strings. You can add as much logic as you want, comparing as many properties as needed, but ultimately you need to return true or false.</p><p><strong>Tip</strong>: One thing you <em>can’t</em> see in that code is that conforming to <code>Comparable</code> also gives us access to the <code>&gt;</code> operator – greater than. This is the opposite of <code>&lt;</code>, so Swift creates it for us by using <code>&lt;</code> and flipping the Boolean between true and false.</p><p>Now that our <code>User</code> struct conforms to <code>Comparable</code>, we automatically get access to the parameter-less version of <code>sorted()</code>, which means this kind of code works now:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> users <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token class-name">User</span><span class="token punctuation">(</span>firstName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Arnold&quot;</span></span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Rimmer&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token class-name">User</span><span class="token punctuation">(</span>firstName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Kristine&quot;</span></span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Kochanski&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token class-name">User</span><span class="token punctuation">(</span>firstName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;David&quot;</span></span><span class="token punctuation">,</span> lastName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Lister&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This resolves the problems we had before: we now isolate our model functionality in the struct itself, and we no longer need to copy and paste code around – we can use <code>sorted()</code> everywhere, safe in the knowledge that if we ever change the algorithm then all our code will adapt.</p><p>:::</p><h3 id="writing-data-to-the-documents-directory" tabindex="-1"><a class="header-anchor" href="#writing-data-to-the-documents-directory"><span>Writing data to the documents directory</span></a></h3><p>::: deatils Writing data to the documents directory</p>`,36),x=c(`<p>Previously we looked at how to read and write data to <code>UserDefaults</code>, which works great for user settings or small amounts of JSON, and we also looked at SwiftData, which is a great choice for times when you want relationships between objects, or more advanced sorting and filtering.</p><p>In this app we’re going to look at a middle ground: we&#39;ll just write our data to a file directly. This isn&#39;t because I hate SwiftData, and in fact I think SwiftData would make a good choice here. Instead, it&#39;s so that I can show you the full spread of what&#39;s possible in iOS development, because there are lots of apps you&#39;ll work on that use exactly this approach to saving their data – it&#39;s good that you can at least see how it works.</p><p>That being said, using <code>UserDefaults</code> <em>is</em> definitely a bad idea here, because there&#39;s no limit to how much data users can create in the app. <code>UserDefaults</code> is better used for simple settings and similar.</p><p>Fortunately, iOS makes it very easy to read and write data from device storage, and in fact all apps get a directory for storing any kind of documents we want. Files here are automatically synchronized with iCloud backups, so if the user gets a new device then our data will be restored along with all the other system data – we don’t even need to think about it.</p><p>There is a small catch – isn’t there always? – and it’s that all iOS apps are <em>sandboxed</em>, which means they run in their own container with a hard to guess directory name. As a result, we can’t – and shouldn’t try to – guess the directory where our app is installed, and instead need to rely on a special URL that points to our app’s documents directory:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token function">print</span><span class="token punctuation">(</span><span class="token constant">URL</span><span class="token punctuation">.</span>documentsDirectory<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>That documents directory is ours to do with as we please, and because it belongs to the app it will automatically get deleted if the app itself gets deleted. Other than physical device limitations there is no limit to how much we can store, although remember that users can use the Settings app to see how much storage your app takes up – be respectful!</p><p>Now that we have a directory to work with, we can read and write files there freely. You already met <code>String(contentsOf:)</code> and <code>Data(contentsOf:)</code> for <em>reading</em> data, but for writing data we need to use the <code>write(to:)</code> method. This takes two parameters:</p><ol><li>A <code>URL</code> to write to.</li><li>Any additional options to use when saving.</li></ol><p>The first of those can be created by combining the documents directory URL with a filename, such as myfile.txt.</p><p>As for the second, I prefer to give it two values as an array: <code>.atomic</code> and <code>.completeFileProtection</code>. They do very different things, but both are important:</p><ol><li>Asking for atomic saving means the whole file should be written in one lump. If this isn&#39;t included and we try to write a big file, it’s possible that another part of our app might try and read the file while it’s still being written. This shouldn’t cause a crash or anything, but it <em>does</em> mean that it’s going to read only part of the data, because the other part hasn’t been written yet. <em>Atomic</em> writing causes the system to write our full file to a temporary filename (not the one we asked for), and when that’s finished it does a simple rename to our target filename. This means either the whole file is there or nothing is.</li><li>Asking for complete file protection means iOS automatically (and transparently) encrypts the file, and only allows our app to read it while the device is unlocked. iOS does a great job of keeping user data secure, but there&#39;s no harm being extra safe!</li></ol><p>To put all this code into action, we’re going to modify the default code from our template so that it writes a test string to a file in the documents directory, reads it back into a new string, then prints it out – the complete cycle of reading and writing data.</p><p>Change the <code>body</code> property of <code>ContentView</code> to this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Read and Write&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token class-name">Data</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Test Message&quot;</span></span><span class="token punctuation">.</span>utf8<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span>documentsDirectory<span class="token punctuation">.</span><span class="token function">appending</span><span class="token punctuation">(</span>path<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;message.txt&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">do</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">try</span> data<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>to<span class="token punctuation">:</span> url<span class="token punctuation">,</span> options<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">.</span>atomic<span class="token punctuation">,</span> <span class="token punctuation">.</span>completeFileProtection<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">let</span> input <span class="token operator">=</span> <span class="token keyword">try</span> <span class="token class-name">String</span><span class="token punctuation">(</span>contentsOf<span class="token punctuation">:</span> url<span class="token punctuation">)</span></span>
<span class="line">        <span class="token function">print</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">print</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>localizedDescription<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>When that runs you should be able to tap the label to see “Test message” printed to Xcode’s debug output area.</p><p>Before we move on, here’s a small challenge for you: back in project 8 we looked at how to create a generic extension on <code>Bundle</code> that let us find, load, and decode any <code>Codable</code> data from our app bundle. Can you write something similar for the documents directory, perhaps making it an extension on <code>FileManager</code>?</p><p>:::</p><h3 id="switching-view-states-with-enums" tabindex="-1"><a class="header-anchor" href="#switching-view-states-with-enums"><span>Switching view states with enums</span></a></h3><p>::: deatils Switching view states with enums</p>`,20),U=c(`<p>You’ve seen how we can use regular Swift conditions to present one type of view or the other, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">if</span> <span class="token class-name">Bool</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Tip: When returning different kinds of view, make sure you’re either inside the <code>body</code> property or using something like <code>@ViewBuilder</code> or <code>Group</code>.</p><p>Where conditional views are particularly useful is when we want to show one of several different states, and if we plan it correctly we can keep our view code small and also easy to maintain – it’s a great way to start training your brain to think about SwiftUI architecture.</p><p>There are two parts to this solution. The first is to define an enum for the various view states you want to represent. For example, you might define this as a nested enum:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">enum</span> <span class="token class-name">LoadingState</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">case</span> loading<span class="token punctuation">,</span> success<span class="token punctuation">,</span> failed</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Next, create individual views for those states. I’m just going to use simple text views here, but they could hold anything:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">struct</span> <span class="token class-name">LoadingView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Loading...&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">struct</span> <span class="token class-name">SuccessView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Success!&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">struct</span> <span class="token class-name">FailedView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Failed.&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Those views could be nested if you want, but they don’t have to be – it really depends on whether you plan to use them elsewhere and the size of your app.</p><p>With those two parts in place, we now effectively use <code>ContentView</code> as a simple wrapper that tracks the current app state and shows the relevant child view. That means giving it a property to store the current <code>LoadingState</code> value:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> loadingState <span class="token operator">=</span> <span class="token class-name">LoadingState</span><span class="token punctuation">.</span>loading</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Then filling in its <code>body</code> property with code that shows the correct view based on the enum value, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">if</span> loadingState <span class="token operator">==</span> <span class="token punctuation">.</span>loading <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">LoadingView</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> loadingState <span class="token operator">==</span> <span class="token punctuation">.</span>success <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">SuccessView</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> loadingState <span class="token operator">==</span> <span class="token punctuation">.</span>failed <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">FailedView</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can also use a <code>switch</code> block instead, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">switch</span> loadingState <span class="token punctuation">{</span></span>
<span class="line"><span class="token keyword">case</span> <span class="token punctuation">.</span>loading<span class="token punctuation">:</span></span>
<span class="line">    <span class="token class-name">LoadingView</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">case</span> <span class="token punctuation">.</span>success<span class="token punctuation">:</span></span>
<span class="line">    <span class="token class-name">SuccessView</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">case</span> <span class="token punctuation">.</span>failed<span class="token punctuation">:</span></span>
<span class="line">    <span class="token class-name">FailedView</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Tip</strong>: Switching over an enum has the advantage that Swift checks all our cases are covered correctly, which means if you add another case in the future you&#39;ll be told to handle it correctly.</p><p>Using this approach our <code>ContentView</code> doesn’t spiral out of control as more and more code gets added to the views, and in fact has no idea what loading, success, or failure even look like.</p><p>:::</p><hr>`,19);function T(u,N){const a=r("router-link"),e=r("VPCard"),l=r("VidStack");return m(),h("div",null,[n("h1",g,[n("a",f,[n("span",null,k(u.$frontmatter.title)+" 관련",1)])]),n("nav",v,[n("ul",null,[n("li",null,[s(a,{to:"#project-14-part-1"},{default:t(()=>[p("Project 14, part 1")]),_:1}),n("ul",null,[n("li",null,[s(a,{to:"#bucket-list-introduction"},{default:t(()=>[p("Bucket List: Introduction")]),_:1})]),n("li",null,[s(a,{to:"#adding-conformance-to-comparable-for-custom-types"},{default:t(()=>[p("Adding conformance to Comparable for custom types")]),_:1})]),n("li",null,[s(a,{to:"#writing-data-to-the-documents-directory"},{default:t(()=>[p("Writing data to the documents directory")]),_:1})]),n("li",null,[s(a,{to:"#switching-view-states-with-enums"},{default:t(()=>[p("Switching view states with enums")]),_:1})])])])])]),b,s(e,o(i({title:"100 Days of SwiftUI - Day 68",desc:"Project 14, part 1",link:"https://www.hackingwithswift.com/100/swiftui/68",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),y,s(e,o(i({title:"100 Days of SwiftUI - Day 68 - Bucket List: Introduction",desc:"Bucket List: Introduction",link:"https://www.hackingwithswift.com/books/ios-swiftui/bucket-list-introduction",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),S,s(e,o(i({title:"100 Days of SwiftUI - Day 68 - Adding conformance to Comparable for custom types",desc:"Adding conformance to Comparable for custom types",link:"https://www.hackingwithswift.com/books/ios-swiftui/adding-conformance-to-comparable-for-custom-types",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),s(l,{src:"youtube/oLhjqLgLr4s"}),q,s(e,o(i({title:"100 Days of SwiftUI - Day 68 - Writing data to the documents directory",desc:"Writing data to the documents directory",link:"https://www.hackingwithswift.com/books/ios-swiftui/writing-data-to-the-documents-directory",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),s(l,{src:"youtube/Ivzd2TtSh6s"}),x,s(e,o(i({title:"100 Days of SwiftUI - Day 68 - Switching view states with enums",desc:"Switching view states with enums",link:"https://www.hackingwithswift.com/books/ios-swiftui/switching-view-states-with-enums",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),s(l,{src:"youtube/IWcmNBoT0-s"}),U])}const I=d(w,[["render",T],["__file","68.html.vue"]]),D=JSON.parse('{"path":"/swift/100-days-of-swiftui/68.html","title":"Day 68","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Day 68","description":"100 Days of SwiftUI > Day 68","category":["Swift"],"tag":["crashcourse","paul-hudson","swift","swiftui","hacking-with-swift","xcode","appstore"],"head":[[{"meta":null},{"property":"og:title","content":"100 Days of SwiftUI > Day 68"},{"property":"og:description","content":"Day 68"},{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/swift/100-days-of-swiftui/68.html"}],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/crashcourse/swift/100-days-of-swiftui/68.html"}],["meta",{"property":"og:site_name","content":"🥁Crashcourse"}],["meta",{"property":"og:title","content":"Day 68"}],["meta",{"property":"og:description","content":"100 Days of SwiftUI > Day 68"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"og:updated_time","content":"2024-10-03T01:20:13.000Z"}],["meta",{"property":"article:tag","content":"crashcourse"}],["meta",{"property":"article:tag","content":"paul-hudson"}],["meta",{"property":"article:tag","content":"swift"}],["meta",{"property":"article:tag","content":"swiftui"}],["meta",{"property":"article:tag","content":"hacking-with-swift"}],["meta",{"property":"article:tag","content":"xcode"}],["meta",{"property":"article:tag","content":"appstore"}],["meta",{"property":"article:modified_time","content":"2024-10-03T01:20:13.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Day 68\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-10-03T01:20:13.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"Project 14, part 1","slug":"project-14-part-1","link":"#project-14-part-1","children":[{"level":3,"title":"Bucket List: Introduction","slug":"bucket-list-introduction","link":"#bucket-list-introduction","children":[]},{"level":3,"title":"Adding conformance to Comparable for custom types","slug":"adding-conformance-to-comparable-for-custom-types","link":"#adding-conformance-to-comparable-for-custom-types","children":[]},{"level":3,"title":"Writing data to the documents directory","slug":"writing-data-to-the-documents-directory","link":"#writing-data-to-the-documents-directory","children":[]},{"level":3,"title":"Switching view states with enums","slug":"switching-view-states-with-enums","link":"#switching-view-states-with-enums","children":[]}]}],"git":{"createdTime":1703729571000,"updatedTime":1727918413000,"contributors":[{"name":"chanhi2000","email":"chanhi2000@gmail.com","commits":7}]},"readingTime":{"minutes":9.68,"words":2903},"filePathRelative":"swift/100-days-of-swiftui/68.md","localizedDate":"2023년 12월 28일","excerpt":"\\n\\n<hr>\\n"}');export{I as comp,D as data};

import{_ as h}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as m,a as n,t as k,b as a,w as p,n as c,g as l,d as s,e as u,r as t,o as v}from"./app-U_bew1in.js";const w={},g={id:"frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´",tabindex:"-1"},f={class:"header-anchor",href:"#frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´"},b={class:"table-of-contents"},y=n("hr",null,null,-1),I=u('<h2 id="project-14-part-2" tabindex="-1"><a class="header-anchor" href="#project-14-part-2"><span>Project 14, part 2</span></a></h2><p>In the second part of our technique overview for this project, we‚Äôre going to look at two really important frameworks on iOS: MapKit for rendering maps in our app, and LocalAuthentication for using Touch ID and Face ID.</p><p>It won‚Äôt surprise you to learn that location, fingerprints, and facial recognition are <em>really</em> personal to users, which means we need to treat them with respect at all times. Remember, users trust us to treat their data with the utmost care and intention at all times, so it‚Äôs a good thing to get into the mindset that privacy, security, and trust are your core values rather than optional extras.</p><p>Elvis Presley is reputed to have once said, ‚Äúvalues are like fingerprints: nobody‚Äôs are the same, but you leave them all over the things you touch.‚Äù Well, this project is at the center of the Venn diagram of both values <em>and</em> fingerprints, so stay sharp ‚Äì this stuff matters.</p><p><strong>Today you have two topics to work through, in which you‚Äôll learn how embed maps into a SwiftUI app, how to use Face ID to unlock your app, and more.</strong></p><h3 id="integrating-mapkit-with-swiftui" tabindex="-1"><a class="header-anchor" href="#integrating-mapkit-with-swiftui"><span>Integrating MapKit with SwiftUI</span></a></h3>',6),_={class:"hint-container details"},x=n("summary",null,"Integrating MapKit with SwiftUI",-1),D=u(`<p>Maps have been a core feature of iPhone since the very first device shipped way back in 2007, and the underlying framework has been available to developers for almost as long. Even better, Apple provides a SwiftUI <code>Map</code> view that wraps up the underlying map framework beautifully, letting us place maps, annotations, and more alongside the rest of our SwiftUI view hierarchy.</p><p>Let‚Äôs start with something simple: just showing a map. Maps and all their configuration data come from a dedicated framework called MapKit, so our first step is to import that framework:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token class-name">MapKit</span> </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>And now we can place a map in our SwiftUI view, with just this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>That&#39;s enough to show a map on the screen, so try running the app and take a moment to learn some key shortcuts in the simulator:</p><ul><li>Hold down the Option key to trigger two-finger pinching. If you click and drag while option is held down, the virtual fingers will move closer or further.</li><li>Hold down Option and Shift to trigger two-finger panning. If you click and drag up and down while this combination is held down, you&#39;ll adjust the tilt of the map.</li><li>You can also mimic the single-finger zoom by tapping once, then tapping and dragging up or down.</li></ul><p>Once you&#39;re in control of the map, there are <em>stacks</em> of options to customize it further.</p><p>For example, you can use the <code>mapStyle()</code> modifier to control how the map looks. You can get a satellite map like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">mapStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>imagery<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Or combine both satellite and street map like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">mapStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>hybrid<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Or you can get both maps along with realistic elevation, creating a 3D map, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token punctuation">.</span><span class="token function">mapStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token function">hybrid</span><span class="token punctuation">(</span>elevation<span class="token punctuation">:</span> <span class="token punctuation">.</span>realistic<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>You can adjust how the user can work with your map, such as whether they can zoom or rotate their position. For example, we could make a map that always remains centered on a particular location, but users can still adjust the rotation and zoom:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Map</span><span class="token punctuation">(</span>interactionModes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">.</span>rotate<span class="token punctuation">,</span> <span class="token punctuation">.</span>zoom<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Or we could specify <em>no</em> interaction modes, meaning that the map is always exactly fixed:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Map</span><span class="token punctuation">(</span>interactionModes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Those are all the easy customization options, but there are three that take a little more thinking: controlling the position, placing annotations, and handling taps.</p><p>First, you can customize the position of the camera. This can be done as an initial position, where you&#39;re setting how the map should start, or as a binding to its current position, which tracks its position over time.</p><p>For example, we could create a constant property storing the location of London, with a span specified as 1 degree by 1 degree:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> position <span class="token operator">=</span> <span class="token class-name">MapCameraPosition</span><span class="token punctuation">.</span><span class="token function">region</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token class-name">MKCoordinateRegion</span><span class="token punctuation">(</span></span>
<span class="line">        center<span class="token punctuation">:</span> <span class="token class-name">CLLocationCoordinate2D</span><span class="token punctuation">(</span>latitude<span class="token punctuation">:</span> <span class="token number">51.507222</span><span class="token punctuation">,</span> longitude<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">0.1275</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">        span<span class="token punctuation">:</span> <span class="token class-name">MKCoordinateSpan</span><span class="token punctuation">(</span>latitudeDelta<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> longitudeDelta<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We could then use that for the initial position of our map:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Map</span><span class="token punctuation">(</span>initialPosition<span class="token punctuation">:</span> position<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>That value is only an <em>initial</em> position. If you want to change the position over time you&#39;ll need to mark it as <code>@State</code> then pass it in as a binding.</p><p>So, first make it use <code>@State</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> position <span class="token operator">=</span> <span class="token class-name">MapCameraPosition</span><span class="token punctuation">.</span><span class="token function">region</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token class-name">MKCoordinateRegion</span><span class="token punctuation">(</span></span>
<span class="line">        center<span class="token punctuation">:</span> <span class="token class-name">CLLocationCoordinate2D</span><span class="token punctuation">(</span>latitude<span class="token punctuation">:</span> <span class="token number">51.507222</span><span class="token punctuation">,</span> longitude<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">0.1275</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">        span<span class="token punctuation">:</span> <span class="token class-name">MKCoordinateSpan</span><span class="token punctuation">(</span>latitudeDelta<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> longitudeDelta<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Then pass it in as a binding:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Map</span><span class="token punctuation">(</span>position<span class="token punctuation">:</span> $position<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Now that&#39;s it&#39;s stored as program state, we can change it by adding some buttons to jump to other locations. For example, we could wrap the map in a <code>VStack</code>, then place this below it:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">HStack</span><span class="token punctuation">(</span>spacing<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Paris&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        position <span class="token operator">=</span> <span class="token class-name">MapCameraPosition</span><span class="token punctuation">.</span><span class="token function">region</span><span class="token punctuation">(</span></span>
<span class="line">            <span class="token class-name">MKCoordinateRegion</span><span class="token punctuation">(</span></span>
<span class="line">                center<span class="token punctuation">:</span> <span class="token class-name">CLLocationCoordinate2D</span><span class="token punctuation">(</span>latitude<span class="token punctuation">:</span> <span class="token number">48.8566</span><span class="token punctuation">,</span> longitude<span class="token punctuation">:</span> <span class="token number">2.3522</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                span<span class="token punctuation">:</span> <span class="token class-name">MKCoordinateSpan</span><span class="token punctuation">(</span>latitudeDelta<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> longitudeDelta<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Tokyo&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        position <span class="token operator">=</span> <span class="token class-name">MapCameraPosition</span><span class="token punctuation">.</span><span class="token function">region</span><span class="token punctuation">(</span></span>
<span class="line">            <span class="token class-name">MKCoordinateRegion</span><span class="token punctuation">(</span></span>
<span class="line">                center<span class="token punctuation">:</span> <span class="token class-name">CLLocationCoordinate2D</span><span class="token punctuation">(</span>latitude<span class="token punctuation">:</span> <span class="token number">35.6897</span><span class="token punctuation">,</span> longitude<span class="token punctuation">:</span> <span class="token number">139.6922</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">                span<span class="token punctuation">:</span> <span class="token class-name">MKCoordinateSpan</span><span class="token punctuation">(</span>latitudeDelta<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> longitudeDelta<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Although we&#39;re now passing a binding to the map, we can&#39;t just read the location as the map moves around. Instead, we have a separate <code>onMapCameraChange()</code> modifier that tells us when the position changes, either immediately or once movement has ended.</p><p>For example, we could write get an update when they have finished dragging the map, then print it out:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Map</span><span class="token punctuation">(</span>position<span class="token punctuation">:</span> $position<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span>onMapCameraChange <span class="token punctuation">{</span> context <span class="token keyword">in</span></span>
<span class="line">        <span class="token function">print</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>region<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Alternatively, you can have it post continuous updates like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Map</span><span class="token punctuation">(</span>position<span class="token punctuation">:</span> $position<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">onMapCameraChange</span><span class="token punctuation">(</span>frequency<span class="token punctuation">:</span> <span class="token punctuation">.</span>continuous<span class="token punctuation">)</span> <span class="token punctuation">{</span> context <span class="token keyword">in</span></span>
<span class="line">        <span class="token function">print</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>region<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You might think continuous mode is always preferable, but it&#39;s not that simple ‚Äì if you&#39;re running a search on where the user has positioned the map, that&#39;s the kind of thing you&#39;d want to do only when they have finished moving.</p><p>The second customizable thing I want to look at is placing annotations.</p><p>To do this takes at least three steps depending on your goal: defining a new data type that contains your location, creating an array of those containing <em>all</em> your locations, then adding them as annotations in the map. Whatever new data type you create to store locations, it <em>must</em> conform to the <code>Identifiable</code> protocol so that SwiftUI can identify each map marker uniquely.</p><p>For example, we might start with this kind of <code>Location</code> struct:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">struct</span> <span class="token class-name">Location</span><span class="token punctuation">:</span> <span class="token class-name">Identifiable</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token function">UUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">var</span> name<span class="token punctuation">:</span> <span class="token class-name">String</span></span>
<span class="line">    <span class="token keyword">var</span> coordinate<span class="token punctuation">:</span> <span class="token class-name">CLLocationCoordinate2D</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now we can go ahead and define an array of locations, wherever we want map annotations to appear:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> locations <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token class-name">Location</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Buckingham Palace&quot;</span></span><span class="token punctuation">,</span> coordinate<span class="token punctuation">:</span> <span class="token class-name">CLLocationCoordinate2D</span><span class="token punctuation">(</span>latitude<span class="token punctuation">:</span> <span class="token number">51.501</span><span class="token punctuation">,</span> longitude<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">0.141</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token class-name">Location</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Tower of London&quot;</span></span><span class="token punctuation">,</span> coordinate<span class="token punctuation">:</span> <span class="token class-name">CLLocationCoordinate2D</span><span class="token punctuation">(</span>latitude<span class="token punctuation">:</span> <span class="token number">51.508</span><span class="token punctuation">,</span> longitude<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">0.076</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Step three is the important part: we can feed that array of locations into the <code>Map</code> view as its content. SwiftUI provides us with a couple of different content types, but a simple one is called <code>Marker</code>: a balloon with a title and latitude/longitude coordinate attached.</p><p>For example, we could place markers at both our locations like so:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Map</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">ForEach</span><span class="token punctuation">(</span>locations<span class="token punctuation">)</span> <span class="token punctuation">{</span> location <span class="token keyword">in</span></span>
<span class="line">        <span class="token class-name">Marker</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>name<span class="token punctuation">,</span> coordinate<span class="token punctuation">:</span> location<span class="token punctuation">.</span>coordinate<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>When that runs you‚Äôll see two red balloons on the map, and even better you&#39;ll see the map adjusts its position and scale so the two markers are visible.</p><p>If you want more control over the way your markers look on the map, use an <code>Annotation</code> instead. This lets you provide a completely custom view to use instead of the standard system marker balloon, and if you prefer you can hide the default title so you can replace it with your own, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Annotation</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>name<span class="token punctuation">,</span> coordinate<span class="token punctuation">:</span> location<span class="token punctuation">.</span>coordinate<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Text</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>name<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>headline<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">background</span><span class="token punctuation">(</span><span class="token punctuation">.</span>blue<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>white<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">clipShape</span><span class="token punctuation">(</span><span class="token punctuation">.</span>capsule<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">.</span><span class="token function">annotationTitles</span><span class="token punctuation">(</span><span class="token punctuation">.</span>hidden<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>And finally, you can handle taps on the map using <code>onTapGesture()</code>. This tells us where on the map the user tapped, but it does so in <em>screen coordinates</em> ‚Äì e.g., 50 points from the top, and 100 points from the left.</p><p>In order to get an actual location on the map, we need a special view called <code>MapReader</code>. When you wrap one of these around your map, you&#39;ll be handed a special <code>MapProxy</code> object that is able to convert screen locations to map locations and back the other way.</p><p>Use it like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">MapReader</span> <span class="token punctuation">{</span> proxy <span class="token keyword">in</span></span>
<span class="line">    <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span>onTapGesture <span class="token punctuation">{</span> position <span class="token keyword">in</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token keyword">let</span> coordinate <span class="token operator">=</span> proxy<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span>position<span class="token punctuation">,</span> from<span class="token punctuation">:</span> <span class="token punctuation">.</span>local<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token function">print</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Tip</strong>: The <code>.local</code> part means we&#39;re converting that position in the map&#39;s local coordinate space, meaning that the tap location we&#39;re working with is relative to the top-left corner of the map rather than the whole screen or some other coordinate space.</p>`,54),S=n("h3",{id:"using-touch-id-and-face-id-with-swiftui",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#using-touch-id-and-face-id-with-swiftui"},[n("span",null,"Using Touch ID and Face ID with SwiftUI")])],-1),j={class:"hint-container details"},M=n("summary",null,"Using Touch ID and Face ID with SwiftUI",-1),T=n("p",null,"The vast majority of Apple‚Äôs devices come with biometric authentication as standard, which means they use fingerprint, facial, and even iris recognition to unlock. This functionality is available to us too, which means we can make sure that sensitive data can only be read when unlocked by a valid user.",-1),C=n("p",null,[s("This is another Objective-C API, but it‚Äôs only a "),n("em",null,"little"),s(" bit unpleasant to use with SwiftUI, which is better than we‚Äôve had with some other frameworks we‚Äôve looked at so far.")],-1),U=n("p",null,"Before we write any code, you need to add a new key to your project options, explaining to the user why you want access to Face ID. For reasons known only to Apple, we pass the Touch ID request reason in code, and the Face ID request reason in project options.",-1),F=n("code",null,"[Privacy - Face ID Usage Description]",-1),L=u(`<p>Now head back to ContentView.swift, and add this import near the top of the file:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token class-name">LocalAuthentication</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>And with that, we‚Äôre all set to write some biometrics code.</p><p>I mentioned earlier this was ‚Äúonly a <em>little</em> bit unpleasant‚Äù, and here‚Äôs where it comes in: Swift developers use the <code>Error</code> protocol for representing errors that occur at runtime, but Objective-C uses a special class called <code>NSError</code>. We need to be able to pass that into the function and have it changed <em>inside</em> the function rather than returning a new value ‚Äì although this was the standard in Objective-C, it‚Äôs quite an alien way of working in Swift so we need to mark this behavior specially by using <code>&amp;</code>.</p><p>We‚Äôre going to write an <code>authenticate()</code> method that isolates all the biometric functionality in a single place. To make that happen requires four steps:</p><ol><li>Create instance of <code>LAContext</code>, which allows us to query biometric status and perform the authentication check.</li><li>Ask that context whether it‚Äôs capable of performing biometric authentication ‚Äì this is important because iPod touch has neither Touch ID nor Face ID.</li><li>If biometrics are possible, then we kick off the actual request for authentication, passing in a closure to run when authentication completes.</li><li>When the user has either been authenticated or not, our completion closure will be called and tell us whether it worked or not, and if not what the error was.</li></ol><p>Please go ahead and add this method to <code>ContentView</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">authenticate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> context <span class="token operator">=</span> <span class="token class-name">LAContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">var</span> error<span class="token punctuation">:</span> <span class="token class-name">NSError</span><span class="token operator">?</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// check whether biometric authentication is possible</span></span>
<span class="line">    <span class="token keyword">if</span> context<span class="token punctuation">.</span><span class="token function">canEvaluatePolicy</span><span class="token punctuation">(</span><span class="token punctuation">.</span>deviceOwnerAuthenticationWithBiometrics<span class="token punctuation">,</span> error<span class="token punctuation">:</span> <span class="token operator">&amp;</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// it&#39;s possible, so go ahead and use it</span></span>
<span class="line">        <span class="token keyword">let</span> reason <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;We need to unlock your data.&quot;</span></span></span>
<span class="line"></span>
<span class="line">        context<span class="token punctuation">.</span><span class="token function">evaluatePolicy</span><span class="token punctuation">(</span><span class="token punctuation">.</span>deviceOwnerAuthenticationWithBiometrics<span class="token punctuation">,</span> localizedReason<span class="token punctuation">:</span> reason<span class="token punctuation">)</span> <span class="token punctuation">{</span> success<span class="token punctuation">,</span> authenticationError <span class="token keyword">in</span></span>
<span class="line">            <span class="token comment">// authentication has now completed</span></span>
<span class="line">            <span class="token keyword">if</span> success <span class="token punctuation">{</span></span>
<span class="line">                <span class="token comment">// authenticated successfully</span></span>
<span class="line">            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token comment">// there was a problem</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// no biometrics</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That method by itself won‚Äôt do anything, because it‚Äôs not connected to SwiftUI at all. To fix that we need to add some state we can adjust when authentication is successful, and also an <code>onAppear()</code> modifier to trigger authentication.</p><p>So, first add this property to <code>ContentView</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> isUnlocked <span class="token operator">=</span> <span class="token boolean">false</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>That simple Boolean will store whether the app is showing its protected data or not, so we‚Äôll flip that to true when authentication succeeds. Replace the <code>// authenticated successfully</code> comment with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line">isUnlocked <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Finally, we can show the current authentication state and begin the authentication process inside the <code>body</code> property, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">VStack</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> isUnlocked <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Unlocked&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Locked&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">.</span><span class="token function">onAppear</span><span class="token punctuation">(</span>perform<span class="token punctuation">:</span> authenticate<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If you run the app there‚Äôs a good chance you just see ‚ÄúLocked‚Äù and nothing else. This is because the simulator isn‚Äôt opted in to biometrics by default, and we didn‚Äôt provide any error messages, so it fails silently.</p>`,16),P=n("code",null,"[Face ID]",-1),q=n("code",null,"[Enrolled]",-1),A=n("code",null,"[Face ID]",-1),K=n("code",null,"[Matching Face]",-1),R=n("code",null,"[Non-matching Face]",-1),O=n("p",null,"All being well you should see the Face ID prompt go away, and underneath it will be the ‚ÄúUnlocked‚Äù text view ‚Äì our app has detected the authentication, and is now open to use.",-1),V=n("p",null,[n("strong",null,"Important"),s(": When working with biometric authentication, you should always look for a backup plan that lets users authenticate without biometrics. This usually means adding a screen that prompts for a passcode then providing that as a fallback if biometrics fail, but this is something you need to build yourself.")],-1),W=n("p",null,"Make sure and tell the world about your progress ‚Äì you‚Äôre making some real steps forward.",-1),z=n("hr",null,null,-1);function B(d,N){const e=t("router-link"),i=t("VPCard"),r=t("VidStack"),o=t("FontIcon");return v(),m("div",null,[n("h1",g,[n("a",f,[n("span",null,k(d.$frontmatter.title)+" Í¥ÄÎ†®",1)])]),n("nav",b,[n("ul",null,[n("li",null,[a(e,{to:"#project-14-part-2"},{default:p(()=>[s("Project 14, part 2")]),_:1}),n("ul",null,[n("li",null,[a(e,{to:"#integrating-mapkit-with-swiftui"},{default:p(()=>[s("Integrating MapKit with SwiftUI")]),_:1})]),n("li",null,[a(e,{to:"#using-touch-id-and-face-id-with-swiftui"},{default:p(()=>[s("Using Touch ID and Face ID with SwiftUI")]),_:1})])])])])]),y,a(i,c(l({title:"100 Days of SwiftUI - Day 69",desc:"Project 14, part 2",link:"https://www.hackingwithswift.com/100/swiftui/69",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),I,n("details",_,[x,a(i,c(l({title:"100 Days of SwiftUI - Day 69 - Integrating MapKit with SwiftUI",desc:"Integrating MapKit with SwiftUI",link:"https://www.hackingwithswift.com/books/ios-swiftui/integrating-mapkit-with-swiftui",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),a(r,{src:"youtube/3COmagWT6lU"}),D]),S,n("details",j,[M,a(i,c(l({title:"100 Days of SwiftUI - Day 69 - Using Touch ID and Face ID with SwiftUI",desc:"Using Touch ID and Face ID with SwiftUI",link:"https://www.hackingwithswift.com/books/ios-swiftui/using-touch-id-and-face-id-with-swiftui",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),a(r,{src:"youtube/0Bcui9hyXhY"}),T,C,U,n("p",null,[s("So, select your current target, go to the Info tab, right-click on an existing key, then choose Add Row. Scroll through the list of keys until you find "),a(o,{icon:"iconfont icon-select"}),F,s(" and give it the value ‚ÄúWe need to unlock your data.‚Äù")]),L,n("p",null,[s("To take Face ID for a test drive in the simulator, go to the Features menu and choose "),a(o,{icon:"iconfont icon-select"}),P,s(" > "),q,s(", then launch the app again. This time you should see the Face ID prompt appear, and you can trigger successful or failed authentication by going back to the Features menu and choosing "),a(o,{icon:"iconfont icon-select"}),A,s(" > "),K,s(" or "),R,s(".")]),O,V]),W,z])}const $=h(w,[["render",B],["__file","69.html.vue"]]),H=JSON.parse('{"path":"/swift/100-days-of-swiftui/69.html","title":"Day 69","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Day 69","description":"100 Days of SwiftUI > Day 69","category":["Swift"],"tag":["crashcourse","paul-hudson","swift","swiftui","hacking-with-swift","xcode","appstore"],"head":[[{"meta":null},{"property":"og:title","content":"100 Days of SwiftUI > Day 69"},{"property":"og:description","content":"Day 69"},{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/swift/100-days-of-swiftui/69.html"}],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/crashcourse/swift/100-days-of-swiftui/69.html"}],["meta",{"property":"og:site_name","content":"ü•ÅCrashcourse"}],["meta",{"property":"og:title","content":"Day 69"}],["meta",{"property":"og:description","content":"100 Days of SwiftUI > Day 69"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"og:updated_time","content":"2024-10-03T01:20:13.000Z"}],["meta",{"property":"article:tag","content":"crashcourse"}],["meta",{"property":"article:tag","content":"paul-hudson"}],["meta",{"property":"article:tag","content":"swift"}],["meta",{"property":"article:tag","content":"swiftui"}],["meta",{"property":"article:tag","content":"hacking-with-swift"}],["meta",{"property":"article:tag","content":"xcode"}],["meta",{"property":"article:tag","content":"appstore"}],["meta",{"property":"article:modified_time","content":"2024-10-03T01:20:13.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Day 69\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-10-03T01:20:13.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"Project 14, part 2","slug":"project-14-part-2","link":"#project-14-part-2","children":[{"level":3,"title":"Integrating MapKit with SwiftUI","slug":"integrating-mapkit-with-swiftui","link":"#integrating-mapkit-with-swiftui","children":[]},{"level":3,"title":"Using Touch ID and Face ID with SwiftUI","slug":"using-touch-id-and-face-id-with-swiftui","link":"#using-touch-id-and-face-id-with-swiftui","children":[]}]}],"git":{"createdTime":1703739559000,"updatedTime":1727918413000,"contributors":[{"name":"chanhi2000","email":"chanhi2000@gmail.com","commits":8}]},"readingTime":{"minutes":8.22,"words":2465},"filePathRelative":"swift/100-days-of-swiftui/69.md","localizedDate":"2023ÎÖÑ 12Ïõî 28Ïùº","excerpt":"\\n\\n<hr>\\n"}');export{$ as comp,H as data};

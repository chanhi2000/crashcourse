import{_ as k}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as h,a as n,t as m,b as s,w as o,n as p,g as c,d as a,e,r as l,o as v}from"./app-U_bew1in.js";const w={},b={id:"frontmatter-title-관련",tabindex:"-1"},g={class:"header-anchor",href:"#frontmatter-title-관련"},f={class:"table-of-contents"},y=n("hr",null,null,-1),_=e('<h2 id="project-17-part-2" tabindex="-1"><a class="header-anchor" href="#project-17-part-2"><span>Project 17, part 2</span></a></h2><p>Cory House once said, “code is like humor. When you have to explain it, it’s bad.” I’ve touched on something similar previously – the need to write clear code that effectively communicates our intent is the mark of good programming, and it will save many hours of maintenance and testing in the future.</p><p>Today you’re going to be learning about monitoring notifications using Apple’s Combine framework, and you’ll see that the code is so simple it barely requires any explanation at all – and that’s despite it letting us do all sorts of monitoring for system events.</p><p>This doesn’t happen by accident: Apple spends a lot of time doing <em>API review</em>, which is when cross-functional teams of developers get together to discuss what we call the <em>surface area</em> of an API – how it looks to us end-user developers in terms of what parameters they take, what they return, how they are named, whether they throw errors, and how they fit together in context. API review is harder than you might think, but the end result is we get great functionality with remarkably little Swift and SwiftUI code, so it’s a big win for us!</p><p><strong>Today you have three topics to work through, in which you’ll learn about the Combine framework, <code>Timer</code>, and reading specific accessibility settings.</strong></p><h3 id="triggering-events-repeatedly-using-a-timer" tabindex="-1"><a class="header-anchor" href="#triggering-events-repeatedly-using-a-timer"><span>Triggering events repeatedly using a timer</span></a></h3>',6),S={class:"hint-container details"},I=n("summary",null,"Triggering events repeatedly using a timer",-1),T=e(`<p>iOS comes with a built-in <code>Timer</code> class that lets us run code on a regular basis. This uses a system of <em>publishers</em> that comes from an Apple framework called Combine – it was launched at the same time as SwiftUI, way back in iOS 13, but has since mostly been superseded by Swift language features such as the <code>await</code> keyword.</p><p>Apple’s core system library is called Foundation, and it gives us things like <code>Data</code>, <code>Date</code>, <code>SortDescriptor</code>, <code>UserDefaults</code>, and much more. It also gives us the <code>Timer</code> class, which is designed to run a function after a certain number of seconds, but it can also run code repeatedly. Combine adds an extension to this so that timers can become <em>publishers</em>, which are things that announce when their value changes.</p><p>The code to create a timer publisher looks like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token class-name">Timer</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span>every<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> on<span class="token punctuation">:</span> <span class="token punctuation">.</span>main<span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token punctuation">.</span>common<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">autoconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>That does several things all at once:</p><ol><li>It asks the timer to fire every 1 second.</li><li>It says the timer should run on the main thread.</li><li>It says the timer should run on the common run loop, which is the one you’ll want to use most of the time. (Run loops let iOS handle running code while the user is actively doing something, such as scrolling in a list.)</li><li>It connects the timer immediately, which means it will start counting time.</li><li>It assigns the whole thing to the <code>timer</code> constant so that it stays alive.</li></ol><p>Once the timer starts it will send change announcements that we can monitor in SwiftUI using a new modifier called <code>onReceive()</code>. This accepts a publisher as its first parameter and a function to run as its second, and it will make sure that function is called whenever the publisher sends its change notification.</p><p>For our timer example, we could receive its notifications like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Hello, World!&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">onReceive</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span> time <span class="token keyword">in</span></span>
<span class="line">        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;The time is now </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">time</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That will print the time every second until the timer is finally stopped.</p><p>Speaking of stopping the timer, it takes a little digging to stop the one we created. You see, the <code>timer</code> property we made is an autoconnected publisher, so we need to go to its <em>upstream publisher</em> to find the timer itself. From there we can connect to the timer publisher, and ask it to cancel itself. Honestly, if it weren’t for code completion this would be rather hard to find, but here’s how it looks in code:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line">timer<span class="token punctuation">.</span>upstream<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>For example, we could update our existing example so that it fires the timer only five times, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token class-name">Timer</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span>every<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> on<span class="token punctuation">:</span> <span class="token punctuation">.</span>main<span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token punctuation">.</span>common<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">autoconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Hello, World!&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">onReceive</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span> time <span class="token keyword">in</span></span>
<span class="line">                <span class="token keyword">if</span> counter <span class="token operator">==</span> <span class="token number">5</span> <span class="token punctuation">{</span></span>
<span class="line">                    timer<span class="token punctuation">.</span>upstream<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;The time is now </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">time</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">                counter <span class="token operator">+=</span> <span class="token number">1</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Before we’re done, there’s one more important timer concept I want to show you: if you’re okay with your timer having a little float, you can specify some <em>tolerance</em>. This allows iOS to perform important energy optimization, because it can fire the timer at any point between its scheduled fire time and its scheduled fire time plus the tolerance you specify.</p><p>In practice this means the system can perform <em>timer coalescing</em>: it can push back your timer just a little so that it fires at the same time as one or more other timers, which means it can keep the CPU idling more and save battery power.</p><p>As an example, this adds half a second of tolerance to our timer:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token class-name">Timer</span><span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span>every<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> tolerance<span class="token punctuation">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span> on<span class="token punctuation">:</span> <span class="token punctuation">.</span>main<span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token punctuation">.</span>common<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">autoconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>If you need to keep time strictly then leaving off the <code>tolerance</code> parameter will make your timer as accurate as possible, but please note that even without any tolerance the <code>Timer</code> class is still “best effort” – the system makes no guarantee it will execute precisely.</p>`,19),x=n("h3",{id:"how-to-be-notified-when-your-swiftui-app-moves-to-the-background",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#how-to-be-notified-when-your-swiftui-app-moves-to-the-background"},[n("span",null,"How to be notified when your SwiftUI app moves to the background")])],-1),U={class:"hint-container details"},D=n("summary",null,"How to be notified when your SwiftUI app moves to the background",-1),A=e(`<p>SwiftUI can detect when your app moves to the background (i.e., when the user returns to the home screen), and when it comes back to the foreground, and if you put those two together it allows us to make sure our app pauses and resumes work depending on whether the user can see it right now or not.</p><p>This is done using three steps:</p><ol start="3"><li>Adding a new property to watch an environment value called <code>scenePhase</code>.</li><li>Using <code>onChange()</code> to watch for the scene phase changing.</li><li>Responding to the new scene phase somehow.</li></ol><p>You might wonder why it’s called <em>scene phase</em> as opposed to something to do with your current app state, but remember that on iPad the user can run multiple instances of your app at the same time – they can have multiple windows, known as <em>scenes</em>, each in a different state.</p><p>To see the various scene phases in action, try this code:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token attribute atrule">@Environment</span><span class="token punctuation">(</span><span class="token punctuation">\\</span><span class="token punctuation">.</span>scenePhase<span class="token punctuation">)</span> <span class="token keyword">var</span> scenePhase</span>
<span class="line"></span>
<span class="line">    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Hello, world!&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span>of<span class="token punctuation">:</span> scenePhase<span class="token punctuation">)</span> <span class="token punctuation">{</span> oldPhase<span class="token punctuation">,</span> newPhase <span class="token keyword">in</span></span>
<span class="line">                <span class="token keyword">if</span> newPhase <span class="token operator">==</span> <span class="token punctuation">.</span>active <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Active&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> newPhase <span class="token operator">==</span> <span class="token punctuation">.</span>inactive <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Inactive&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> newPhase <span class="token operator">==</span> <span class="token punctuation">.</span>background <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Background&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>When you run that back, try going to the home screen in your simulator, locking the virtual device, and other common activities to see how the scene phase changes.</p><p>As you can see, there are three scene phases we need to care about:</p><ul><li>Active scenes are running right now, which on iOS means they are visible to the user. On macOS an app’s window might be wholly hidden by another app’s window, but that’s okay – it’s still considered to be active.</li><li>Inactive scenes are running and might be visible to the user, but the user isn’t able to access them. For example, if you’re swiping down to partially reveal the control center then the app underneath is considered inactive.</li><li>Background scenes are not visible to the user, which on iOS means they might be terminated at some point in the future.</li></ul>`,9),q=n("h3",{id:"supporting-specific-accessibility-needs-with-swiftui",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#supporting-specific-accessibility-needs-with-swiftui"},[n("span",null,"Supporting specific accessibility needs with SwiftUI")])],-1),V={class:"hint-container details"},j=n("summary",null,"Supporting specific accessibility needs with SwiftUI",-1),C=e(`<p>SwiftUI gives us a number of environment properties that describe the user’s custom accessibility settings, and it’s worth taking the time to read and respect those settings.</p><p>Back in project 15 we looked at accessibility labels and hints, traits, groups, and more, but these settings are different because they are provided through the environment. This means SwiftUI automatically monitors them for changes and will reinvoke our <code>body</code> property whenever one of them changes.</p><p>For example, one of the accessibility options is “Differentiate without color”, which is helpful for the 1 in 12 men who have color blindness. When this setting is enabled, apps should try to make their UI clearer using shapes, icons, and textures rather than colors.</p><p>To use this, just add an environment property like this one:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@Environment</span><span class="token punctuation">(</span><span class="token punctuation">\\</span><span class="token punctuation">.</span>accessibilityDifferentiateWithoutColor<span class="token punctuation">)</span> <span class="token keyword">var</span> differentiateWithoutColor</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>That will be either true or false, and you can adapt your UI accordingly. For example, in the code below we use a simple green background for the regular layout, but when Differentiate Without Color is enabled we use a black background and add a checkmark instead:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token attribute atrule">@Environment</span><span class="token punctuation">(</span><span class="token punctuation">\\</span><span class="token punctuation">.</span>accessibilityDifferentiateWithoutColor<span class="token punctuation">)</span> <span class="token keyword">var</span> differentiateWithoutColor</span>
<span class="line"></span>
<span class="line">    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">HStack</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">if</span> differentiateWithoutColor <span class="token punctuation">{</span></span>
<span class="line">                <span class="token class-name">Image</span><span class="token punctuation">(</span>systemName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;checkmark.circle&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">            <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Success&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">background</span><span class="token punctuation">(</span>differentiateWithoutColor <span class="token operator">?</span> <span class="token punctuation">.</span>black <span class="token punctuation">:</span> <span class="token punctuation">.</span>green<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>white<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">clipShape</span><span class="token punctuation">(</span><span class="token punctuation">.</span>capsule<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,7),P=n("code",null,"[Accessibility]",-1),R=n("code",null,"[Display & Text Size]",-1),W=n("code",null,"[Differentiate Without Color]",-1),H=n("code",null,"[Accessibility]",-1),O=n("code",null,"[Motion]",-1),F=n("code",null,"[Reduce Motion]",-1),M=e(`<p>With SwiftUI, this means we should restrict the use of <code>withAnimation()</code> when it involves movement, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token attribute atrule">@Environment</span><span class="token punctuation">(</span><span class="token punctuation">\\</span><span class="token punctuation">.</span>accessibilityReduceMotion<span class="token punctuation">)</span> <span class="token keyword">var</span> reduceMotion</span>
<span class="line">    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> scale <span class="token operator">=</span> <span class="token number">1.0</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Hello, World!&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">if</span> reduceMotion <span class="token punctuation">{</span></span>
<span class="line">                scale <span class="token operator">*=</span> <span class="token number">1.5</span></span>
<span class="line">            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">                withAnimation <span class="token punctuation">{</span></span>
<span class="line">                    scale <span class="token operator">*=</span> <span class="token number">1.5</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">scaleEffect</span><span class="token punctuation">(</span>scale<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>I don’t know about you, but I find that rather annoying to use. Fortunately we can add a little wrapper function around <code>withAnimation()</code> that uses UIKit’s <code>UIAccessibility</code> data directly, allowing us to bypass animation automatically:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">withOptionalAnimation</span><span class="token operator">&lt;</span><span class="token class-name">Result</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token omit keyword">_</span> animation<span class="token punctuation">:</span> <span class="token class-name">Animation</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token keyword">default</span><span class="token punctuation">,</span> <span class="token omit keyword">_</span> body<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token operator">-&gt;</span> <span class="token class-name">Result</span><span class="token punctuation">)</span> <span class="token keyword">rethrows</span> <span class="token operator">-&gt;</span> <span class="token class-name">Result</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token class-name">UIAccessibility</span><span class="token punctuation">.</span>isReduceMotionEnabled <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token keyword">try</span> <span class="token function">body</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token keyword">try</span> <span class="token function">withAnimation</span><span class="token punctuation">(</span>animation<span class="token punctuation">,</span> body<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>So, when Reduce Motion Enabled is true the closure code that’s passed in is executed immediately, otherwise it’s passed along using <code>withAnimation()</code>. The whole <code>throws</code>/<code>rethrows</code> thing is more advanced Swift, but it’s a direct copy of the function signature for <code>withAnimation()</code> so that the two can be used interchangeably.</p><p>Use it like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> scale <span class="token operator">=</span> <span class="token number">1.0</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Hello, World!&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            withOptionalAnimation <span class="token punctuation">{</span></span>
<span class="line">                scale <span class="token operator">*=</span> <span class="token number">1.5</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">scaleEffect</span><span class="token punctuation">(</span>scale<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Using this approach you don’t need to repeat your animation code every time.</p><p>One last option you should consider supporting is Reduce Transparency, and when that’s enabled apps should reduce the amount of blur and translucency used in their designs to make doubly sure everything is clear.</p><p>For example, this code uses a solid black background when Reduce Transparency is enabled, otherwise using 50% transparency:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">struct</span> <span class="token class-name">ContentView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token attribute atrule">@Environment</span><span class="token punctuation">(</span><span class="token punctuation">\\</span><span class="token punctuation">.</span>accessibilityReduceTransparency<span class="token punctuation">)</span> <span class="token keyword">var</span> reduceTransparency</span>
<span class="line"></span>
<span class="line">    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Hello, World!&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">background</span><span class="token punctuation">(</span>reduceTransparency <span class="token operator">?</span> <span class="token punctuation">.</span>black <span class="token punctuation">:</span> <span class="token punctuation">.</span>black<span class="token punctuation">.</span><span class="token function">opacity</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>white<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">clipShape</span><span class="token punctuation">(</span><span class="token punctuation">.</span>capsule<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That’s the final technique I want you to learn ahead of building the real project, so please reset your project back to its original state so we have a clean slate to start on.</p>`,12),E=n("hr",null,null,-1);function B(d,N){const t=l("router-link"),i=l("VPCard"),u=l("VidStack"),r=l("FontIcon");return v(),h("div",null,[n("h1",b,[n("a",g,[n("span",null,m(d.$frontmatter.title)+" 관련",1)])]),n("nav",f,[n("ul",null,[n("li",null,[s(t,{to:"#project-17-part-2"},{default:o(()=>[a("Project 17, part 2")]),_:1}),n("ul",null,[n("li",null,[s(t,{to:"#triggering-events-repeatedly-using-a-timer"},{default:o(()=>[a("Triggering events repeatedly using a timer")]),_:1})]),n("li",null,[s(t,{to:"#how-to-be-notified-when-your-swiftui-app-moves-to-the-background"},{default:o(()=>[a("How to be notified when your SwiftUI app moves to the background")]),_:1})]),n("li",null,[s(t,{to:"#supporting-specific-accessibility-needs-with-swiftui"},{default:o(()=>[a("Supporting specific accessibility needs with SwiftUI")]),_:1})])])])])]),y,s(i,p(c({title:"100 Days of SwiftUI - Day 87",desc:"Project 17, part 2",link:"https://www.hackingwithswift.com/100/swiftui/87",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),_,n("details",S,[I,s(i,p(c({title:"100 Days of SwiftUI - Day 86 - Triggering events repeatedly using a timer",desc:"Triggering events repeatedly using a timer",link:"https://hackingwithswift.com/books/ios-swiftui/triggering-events-repeatedly-using-a-timer",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),s(u,{src:"youtube/MkfaywHkXJo"}),T]),x,n("details",U,[D,s(i,p(c({title:"100 Days of SwiftUI - Day 86 - How to be notified when your SwiftUI app moves to the background",desc:"How to be notified when your SwiftUI app moves to the background",link:"https://hackingwithswift.com/books/ios-swiftui/how-to-be-notified-when-your-swiftui-app-moves-to-the-background",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),s(u,{src:"youtube/YRdAMtVA1aY"}),A]),q,n("details",V,[j,s(i,p(c({title:"100 Days of SwiftUI - Day 86 - Supporting specific accessibility needs with SwiftUI",desc:"Supporting specific accessibility needs with SwiftUI",link:"https://hackingwithswift.com/books/ios-swiftui/supporting-specific-accessibility-needs-with-swiftui",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),s(u,{src:"youtube/Vlp9ezQTcAQ"}),C,n("p",null,[a("You can test that in the simulator by going to the Settings app and choosing "),s(r,{icon:"iconfont icon-select"}),P,a(" > "),R,a(" > "),W,a(".")]),n("p",null,[a("Another common option is Reduce Motion, which again is available in the simulator under "),s(r,{icon:"iconfont icon-select"}),H,a(" > "),O,a(" > "),F,a(". When this is enabled, apps should limit the amount of animation that causes movement on screen. For example, the iOS app switcher makes views fade in and out rather than scale up and down.")]),M]),E])}const K=k(w,[["render",B],["__file","87.html.vue"]]),Z=JSON.parse('{"path":"/swift/100-days-of-swiftui/87.html","title":"Day 87","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Day 87","description":"100 Days of SwiftUI > Day 87","category":["Swift"],"tag":["crashcourse","paul-hudson","swift","swiftui","hacking-with-swift","xcode","appstore"],"head":[[{"meta":null},{"property":"og:title","content":"100 Days of SwiftUI > Day 87"},{"property":"og:description","content":"Day 87"},{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/swift/100-days-of-swiftui/87.html"}],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/crashcourse/swift/100-days-of-swiftui/87.html"}],["meta",{"property":"og:site_name","content":"🥁Crashcourse"}],["meta",{"property":"og:title","content":"Day 87"}],["meta",{"property":"og:description","content":"100 Days of SwiftUI > Day 87"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"og:updated_time","content":"2024-10-03T01:20:13.000Z"}],["meta",{"property":"article:tag","content":"crashcourse"}],["meta",{"property":"article:tag","content":"paul-hudson"}],["meta",{"property":"article:tag","content":"swift"}],["meta",{"property":"article:tag","content":"swiftui"}],["meta",{"property":"article:tag","content":"hacking-with-swift"}],["meta",{"property":"article:tag","content":"xcode"}],["meta",{"property":"article:tag","content":"appstore"}],["meta",{"property":"article:modified_time","content":"2024-10-03T01:20:13.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Day 87\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-10-03T01:20:13.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"Project 17, part 2","slug":"project-17-part-2","link":"#project-17-part-2","children":[{"level":3,"title":"Triggering events repeatedly using a timer","slug":"triggering-events-repeatedly-using-a-timer","link":"#triggering-events-repeatedly-using-a-timer","children":[]},{"level":3,"title":"How to be notified when your SwiftUI app moves to the background","slug":"how-to-be-notified-when-your-swiftui-app-moves-to-the-background","link":"#how-to-be-notified-when-your-swiftui-app-moves-to-the-background","children":[]},{"level":3,"title":"Supporting specific accessibility needs with SwiftUI","slug":"supporting-specific-accessibility-needs-with-swiftui","link":"#supporting-specific-accessibility-needs-with-swiftui","children":[]}]}],"git":{"createdTime":1709471553000,"updatedTime":1727918413000,"contributors":[{"name":"chanhi2000","email":"chanhi2000@gmail.com","commits":7}]},"readingTime":{"minutes":7.13,"words":2138},"filePathRelative":"swift/100-days-of-swiftui/87.md","localizedDate":"2024년 3월 3일","excerpt":"\\n\\n<hr>\\n"}');export{K as comp,Z as data};

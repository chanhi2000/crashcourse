import{_ as c}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as d,a as e,t as u,b as a,w as o,n as m,g as h,d as s,e as r,r as l,o as b}from"./app-U_bew1in.js";const f={},g={id:"frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´",tabindex:"-1"},y={class:"header-anchor",href:"#frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´"},k={class:"table-of-contents"},v=e("hr",null,null,-1),_=r('<hr><p>Ever since AWS released official Ruby support for AWS Lambda on <a href="https://twitter.com/tongueroo/status/1068199997097750528" target="_blank" rel="noopener noreferrer">Nov 29 at re:Invent</a>, I‚Äôve been super excited about switching Jets over to the official AWS version of Ruby. Happy to say that <a href="http://rubyonjets.com/" target="_blank" rel="noopener noreferrer">Jets</a> is now on the official AWS Ruby runtime. Knew it was going to be interesting to learn about <a href="https://docs.aws.amazon.com/lambda/latest/dg/runtimes-custom.html" target="_blank" rel="noopener noreferrer">AWS Lambda Custom Runtimes</a> and <a href="https://docs.aws.amazon.com/lambda/latest/dg/configuration-layers.html" target="_blank" rel="noopener noreferrer">Lambda Layers</a> as part of this Jets update.</p><hr><h2 id="lambda-custom-runtimes-are-fast" tabindex="-1"><a class="header-anchor" href="#lambda-custom-runtimes-are-fast"><span>Lambda Custom Runtimes Are Fast</span></a></h2><p>The official Lambda Ruby runtime is built on top of <a href="https://docs.aws.amazon.com/lambda/latest/dg/runtimes-custom.html" target="_blank" rel="noopener noreferrer">AWS Lambda Custom Runtimes</a> technology. Custom Runtimes allow us to add support of any language. Since Ruby is now officially supported, we do not have to create our own runtime. Though there are use-cases for this. For example, different Ruby versions.</p><p>It was fun to study and compare how Custom Runtimes work vs a traditional shim. If you have ever built your own shim yourself to support other languages, they way AWS implemented Custom Runtimes would make complete sense.</p><p>Essentially, a Custom Runtime is a custom server. The server proxies request from one language to another. This ensures that the runtime is kept in memory and fast. This is similar to how Jets achieved Native performance for Ruby before official support.</p><p>The beautiful thing about official Custom Runtimes is that the runtime gets prepackaged as part of the Lambda function creation process. Very cool!</p><hr><h2 id="lambda-custom-runtime-fix" tabindex="-1"><a class="header-anchor" href="#lambda-custom-runtime-fix"><span>Lambda Custom Runtime Fix</span></a></h2><p>There‚Äôs an additional benefit of AWS implementing Ruby support as a Custom Runtime. When updating Jets, I ran into an issue with the actual AWS Ruby Runtime itself. The <a href="https://aws.amazon.com/sdk-for-ruby/" target="_blank" rel="noopener noreferrer">Ruby <code>aws-sdk</code></a> has it‚Äôs own version of <code>.to_json</code> that collides with the ActiveSupport version. The issue only seems to trigger on some aws-sdk calls like <code>sns.publish</code>. The cool thing about Ruby being implemented as Custom Runtime is that we can patch a fix for it now. We do not have to wait until AWS officially fixes it. Here‚Äôs the fix for the <code>.to_json</code> collision in Jets: <a href="https://github.com/tongueroo/jets/blob/master/lib/jets/overrides/lambda/marshaller.rb" target="_blank" rel="noopener noreferrer">lambda/marshaller.rb.</a></p><hr><h2 id="lambda-layers-gem-layers" tabindex="-1"><a class="header-anchor" href="#lambda-layers-gem-layers"><span>Lambda Layers: Gem Layers</span></a></h2><p>AWS introduced Lambda Layers at the same time as Ruby Support. With <a href="https://docs.aws.amazon.com/lambda/latest/dg/configuration-layers.html" target="_blank" rel="noopener noreferrer">Lambda Layers</a>, you can add additional files to the Lambda server in the form of layers. These layers are combined together like a pancake and flattened out. From the Lambda Layers docs, AWS suggests:</p><blockquote><p>With layers, you can use libraries in your function without needing to include them in your deployment package.</p></blockquote><p>This helps you to keep the code package size under the key <a href="https://docs.aws.amazon.com/general/latest/gr/aws_service_limits.html" target="_blank" rel="noopener noreferrer">3MB limit</a>, thereby allowing you to use the live Lambda console code editor.</p><blockquote><p>You can develop your function code in the Lambda console as long as you keep your deployment package under 3 MB.</p></blockquote><p>Having the ability to change your code and debug live significantly increases your <a href="http://rubyonjets.com/docs/faster-development/" target="_blank" rel="noopener noreferrer">development speed and happiness</a>. Previously, Jets accomplished this by separately packaging the dependencies and lazying loading them as part of the shim. In this Jets upgrade, that logic has all be converted to a Lambda Layer and named the <a href="http://rubyonjets.com/docs/gem-layer/" target="_blank" rel="noopener noreferrer">Gem Layer</a>. Once again, awesome.</p><hr><h2 id="screenshot" tabindex="-1"><a class="header-anchor" href="#screenshot"><span>Screenshot</span></a></h2><p>Hopefully, you found the background info above interesting.</p><figure><img src="https://blog.boltops.com/img/posts/2018/12/lambda-console-official-ruby.png" alt="Now here‚Äôs a Jets application running on official Ruby support." tabindex="0" loading="lazy"><figcaption>Now here‚Äôs a Jets application running on official Ruby support.</figcaption></figure><hr><h2 id="jets-code" tabindex="-1"><a class="header-anchor" href="#jets-code"><span>Jets Code</span></a></h2><p>For those who might not seen Jets code before, here are some examples. Here‚Äôs a <a href="http://rubyonjets.com/docs/functions/" target="_blank" rel="noopener noreferrer">simple function</a>:</p>',25),w=e("code",null,"app/functions/",-1),j=e("code",null,"simple.rb",-1),R=r(`<div class="language-ruby line-numbers-mode" data-highlighter="prismjs" data-ext="rb" data-title="rb"><pre><code><span class="line"><span class="token keyword">def</span> <span class="token method-definition"><span class="token function">lambda_handler</span></span><span class="token punctuation">(</span><span class="token symbol">event</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token symbol">context</span><span class="token operator">:</span><span class="token punctuation">)</span></span>
<span class="line">  pp event</span>
<span class="line">  puts <span class="token string-literal"><span class="token string">&quot;hello world&quot;</span></span></span>
<span class="line">  <span class="token punctuation">{</span><span class="token symbol">foo</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">&quot;bar&quot;</span></span><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Here‚Äôs a <a href="http://rubyonjets.com/docs/controllers/" target="_blank" rel="noopener noreferrer">Jets Controller</a>:</p>`,2),S=e("code",null,"app/controllers/",-1),L=e("code",null,"posts_controller.rb",-1),J=r(`<div class="language-ruby line-numbers-mode" data-highlighter="prismjs" data-ext="rb" data-title="rb"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">PostsController</span> <span class="token operator">&lt;</span> ApplicationController</span>
<span class="line">  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">index</span></span></span>
<span class="line">    <span class="token comment"># renders Lambda Proxy structure compatiable with API Gateway</span></span>
<span class="line">    render json<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token symbol">hello</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">&quot;world&quot;</span></span><span class="token punctuation">,</span> <span class="token symbol">action</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">&quot;index&quot;</span></span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">show</span></span></span>
<span class="line">    id <span class="token operator">=</span> params<span class="token punctuation">[</span><span class="token symbol">:id</span><span class="token punctuation">]</span> <span class="token comment"># params available</span></span>
<span class="line">    <span class="token comment"># puts goes to the lambda logs</span></span>
<span class="line">    puts event <span class="token comment"># raw lambda event available</span></span>
<span class="line">    render json<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token symbol">action</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">&quot;show&quot;</span></span><span class="token punctuation">,</span> <span class="token symbol">id</span><span class="token operator">:</span> id<span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Here‚Äôs a <a href="http://rubyonjets.com/docs/jobs/" target="_blank" rel="noopener noreferrer">Jets Job</a>.</p>`,2),x=e("code",null,"app/jobs/",-1),A=e("code",null,"hard_job.rb",-1),C=r(`<div class="language-ruby line-numbers-mode" data-highlighter="prismjs" data-ext="rb" data-title="rb"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">HardJob</span> <span class="token operator">&lt;</span> ApplicationJob</span>
<span class="line">  class_timeout <span class="token number">300</span> <span class="token comment"># 300s or 5m, current Lambda max is 15m</span></span>
<span class="line"></span>
<span class="line">  rate <span class="token string-literal"><span class="token string">&quot;10 hours&quot;</span></span> <span class="token comment"># every 10 hours</span></span>
<span class="line">  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">dig</span></span></span>
<span class="line">    puts <span class="token string-literal"><span class="token string">&quot;done digging&quot;</span></span></span>
<span class="line">  <span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">  cron <span class="token string-literal"><span class="token string">&quot;0 */12 * * ? *&quot;</span></span> <span class="token comment"># every 12 hours</span></span>
<span class="line">  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">lift</span></span></span>
<span class="line">    puts <span class="token string-literal"><span class="token string">&quot;done lifting&quot;</span></span></span>
<span class="line">  <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>More info on the official <a href="http://rubyonjets.com/" target="_blank" rel="noopener noreferrer">rubyonjets.com docs</a>.</p><hr><h2 id="how-to-upgrade" tabindex="-1"><a class="header-anchor" href="#how-to-upgrade"><span>How to upgrade</span></a></h2><p>The upgrade path is transparent. Since Jets <a href="http://rubyonjets.com/docs/controllers/" target="_blank" rel="noopener noreferrer">Controllers</a> and <a href="http://rubyonjets.com/docs/jobs/" target="_blank" rel="noopener noreferrer">Jobs</a> interfaces did not change, there‚Äôs not a lot to it:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token builtin class-name">cd</span> project <span class="token comment"># your jets project</span></span>
<span class="line">bundle update</span>
<span class="line">jets upgrade <span class="token comment"># optional</span></span>
<span class="line">jets deploy</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The <a href="http://rubyonjets.com/reference/jets-upgrade/" target="_blank" rel="noopener noreferrer"><code>jets upgrade</code></a> command is actually optional and simply gets rid of a deprecation warning for a config removal in the latest version.</p>`,7),q=e("a",{href:"http://rubyonjets.com/",target:"_blank",rel:"noopener noreferrer"},"Jets",-1),W={href:"https://github.com/tongueroo/jets",target:"_blank",rel:"noopener noreferrer"},T=e("code",null,"tongueroo/jets",-1),F=r('<hr><h2 id="live-demos" tabindex="-1"><a class="header-anchor" href="#live-demos"><span>Live demos</span></a></h2><p>Here are some additional Live Demos of Jets applications:</p><ul><li><a href="https://api.demo.rubyonjets.com/" target="_blank" rel="noopener noreferrer">A Simple API with Jets</a>: A Simple API. Here‚Äôs a the blog post: <a href="https://blog.boltops.com/2019/01/13/build-an-api-service-with-jets-ruby-serverless-framework/" target="_blank" rel="noopener noreferrer">Build an API with the Jets Ruby Serverless Framework</a></li><li><a href="https://afterburner.demo.rubyonjets.com/" target="_blank" rel="noopener noreferrer">Jets Afterburner: Rails Support</a>: Please read over the considerations in the docs.</li><li><a href="https://mega.demo.rubyonjets.com/" target="_blank" rel="noopener noreferrer">Mega Mode: Jets and Rails Combined</a>: A interesting hybrid mode.</li><li><a href="https://upload.demo.rubyonjets.com/" target="_blank" rel="noopener noreferrer">Image Upload with CarrierWave</a>: Binary Support</li></ul>',4),H={href:"https://github.com/tongueroo/jets-examples",target:"_blank",rel:"noopener noreferrer"},I=e("code",null,"tongueroo/jets-examples",-1),P=e("hr",null,null,-1),O=e("h2",{id:"binary-gems",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#binary-gems"},[e("span",null,"Binary Gems")])],-1),z=e("p",null,[s("Ruby serverless applications might also use native binary gems. Jets uses "),e("a",{href:"https://www.lambdagems.com/",target:"_blank",rel:"noopener noreferrer"},"Lambda Gems"),s(" to make for a seamless and much easier deploy process. "),e("a",{href:""},"Lambda Gems"),s(" is currently in beta, and early signups will receive a special offer for their support.")],-1),B=e("hr",null,null,-1);function G(i,N){const n=l("router-link"),p=l("VPCard"),t=l("FontIcon");return b(),d("div",null,[e("h1",g,[e("a",y,[e("span",null,u(i.$frontmatter.title)+" Í¥ÄÎ†®",1)])]),e("nav",k,[e("ul",null,[e("li",null,[a(n,{to:"#lambda-custom-runtimes-are-fast"},{default:o(()=>[s("Lambda Custom Runtimes Are Fast")]),_:1})]),e("li",null,[a(n,{to:"#lambda-custom-runtime-fix"},{default:o(()=>[s("Lambda Custom Runtime Fix")]),_:1})]),e("li",null,[a(n,{to:"#lambda-layers-gem-layers"},{default:o(()=>[s("Lambda Layers: Gem Layers")]),_:1})]),e("li",null,[a(n,{to:"#screenshot"},{default:o(()=>[s("Screenshot")]),_:1})]),e("li",null,[a(n,{to:"#jets-code"},{default:o(()=>[s("Jets Code")]),_:1})]),e("li",null,[a(n,{to:"#how-to-upgrade"},{default:o(()=>[s("How to upgrade")]),_:1})]),e("li",null,[a(n,{to:"#live-demos"},{default:o(()=>[s("Live demos")]),_:1})]),e("li",null,[a(n,{to:"#binary-gems"},{default:o(()=>[s("Binary Gems")]),_:1})])])]),v,a(p,m(h({title:"Official AWS Ruby Support for Jets",desc:"...",link:"https://blog.boltops.com/2018/12/12/official-aws-ruby-support-for-jets-serverless-framework",logo:"https://res.cloudinary.com/boltops/image/fetch/c_limit,f_auto,q_auto,w_604/https://blog.boltops.com/img/posts/2018/12/official-ruby-support-v1.png",background:"rgba(34,18,53,0.2)"})),null,16),_,e("blockquote",null,[a(t,{icon:"fas fa-folder-open"}),w,a(t,{icon:"iconfont icon-advanced"}),j,s(":")]),R,e("blockquote",null,[a(t,{icon:"fas fa-folder-open"}),S,a(t,{icon:"iconfont icon-advanced"}),L,s(":")]),J,e("blockquote",null,[a(t,{icon:"fas fa-folder-open"}),x,a(t,{icon:"iconfont icon-advanced"}),A,s(":")]),C,e("p",null,[s("That‚Äôs it! Jets is now on official AWS Ruby Support. Hope you like this article and give "),q,s(" a try. Also if you find Jets interesting, please give it ‚≠êÔ∏è it on "),e("a",W,[a(t,{icon:"iconfont icon-github"}),T]),s(". I‚Äôd appreciate it. üëç")]),F,e("p",null,[s("More examples are in the "),e("a",H,[a(t,{icon:"iconfont icon-github"}),I]),s(" repo.")]),P,O,z,B])}const K=c(f,[["render",G],["__file","20181212-official-aws-ruby-support-for-jets-serverless-framework.html.vue"]]),D=JSON.parse('{"path":"/ruby/rubyonjets-learning-content/20181212-official-aws-ruby-support-for-jets-serverless-framework.html","title":"Official AWS Ruby Support for Jets","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Official AWS Ruby Support for Jets","description":"Jets - Learning Content > Official AWS Ruby Support for Jets","category":["Ruby"],"tag":["crashcourse","ruby","jets","aws","aws-lambda","cloudwatch"],"head":[[{"meta":null},{"property":"og:title","content":"Jets - Learning Content > Official AWS Ruby Support for Jets"},{"property":"og:description","content":"Official AWS Ruby Support for Jets"},{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/ruby/rubyonjets-learning-content/20181212-official-aws-ruby-support-for-jets-serverless-framework.html"}],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/crashcourse/ruby/rubyonjets-learning-content/20181212-official-aws-ruby-support-for-jets-serverless-framework.html"}],["meta",{"property":"og:site_name","content":"ü•ÅCrashcourse"}],["meta",{"property":"og:title","content":"Official AWS Ruby Support for Jets"}],["meta",{"property":"og:description","content":"Jets - Learning Content > Official AWS Ruby Support for Jets"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://blog.boltops.com/img/posts/2018/12/lambda-console-official-ruby.png"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"og:updated_time","content":"2024-10-03T01:20:13.000Z"}],["meta",{"property":"article:tag","content":"crashcourse"}],["meta",{"property":"article:tag","content":"ruby"}],["meta",{"property":"article:tag","content":"jets"}],["meta",{"property":"article:tag","content":"aws"}],["meta",{"property":"article:tag","content":"aws-lambda"}],["meta",{"property":"article:tag","content":"cloudwatch"}],["meta",{"property":"article:modified_time","content":"2024-10-03T01:20:13.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Official AWS Ruby Support for Jets\\",\\"image\\":[\\"https://blog.boltops.com/img/posts/2018/12/lambda-console-official-ruby.png\\"],\\"dateModified\\":\\"2024-10-03T01:20:13.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"Lambda Custom Runtimes Are Fast","slug":"lambda-custom-runtimes-are-fast","link":"#lambda-custom-runtimes-are-fast","children":[]},{"level":2,"title":"Lambda Custom Runtime Fix","slug":"lambda-custom-runtime-fix","link":"#lambda-custom-runtime-fix","children":[]},{"level":2,"title":"Lambda Layers: Gem Layers","slug":"lambda-layers-gem-layers","link":"#lambda-layers-gem-layers","children":[]},{"level":2,"title":"Screenshot","slug":"screenshot","link":"#screenshot","children":[]},{"level":2,"title":"Jets Code","slug":"jets-code","link":"#jets-code","children":[]},{"level":2,"title":"How to upgrade","slug":"how-to-upgrade","link":"#how-to-upgrade","children":[]},{"level":2,"title":"Live demos","slug":"live-demos","link":"#live-demos","children":[]},{"level":2,"title":"Binary Gems","slug":"binary-gems","link":"#binary-gems","children":[]}],"git":{"createdTime":1703642364000,"updatedTime":1727918413000,"contributors":[{"name":"chanhi2000","email":"chanhi2000@gmail.com","commits":8}]},"readingTime":{"minutes":3.73,"words":1120},"filePathRelative":"ruby/rubyonjets-learning-content/20181212-official-aws-ruby-support-for-jets-serverless-framework.md","localizedDate":"2023ÎÖÑ 12Ïõî 27Ïùº","excerpt":"\\n\\n<hr>\\n"}');export{K as comp,D as data};

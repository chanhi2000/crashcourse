import{_ as k}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as m,a as n,t as h,b as a,w as p,n as l,g as c,d as s,e,r,o as v}from"./app-U_bew1in.js";const g={},w={id:"frontmatter-title-관련",tabindex:"-1"},b={class:"header-anchor",href:"#frontmatter-title-관련"},f={class:"table-of-contents"},y=n("hr",null,null,-1),x=n("h2",{id:"project-11-part-2",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#project-11-part-2"},[n("span",null,"Project 11, part 2")])],-1),_=e('<p>Today we’re going to start applying the new techniques you learned to build our app, using SwiftData to create books and a custom <code>RatingView</code> component to let users store how much they liked each book, built using <code>@Binding</code>.</p><p>The way we handle data is critically important to our work. Sometimes it’s as simple as figuring out what should be a an integer and what should be a string; other times it requires a little theory, such as being able to choose between arrays and sets; and still other times it means we need to think about how objects relate to each other.</p><p>A quote from Linus Torvalds that I love very much is this one: “Bad programmers worry about the code; good programmers worry about data structures and their relationships.” I like it partly because it re-enforces the view that designing good data structures is critically important, but also because it’s a reminder that once you master one language it’s relatively easy to move to others – the syntax might be different, but the data structures are usually the same if not very similar.</p><p><strong>Today you have three topics to work through, in which you’ll apply your new-found SwiftData skills with <code>List</code>, <code>@Binding</code>, and more.</strong></p><h3 id="creating-books-with-swiftdata" tabindex="-1"><a class="header-anchor" href="#creating-books-with-swiftdata"><span>Creating books with <code>SwiftData</code></span></a></h3>',5),q={class:"hint-container details"},S=n("summary",null,"Creating books with SwiftData",-1),T=n("p",null,"Our first task in this project will be to design a SwitData model for our books, then creating a new view to add books to the database.",-1),j=n("code",null,"Book.swift",-1),I=e(`<div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@Model</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">Book</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> title<span class="token punctuation">:</span> <span class="token class-name">String</span></span>
<span class="line">    <span class="token keyword">var</span> author<span class="token punctuation">:</span> <span class="token class-name">String</span></span>
<span class="line">    <span class="token keyword">var</span> genre<span class="token punctuation">:</span> <span class="token class-name">String</span></span>
<span class="line">    <span class="token keyword">var</span> review<span class="token punctuation">:</span> <span class="token class-name">String</span></span>
<span class="line">    <span class="token keyword">var</span> rating<span class="token punctuation">:</span> <span class="token class-name">Int</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That class needs an initializer to provide values for all its properties, but here&#39;s a tip: if you just start typing &quot;in&quot; inside the class, Xcode should autocomplete the whole initializer for you.</p><p>That class is enough to store the title of the book, the name of whoever wrote the book, a genre, a brief overview of what the user thought of the book, and also the user’s numerical rating for it.</p>`,3),B=n("code",null,"BookwormApp.swift",-1),V=n("code",null,"import SwiftData",-1),D=n("code",null,"WindowGroup",-1),A=e(`<div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token punctuation">.</span><span class="token function">modelContainer</span><span class="token punctuation">(</span><span class="token keyword">for</span><span class="token punctuation">:</span> <span class="token class-name">Book</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Our next step is to write a form that can create new entries. This will combine so many of the skills you’ve learned so far: <code>Form</code>, <code>@State</code>, <code>@Environment</code>, <code>TextField</code>, <code>TextEditor</code>, <code>Picker</code>, <code>sheet()</code>, and more, plus all your new SwiftData knowledge.</p><p>Start by creating a new SwiftUI view called “AddBookView”. In terms of properties, we need an environment property to get access to our model context:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@Environment</span><span class="token punctuation">(</span><span class="token punctuation">\\</span><span class="token punctuation">.</span>modelContext<span class="token punctuation">)</span> <span class="token keyword">var</span> modelContext</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>As this form is going to store all the data required to make up a book, we need <code>@State</code> properties for each of the book’s values. So, add these properties next:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> title <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;&quot;</span></span></span>
<span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> author <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;&quot;</span></span></span>
<span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> rating <span class="token operator">=</span> <span class="token number">3</span></span>
<span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> genre <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;Fantasy&quot;</span></span></span>
<span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> review <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;&quot;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Finally, we need one more property to store all possible genre options, so we can make a picker using <code>ForEach</code>. Add this last property to <code>AddBookView</code> now:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> genres <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;Fantasy&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;Horror&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;Kids&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;Mystery&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;Poetry&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;Romance&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;Thriller&quot;</span></span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>We can now take a first pass at the form itself – we’ll improve it soon, but this is enough for now. Replace the current <code>body</code> with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">NavigationStack</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Form</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Section</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Name of book&quot;</span></span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> $title<span class="token punctuation">)</span></span>
<span class="line">            <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Author&#39;s name&quot;</span></span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> $author<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">            <span class="token class-name">Picker</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Genre&quot;</span></span><span class="token punctuation">,</span> selection<span class="token punctuation">:</span> $genre<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token class-name">ForEach</span><span class="token punctuation">(</span>genres<span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token punctuation">\\</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token short-argument">$0</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token class-name">Section</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Write a review&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                </span>
<span class="line">            <span class="token class-name">TextEditor</span><span class="token punctuation">(</span>text<span class="token punctuation">:</span> $review<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">            <span class="token class-name">Picker</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Rating&quot;</span></span><span class="token punctuation">,</span> selection<span class="token punctuation">:</span> $rating<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token class-name">ForEach</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">..&lt;</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">(</span><span class="token short-argument">$0</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span>                </span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token class-name">Section</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Save&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token comment">// add the book</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">navigationTitle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Add Book&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>When it comes to filling in the button’s action, we’re going to create an instance of the <code>Book</code> class using all the values from our form, then insert the object into the model context.</p><p>Add this code in place of the <code>// add the book</code> comment:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> newBook <span class="token operator">=</span> <span class="token class-name">Book</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> title<span class="token punctuation">,</span> author<span class="token punctuation">:</span> author<span class="token punctuation">,</span> genre<span class="token punctuation">:</span> genre<span class="token punctuation">,</span> review<span class="token punctuation">:</span> review<span class="token punctuation">,</span> rating<span class="token punctuation">:</span> rating<span class="token punctuation">)</span></span>
<span class="line">modelContext<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>newBook<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>That completes the form for now, but we still need a way to show and hide it when books are being added.</p>`,14),C=n("code",null,"AddBookView",-1),R=n("code",null,"ContentView.swift",-1),E=n("ol",null,[n("li",null,[s("Adding an "),n("code",null,"@State"),s(" property to track whether the sheet is showing.")]),n("li",null,"Add some sort of button – in the toolbar, in this case – to toggle that property."),n("li",null,[s("A "),n("code",null,"sheet()"),s(" modifier that shows "),n("code",null,"AddBookView"),s(" when the property becomes true.")])],-1),F=n("code",null,"ContentView.swift",-1),U=n("code",null,"ContentView",-1),P=e(`<div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@Environment</span><span class="token punctuation">(</span><span class="token punctuation">\\</span><span class="token punctuation">.</span>modelContext<span class="token punctuation">)</span> <span class="token keyword">var</span> modelContext</span>
<span class="line"><span class="token attribute atrule">@Query</span> <span class="token keyword">var</span> books<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Book</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> showingAddScreen <span class="token operator">=</span> <span class="token boolean">false</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That gives us a model context we can use later on to delete books, a query reading all the books we have (so we can test everything worked), and a Boolean that tracks whether the add screen is showing or not.</p><p>For the <code>ContentView</code> body, we’re going to use a navigation stack so we can add a title plus a button in its top-right corner, but otherwise it will just hold some text showing how many items we have in the <code>books</code> array – just so we can be sure everything is working. Remember, this is where we need to add our <code>sheet()</code> modifier to show an <code>AddBookView</code> as needed.</p><p>Replace the existing <code>body</code> property of <code>ContentView</code> with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"> <span class="token class-name">NavigationStack</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Count: </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">books<span class="token punctuation">.</span>count</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">navigationTitle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Bookworm&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span>toolbar <span class="token punctuation">{</span></span>
<span class="line">            <span class="token class-name">ToolbarItem</span><span class="token punctuation">(</span>placement<span class="token punctuation">:</span> <span class="token punctuation">.</span>topBarTrailing<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Add Book&quot;</span></span><span class="token punctuation">,</span> systemImage<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;plus&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    showingAddScreen<span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">sheet</span><span class="token punctuation">(</span>isPresented<span class="token punctuation">:</span> $showingAddScreen<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token class-name">AddBookView</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Tip</strong>: That explicitly specifies a trailing placement for the button so that we can add a second button later.</p><p>Bear with me – we’re almost done! We’ve now designed our SwiftData model, created a form to add data, then updated <code>ContentView</code> so that it can present the form when needed. The final step is to to make the form dismiss itself when the user adds a book.</p><p>We’ve done this before, so hopefully you know the drill. We need to start by adding another environment property to <code>AddBookView</code> to be able to dismiss the current view:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@Environment</span><span class="token punctuation">(</span><span class="token punctuation">\\</span><span class="token punctuation">.</span>dismiss<span class="token punctuation">)</span> <span class="token keyword">var</span> dismiss</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Finally, add a call to <code>dismiss()</code> to the end of your Save button’s action closure.</p><p>You should be able to run the app now and add an example book just fine. When <code>AddBookView</code> slides away the count label should update itself to 1.</p>`,11),W=n("h3",{id:"adding-a-custom-star-rating-component",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#adding-a-custom-star-rating-component"},[n("span",null,"Adding a custom star rating component")])],-1),N={class:"hint-container details"},$=n("summary",null,"Adding a custom star rating component",-1),Q=e(`<p>SwiftUI makes it really easy to create custom UI components, because they are effectively just views that have some sort of <code>@Binding</code> exposed for us to read.</p><p>To demonstrate this, we’re going to build a star rating view that lets the user enter scores between 1 and 5 by tapping images. Although we could just make this view simple enough to work for our exact use case, it’s often better to add some flexibility where appropriate so it can be used elsewhere too. Here, that means we’re going to make six customizable properties:</p><ul><li>What label should be placed before the rating (default: an empty string)</li><li>The maximum integer rating (default: 5)</li><li>The off and on images, which dictate the images to use when the star is highlighted or not (default: <code>nil</code> for the off image, and a filled star for the on image; if we find <code>nil</code> in the off image we’ll use the on image there too)</li><li>The off and on colors, which dictate the colors to use when the star is highlighted or not (default: gray for off, yellow for on)</li></ul><p>We also need one extra property to store an <code>@Binding</code> integer, so we can report back the user’s selection to whatever is using the star rating.</p><p>So, create a new SwiftUI view called “RatingView”, and start by giving it these properties:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@Binding</span> <span class="token keyword">var</span> rating<span class="token punctuation">:</span> <span class="token class-name">Int</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">var</span> label <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;&quot;</span></span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">var</span> maximumRating <span class="token operator">=</span> <span class="token number">5</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">var</span> offImage<span class="token punctuation">:</span> <span class="token class-name">Image</span><span class="token operator">?</span></span>
<span class="line"><span class="token keyword">var</span> onImage <span class="token operator">=</span> <span class="token class-name">Image</span><span class="token punctuation">(</span>systemName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;star.fill&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">var</span> offColor <span class="token operator">=</span> <span class="token class-name">Color</span><span class="token punctuation">.</span>gray</span>
<span class="line"><span class="token keyword">var</span> onColor <span class="token operator">=</span> <span class="token class-name">Color</span><span class="token punctuation">.</span>yellow</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Before we fill in the <code>body</code> property, please try building the code – you should find that it fails, because our <code>#Preview</code> code doesn’t pass in a binding to use for <code>rating</code>.</p><p>SwiftUI has a specific and simple solution for this called <em>constant bindings</em>. These are bindings that have fixed values, which on the one hand means they can’t be changed in the UI, but also means we can create them trivially – they are perfect for previews.</p><p>So, replace the existing preview code with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token other-directive property">#Preview</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">RatingView</span><span class="token punctuation">(</span>rating<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">constant</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now let’s turn to the <code>body</code> property. This is going to be a <code>HStack</code> containing any label that was provided, plus as many stars as have been requested – although, of course, they can choose any image they want, so it might not be a star at all.</p><p>The logic for choosing which image to show is pretty simple, but it’s perfect for carving off into its own method to reduce the complexity of our code. The logic is this:</p><ul><li>If the number that was passed in is greater than the current rating, return the off image if it was set, otherwise return the on image.</li><li>If the number that was passed in is equal to or less than the current rating, return the on image.</li></ul><p>We can encapsulate that in a single method, so add this to <code>RatingView</code> now:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">image</span><span class="token punctuation">(</span><span class="token keyword">for</span> number<span class="token punctuation">:</span> <span class="token class-name">Int</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Image</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> number <span class="token operator">&gt;</span> rating <span class="token punctuation">{</span></span>
<span class="line">        roffImage <span class="token operator">??</span> onImage</span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        onImage</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>And now implementing the <code>body</code> property is surprisingly easy: if the label has any text use it, then use <code>ForEach</code> to count from 1 to the maximum rating plus 1 and call <code>image(for:)</code> repeatedly. We’ll also apply a foreground color depending on the rating, and wrap each star inside a button that adjusts the rating.</p><p>Replace your existing <code>body</code> property with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">HStack</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> label<span class="token punctuation">.</span>isEmpty <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Text</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token class-name">ForEach</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">..&lt;</span>maximumRating <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token punctuation">\\</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> number <span class="token keyword">in</span></span>
<span class="line">        <span class="token class-name">Button</span> <span class="token punctuation">{</span></span>
<span class="line">            rating <span class="token operator">=</span> number</span>
<span class="line">        <span class="token punctuation">}</span> label<span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token function">image</span><span class="token punctuation">(</span><span class="token keyword">for</span><span class="token punctuation">:</span> number<span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span>number <span class="token operator">&gt;</span> rating <span class="token operator">?</span> offColor <span class="token punctuation">:</span> onColor<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That completes our rating view already, so to put it into action go back to <code>AddBookView</code> and replace the second section with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Section</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Write a review&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">TextEditor</span><span class="token punctuation">(</span>text<span class="token punctuation">:</span> $review<span class="token punctuation">)</span></span>
<span class="line">    <span class="token class-name">RatingView</span><span class="token punctuation">(</span>rating<span class="token punctuation">:</span> $rating<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Our default values are sensible, so it looks great out of the box – go ahead and try it now!</p><p>Chances are you&#39;ll see things don&#39;t quite work right: no matter which star rating you press, it will select 5 stars!</p><p>I&#39;ve seen this problem hit countless hundreds of people, no matter how much experience they have. The problem is that when we have rows inside a form or a list, SwiftUI likes to assume the rows themselves are tappable. This makes selection easier for users, because they can tap anywhere in a row to trigger the button inside it.</p><p>In our case we have <em>multiple</em> buttons, so SwiftUI is tapping them <em>all</em> in order – <code>rating</code> gets set to 1, then 2, then 3, 4, and 5, which is why it ends up at 5 no matter what.</p><p>We can disable the whole &quot;tap the row to trigger its buttons&quot; behavior with an extra modifier attached to the whole <code>HStack</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token punctuation">.</span><span class="token function">buttonStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>plain<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>That makes SwiftUI treat each button individually, so everything works as planned. And the result is much nicer to use: there’s no need to tap into a detail view with a picker here, because star ratings are more natural and more common.</p>`,27),H=n("h3",{id:"building-a-list-with-query",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#building-a-list-with-query"},[n("span",null,[s("Building a list with "),n("code",null,"@Query")])])],-1),L={class:"hint-container details"},z=n("summary",null,"Building a list with @Query",-1),M=e(`<p>Right now our <code>ContentView</code> has a query property like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@Query</span> <span class="token keyword">var</span> books<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Book</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>And we’re using it in <code>body</code> with this simple text view:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Count: </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">books<span class="token punctuation">.</span>count</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>To bring this screen to life, we’re going to replace that text view with a <code>List</code> showing all the books that have been added, along with their rating and author.</p><p>We <em>could</em> just use the same star rating view here that we made earlier, but it’s much more fun to try something else. Whereas the <code>RatingView</code> control can be used in any kind of project, we can make a new <code>EmojiRatingView</code> that displays a rating specific to this project. All it will do is show one of five different emoji depending on the rating, and it’s a great example of how straightforward view composition is in SwiftUI – it’s so easy to just pull out a small part of your views in this way.</p><p>So, make a new SwiftUI view called “EmojiRatingView”, and give it the following code:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">struct</span> <span class="token class-name">EmojiRatingView</span><span class="token punctuation">:</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> rating<span class="token punctuation">:</span> <span class="token class-name">Int</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">var</span> body<span class="token punctuation">:</span> <span class="token keyword">some</span> <span class="token class-name">View</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">switch</span> rating <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;1&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;2&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">case</span> <span class="token number">3</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;3&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">case</span> <span class="token number">4</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;4&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">default</span><span class="token punctuation">:</span></span>
<span class="line">            <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;5&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token other-directive property">#Preview</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">EmojiRatingView</span><span class="token punctuation">(</span>rating<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Tip</strong>: I used numbers in my text because emoji can cause havoc with e-readers, but you should replace those with whatever emoji you think represent the various ratings.</p><p>Now we can return to <code>ContentView</code> and do a first pass of its UI. This will replace the existing text view with a list and a <code>ForEach</code> over <code>books</code>. We don’t need to provide an identifier for the <code>ForEach</code> because all SwiftData models conform to <code>Identifiable</code> automatically.</p><p>Inside the list we’re going to have a <code>NavigationLink</code> that point to the current book, and inside <em>that</em> we’ll have our new <code>EmojiRatingView</code>, plus the book’s title and author. So, replace the existing text view with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">List</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">ForEach</span><span class="token punctuation">(</span>books<span class="token punctuation">)</span> <span class="token punctuation">{</span> book <span class="token keyword">in</span></span>
<span class="line">        <span class="token class-name">NavigationLink</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> book<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token class-name">HStack</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token class-name">EmojiRatingView</span><span class="token punctuation">(</span>rating<span class="token punctuation">:</span> book<span class="token punctuation">.</span>rating<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>largeTitle<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">                <span class="token class-name">VStack</span><span class="token punctuation">(</span>alignment<span class="token punctuation">:</span> <span class="token punctuation">.</span>leading<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token class-name">Text</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>title<span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>headline<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token class-name">Text</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>author<span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>secondary<span class="token punctuation">)</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Tip: Make sure you leave the earlier modifiers in place - <code>navigationTitle()</code>, etc.</p><p>Navigation won&#39;t quite work because we haven&#39;t added <code>navigationDestination()</code> just yet, but that&#39;s okay – we’ll come back to this screen soon enough. First let’s build the detail view…</p>`,14),K=n("p",null,"Don’t forget to tell others about your progress – you’re building your own SwiftData models and SwiftUI components now, and it helps keep you accountable.",-1),O=n("hr",null,null,-1);function Z(d,G){const t=r("router-link"),i=r("VPCard"),u=r("VidStack"),o=r("FontIcon");return v(),m("div",null,[n("h1",w,[n("a",b,[n("span",null,h(d.$frontmatter.title)+" 관련",1)])]),n("nav",f,[n("ul",null,[n("li",null,[a(t,{to:"#project-11-part-2"},{default:p(()=>[s("Project 11, part 2")]),_:1}),n("ul",null,[n("li",null,[a(t,{to:"#creating-books-with-swiftdata"},{default:p(()=>[s("Creating books with SwiftData")]),_:1})]),n("li",null,[a(t,{to:"#adding-a-custom-star-rating-component"},{default:p(()=>[s("Adding a custom star rating component")]),_:1})]),n("li",null,[a(t,{to:"#building-a-list-with-query"},{default:p(()=>[s("Building a list with @Query")]),_:1})])])])])]),y,x,a(i,l(c({title:"100 Days of SwiftUI - Day 54",desc:"Project 11, part 2",link:"https://www.hackingwithswift.com/100/swiftui/54",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),_,n("details",q,[S,a(i,l(c({title:"100 Days of SwiftUI - Day 54 - Creating books with SwiftData",desc:"Creating books with SwiftData",link:"https://www.hackingwithswift.com/books/ios-swiftui/creating-books-with-swiftdata",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),a(u,{src:"youtube/nY6DzyLCVeg"}),T,n("p",null,[s("First, the model: create a new file called "),a(o,{icon:"fa-brands fa-swift"}),j,s(", add an import for SwiftData, then give it this code:")]),I,n("p",null,[s("Now that we have our data model, we can ask SwiftData to create a model container for it. This means opening "),a(o,{icon:"fa-brands fa-swift"}),B,s(", adding "),V,s(" to the top of the file, then adding this modifier to the "),D,s(":")]),A,n("p",null,[s("Showing "),C,s(" involves returning to "),a(o,{icon:"fa-brands fa-swift"}),R,s(" and following the usual steps for a sheet:")]),E,n("p",null,[s("Enough talk – let’s start writing some more code. Please start by adding an import for SwiftData to "),a(o,{icon:"fa-brands fa-swift"}),F,s(", then add these properties to the "),U,s(" struct:")]),P]),W,n("details",N,[$,a(i,l(c({title:"100 Days of SwiftUI - Day 54 - Adding a custom star rating component",desc:"Adding a custom star rating component",link:"https://www.hackingwithswift.com/books/ios-swiftui/adding-a-custom-star-rating-component",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),a(u,{src:"youtube/iI7prZsHaTQ"}),Q]),H,n("details",L,[z,a(i,l(c({title:"100 Days of SwiftUI - Day 54 - Building a list with @Query",desc:"Building a list with @Query",link:"https://www.hackingwithswift.com/books/ios-swiftui/building-a-list-with-query",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),a(u,{src:"youtube/VW8s7jhrJMk"}),M]),K,O])}const X=k(g,[["render",Z],["__file","54.html.vue"]]),nn=JSON.parse('{"path":"/swift/100-days-of-swiftui/54.html","title":"Day 54","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Day 54","description":"100 Days of SwiftUI > Day 54","category":["Swift"],"tag":["crashcourse","paul-hudson","swift","swiftui","hacking-with-swift","xcode","appstore"],"head":[[{"meta":null},{"property":"og:title","content":"100 Days of SwiftUI > Day 54"},{"property":"og:description","content":"Day 54"},{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/swift/100-days-of-swiftui/54.html"}],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/crashcourse/swift/100-days-of-swiftui/54.html"}],["meta",{"property":"og:site_name","content":"🥁Crashcourse"}],["meta",{"property":"og:title","content":"Day 54"}],["meta",{"property":"og:description","content":"100 Days of SwiftUI > Day 54"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"og:updated_time","content":"2024-10-03T01:20:13.000Z"}],["meta",{"property":"article:tag","content":"crashcourse"}],["meta",{"property":"article:tag","content":"paul-hudson"}],["meta",{"property":"article:tag","content":"swift"}],["meta",{"property":"article:tag","content":"swiftui"}],["meta",{"property":"article:tag","content":"hacking-with-swift"}],["meta",{"property":"article:tag","content":"xcode"}],["meta",{"property":"article:tag","content":"appstore"}],["meta",{"property":"article:modified_time","content":"2024-10-03T01:20:13.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Day 54\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-10-03T01:20:13.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"Project 11, part 2","slug":"project-11-part-2","link":"#project-11-part-2","children":[{"level":3,"title":"Creating books with SwiftData","slug":"creating-books-with-swiftdata","link":"#creating-books-with-swiftdata","children":[]},{"level":3,"title":"Adding a custom star rating component","slug":"adding-a-custom-star-rating-component","link":"#adding-a-custom-star-rating-component","children":[]},{"level":3,"title":"Building a list with @Query","slug":"building-a-list-with-query","link":"#building-a-list-with-query","children":[]}]}],"git":{"createdTime":1703642364000,"updatedTime":1727918413000,"contributors":[{"name":"chanhi2000","email":"chanhi2000@gmail.com","commits":8}]},"readingTime":{"minutes":8.78,"words":2634},"filePathRelative":"swift/100-days-of-swiftui/54.md","localizedDate":"2023년 12월 27일","excerpt":"\\n\\n<hr>\\n<h2>Project 11, part 2</h2>\\n"}');export{X as comp,nn as data};

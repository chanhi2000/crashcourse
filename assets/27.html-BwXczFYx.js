import{_ as h}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as m,a as n,t as k,b as e,w as o,n as i,g as p,d as s,e as c,r as l,o as w}from"./app-U_bew1in.js";const g={},f={id:"frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´",tabindex:"-1"},b={class:"header-anchor",href:"#frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´"},v={class:"table-of-contents"},y=n("hr",null,null,-1),S=c('<h2 id="project-4-part-2" tabindex="-1"><a class="header-anchor" href="#project-4-part-2"><span>Project 4, part 2</span></a></h2><p>Today we‚Äôre going to build our project, combining both SwiftUI and Core ML in remarkably few lines of code ‚Äì I think you‚Äôll be impressed.</p><p>What I hope you‚Äôll get from this project ‚Äì apart from all the SwiftUI goodies, of course ‚Äì is just a little glimpse into the wider world of app development. Core ML is just one of Apple‚Äôs powerhouse frameworks, and there are over a dozen more: ARKit, Core Graphics, Core Image, MapKit, WebKit, and more, are all waiting to be discovered when you‚Äôre ready.</p><p>I realize that you might have thought ‚Äúwow, we‚Äôre looking at machine learning already?‚Äù After all, this is only day 27 of a 100-day course. But, as Andre Gide said, ‚Äúyou cannot discover new oceans unless you have the courage to lose sight of the shore.‚Äù</p><p><strong>Today you have three topics to work through, and you‚Äôll get busy implementing <code>Stepper</code>, <code>DatePicker</code>, <code>DateFormatter</code>, and more in a real app.</strong></p><h3 id="building-a-basic-layout" tabindex="-1"><a class="header-anchor" href="#building-a-basic-layout"><span>Building a basic layout</span></a></h3>',6),_={class:"hint-container details"},x=n("summary",null,"Building a basic layout",-1),C=c(`<p>This app is going to allow user input with a date picker and two steppers, which combined will tell us when they want to wake up, how much sleep they usually like, and how much coffee they drink.</p><p>So, please start by adding three properties that let us store the information for those controls:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> wakeUp <span class="token operator">=</span> <span class="token class-name">Date</span><span class="token punctuation">.</span>now</span>
<span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> sleepAmount <span class="token operator">=</span> <span class="token number">8.0</span></span>
<span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> coffeeAmount <span class="token operator">=</span> <span class="token number">1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Inside our <code>body</code> we‚Äôre going to place three sets of components wrapped in a <code>VStack</code> and a <code>NavigationView</code>, so let‚Äôs start with the wake up time. Replace the default ‚ÄúHello World‚Äù text view with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">NavigationView</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">VStack</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;When do you want to wake up?&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>headline<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token class-name">DatePicker</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Please enter a time&quot;</span></span><span class="token punctuation">,</span> selection<span class="token punctuation">:</span> $wakeUp<span class="token punctuation">,</span> displayedComponents<span class="token punctuation">:</span> <span class="token punctuation">.</span>hourAndMinute<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">labelsHidden</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// more to come</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We‚Äôve asked for <code>.hourAndMinute</code> configuration because we care about the time someone wants to wake up and not the day, and with the <code>labelsHidden()</code> modifier we don‚Äôt get a second label for the picker ‚Äì the one above is more than enough.</p><p>Next we‚Äôre going to add a stepper to let users choose roughly how much sleep they want. By giving this thing an <code>in</code> range of <code>4...12</code> and a step of 0.25 we can be sure they‚Äôll enter sensible values, but we can combine that with the <code>formatted()</code> method so we see numbers like ‚Äú8‚Äù and not ‚Äú8.000000‚Äù.</p><p>Add this code in place of the <code>// more to come</code> comment‚Äù</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Desired amount of sleep&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>headline<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name">Stepper</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;</span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">sleepAmount<span class="token punctuation">.</span><span class="token function">formatted</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token interpolation-punctuation punctuation">)</span><span class="token string"> hours&quot;</span></span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> $sleepAmount<span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token operator">...</span><span class="token number">12</span><span class="token punctuation">,</span> step<span class="token punctuation">:</span> <span class="token number">0.25</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Finally we‚Äôll add one last stepper and label to handle how much coffee they drink. This time we‚Äôll use the range of 1 through 20 (because surely 20 coffees a day is enough for anyone?), but we‚Äôll also display one of two labels inside the stepper to handle pluralization better. If the user has set a <code>coffeeAmount</code> of exactly 1 we‚Äôll show ‚Äú1 cup‚Äù, otherwise we‚Äôll use that amount plus ‚Äúcups‚Äù, all decided using the ternary conditional operator.</p><p>Add these inside the <code>VStack</code>, below the previous views:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Daily coffee intake&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>headline<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name">Stepper</span><span class="token punctuation">(</span>coffeeAmount <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token string-literal"><span class="token string">&quot;1 cup&quot;</span></span> <span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;</span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">coffeeAmount</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string"> cups&quot;</span></span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> $coffeeAmount<span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token operator">...</span><span class="token number">20</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The final thing we need is a button to let users calculate the best time they should go to sleep. We could do that with a simple button at the end of the <code>VStack</code>, but to spice up this project a little I want to try something new: we‚Äôre going to add a button directly to the navigation bar.</p><p>First we need a method for the button to call, so add an empty <code>calculateBedtime()</code> method like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">calculateBedtime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Now we need to use the <code>toolbar()</code> modifier to add a trailing button to the navigation view. We used this previously along with <code>ToolbarItemGroup</code> to place a button next to the keyboard, but here our needs are much simpler: we just want a single button in the navigation bar, which can be done by adding a button directly to the toolbar.</p><p>While we‚Äôre here, we might as well also use <code>navigationTitle()</code> to put some text at the top.</p><p>So, add these modifiers to the <code>VStack</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token punctuation">.</span><span class="token function">navigationTitle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;BetterRest&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">.</span>toolbar <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Calculate&quot;</span></span><span class="token punctuation">,</span> action<span class="token punctuation">:</span> calculateBedtime<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Tip</strong>: Our button will automatically be placed in the top-right corner for left-to-right languages such as English, but will automatically move to the other side for right-to-left languages.</p><p>That won‚Äôt do anything yet because <code>calculateBedtime()</code> is empty, but at least our UI is good enough for the time being.</p>`,21),T=n("h3",{id:"connecting-swiftui-to-core-ml",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#connecting-swiftui-to-core-ml"},[n("span",null,"Connecting SwiftUI to Core ML")])],-1),j={class:"hint-container details"},D=n("summary",null,"Connecting SwiftUI to Core ML",-1),I=c(`<p>In the same way that SwiftUI makes user interface development easy, Core ML makes machine learning easy. How easy? Well, once you have a trained model you can get predictions in just two lines of code ‚Äì you just need to send in the values that should be used as input, then read what comes back.</p><p>In our case, we already made a Core ML model using Xcode‚Äôs Create ML app, so we‚Äôre going to use that. You should have saved it on your desktop, so please now drag it into the project navigator in Xcode. When Xcode prompts you to ‚ÄúCopy items if needed‚Äù, please make sure that box is checked.</p><p>When you add an .mlmodel file to Xcode, it will automatically create a Swift class of the same name. You can‚Äôt see the class, and don‚Äôt need to ‚Äì it‚Äôs generated automatically as part of the build process. However, it <em>does</em> mean that if your model file is named oddly then the auto-generated class name will also be named oddly.</p><p><strong>No matter what name your model file has, please rename it to be ‚ÄúSleepCalculator.mlmodel‚Äù, thus making the auto-generated class be called <code>SleepCalculator</code>.</strong></p><p>How can we be sure that‚Äôs the class name? Well, just select the model file itself and Xcode will show you more information. You‚Äôll see it knows our author, the name of the Swift class that gets made, plus a list of inputs and their types, and an output plus type too ‚Äì these were encoded in the model file, which is why it was (comparatively!) so big.</p><p>We‚Äôre going to start filling in <code>calculateBedtime()</code> in just a moment, but before that can start we need to add an import for CoreML because we‚Äôre using functionality outside of SwiftUI.</p><p>So, scroll to the top of ContentView.swift and add this before the <code>import</code> line for SwiftUI:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token class-name">CoreML</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>Tip</strong>: You don‚Äôt strictly need to add CoreML before SwiftUI, but keeping your imports in alphabetical order makes them easier to check later on.</p><p>Okay, now we can turn to <code>calculateBedtime()</code>. First, we need to create an instance of the <code>SleepCalculator</code> class, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">do</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> config <span class="token operator">=</span> <span class="token class-name">MLModelConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">let</span> model <span class="token operator">=</span> <span class="token keyword">try</span> <span class="token class-name">SleepCalculator</span><span class="token punctuation">(</span>configuration<span class="token punctuation">:</span> config<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment">// more code here</span></span>
<span class="line"><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// something went wrong!</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That model instance is the thing that reads in all our data, and will output a prediction. The configuration is there in case you need to enable a handful of what are fairly obscure options ‚Äì perhaps folks working in machine learning full time need these, but honestly I‚Äôd guess only 1 in 1000 folks actually use these.</p><p>I <em>do</em> want you to focus on the <code>do</code>/<code>catch</code> blocks, because using Core ML can throw errors in two places: loading the model as seen above, but also when we ask for predictions. Honestly, I can‚Äôt think I‚Äôve ever had a prediction fail in my life, but there‚Äôs no harm being safe!</p><p>Anyway, we trained our model with a CSV file containing the following fields:</p><ul><li>‚Äúwake‚Äù: when the user wants to wake up. This is expressed as the number of seconds from midnight, so 8am would be 8 hours multiplied by 60 multiplied by 60, giving 28800.</li><li>‚ÄúestimatedSleep‚Äù: roughly how much sleep the user wants to have, stored as values from 4 through 12 in quarter increments.</li><li>‚Äúcoffee‚Äù: roughly how many cups of coffee the user drinks per day.</li></ul><p>So, in order to get a prediction out of our model, we need to fill in those values.</p><p>We already have two of them, because our <code>sleepAmount</code> and <code>coffeeAmount</code> properties are mostly good enough ‚Äì we just need to convert <code>coffeeAmount</code> from an integer to a <code>Double</code> so that Swift is happy.</p><p>But figuring out the wake time requires more thinking, because our <code>wakeUp</code> property is a <code>Date</code> not a <code>Double</code> representing the number of seconds. Helpfully, this is where Swift‚Äôs <code>DateComponents</code> type comes in: it stores all the parts required to represent a date as individual values, meaning that we can read the hour and minute components and ignore the rest. All we then need to do is multiply the minute by 60 (to get seconds rather than minutes), and the hour by 60 and 60 (to get seconds rather than hours).</p><p>We can get a <code>DateComponents</code> instance from a <code>Date</code> with a very specific method call: <code>Calendar.current.dateComponents()</code>. We can then request the hour and minute components, and pass in our wake up date. The <code>DateComponents</code> instance that comes back has properties for all its components ‚Äì year, month, day, timezone, etc ‚Äì but most of them won‚Äôt be set. The ones we asked for ‚Äì hour and minute ‚Äì will be set, but <em>will</em> be optional, so we need to unwrap them carefully.</p><p>So, put this in place of the <code>// more code here</code> comment in <code>calculateBedtime()</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> components <span class="token operator">=</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">dateComponents</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">.</span>hour<span class="token punctuation">,</span> <span class="token punctuation">.</span>minute<span class="token punctuation">]</span><span class="token punctuation">,</span> from<span class="token punctuation">:</span> wakeUp<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">let</span> hour <span class="token operator">=</span> <span class="token punctuation">(</span>components<span class="token punctuation">.</span>hour <span class="token operator">??</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span></span>
<span class="line"><span class="token keyword">let</span> minute <span class="token operator">=</span> <span class="token punctuation">(</span>components<span class="token punctuation">.</span>minute <span class="token operator">??</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">60</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That code uses 0 if either the hour or minute can‚Äôt be read, but realistically that‚Äôs never going to happen so it will result in <code>hour</code> and <code>minute</code> being set to those values in seconds.</p><p>The next step is to feed our values into Core ML and see what comes out. This is done using the <code>prediction()</code> method of our model, which wants the wake time, estimated sleep, and coffee amount values required to make a prediction, all provided as <code>Double</code> values. We just calculated our <code>hour</code> and <code>minute</code> as seconds, so we‚Äôll add those together before sending them in.</p><p>Please add this just below the previous code:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> prediction <span class="token operator">=</span> <span class="token keyword">try</span> model<span class="token punctuation">.</span><span class="token function">prediction</span><span class="token punctuation">(</span>wake<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">(</span>hour <span class="token operator">+</span> minute<span class="token punctuation">)</span><span class="token punctuation">,</span> estimatedSleep<span class="token punctuation">:</span> sleepAmount<span class="token punctuation">,</span> coffee<span class="token punctuation">:</span> <span class="token class-name">Double</span><span class="token punctuation">(</span>coffeeAmount<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// more code here</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>With that in place, <code>prediction</code> now contains how much sleep they actually need. This almost certainly wasn‚Äôt part of the training data our model saw, but was instead computed dynamically by the Core ML algorithm.</p><p>However, it‚Äôs not a helpful value for users ‚Äì it will be some number in seconds. What we want is to convert that into the time they should go to bed, which means we need to subtract that value in seconds from the time they need to wake up.</p><p>Thanks to Apple‚Äôs powerful APIs, that‚Äôs just one line of code ‚Äì you can subtract a value in seconds directly from a <code>Date</code>, and you‚Äôll get back a new <code>Date</code>! So, add this line of code after the prediction:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> sleepTime <span class="token operator">=</span> wakeUp <span class="token operator">-</span> prediction<span class="token punctuation">.</span>actualSleep</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>And now we know exactly when they should go to sleep. Our final challenge, for now at least, is to show that to the user. We‚Äôll be doing this with an alert, because you‚Äôve already learned how to do that and could use the practice.</p><p>So, start by adding three properties that determine the title and message of the alert, and whether or not it‚Äôs showing:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> alertTitle <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;&quot;</span></span></span>
<span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> alertMessage <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;&quot;</span></span></span>
<span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> showingAlert <span class="token operator">=</span> <span class="token boolean">false</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We can immediately use those values in <code>calculateBedtime()</code>. If our calculation goes wrong ‚Äì if reading a prediction throws an error ‚Äì we can replace the <code>// something went wrong</code> comment with some code that sets up a useful error message:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line">alertTitle <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;Error&quot;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>alertMessage = &quot;Sorry, there was a problem calculating your bedtime.&quot; And regardless of whether or not the prediction worked, we should show the alert. It might contain the results of their prediction or it might contain the error message, but it‚Äôs still useful. So, put this at the end of <code>calculateBedtime()</code>, <em>after</em> the <code>catch</code> block:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line">showingAlert <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>If the prediction worked we create a constant called <code>sleepTime</code> that contains the time they need to go to bed. But this is a <code>Date</code> rather than a neatly formatted string, so we‚Äôll pass it through the <code>formatted()</code> method to make sure it‚Äôs human-readable, then assign it to <code>alertMessage</code>.</p><p>So, put these final lines of code into <code>calculateBedtime()</code>, directly after where we set the <code>sleepTime</code> constant:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line">alertTitle <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;Your ideal bedtime is‚Ä¶&quot;</span></span></span>
<span class="line">alertMessage <span class="token operator">=</span> sleepTime<span class="token punctuation">.</span><span class="token function">formatted</span><span class="token punctuation">(</span>date<span class="token punctuation">:</span> <span class="token punctuation">.</span>omitted<span class="token punctuation">,</span> time<span class="token punctuation">:</span> <span class="token punctuation">.</span>shortened<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>To wrap up this stage of the app, we just need to add an <code>alert()</code> modifier that shows <code>alertTitle</code> and <code>alertMessage</code> when <code>showingAlert</code> becomes true.</p><p>Please add this modifier to our <code>VStack</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span>alertTitle<span class="token punctuation">,</span> isPresented<span class="token punctuation">:</span> $showingAlert<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;OK&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span> message<span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Text</span><span class="token punctuation">(</span>alertMessage<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now go ahead and run the app ‚Äì it works! It doesn‚Äôt look <em>great</em>, but it works.</p>`,43),A=n("h3",{id:"cleaning-up-the-user-interface",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#cleaning-up-the-user-interface"},[n("span",null,"Cleaning up the user interface")])],-1),q={class:"hint-container details"},M=n("summary",null,"Cleaning up the user interface",-1),U=c(`<p>Although our app works right now, it‚Äôs not something you‚Äôd want to ship on the App Store ‚Äì it has at least one major usability problem, and the design is‚Ä¶ well‚Ä¶ let‚Äôs say ‚Äúsubstandard‚Äù.</p><p>Let‚Äôs look at the usability problem first, because it‚Äôs possible it hasn‚Äôt occurred to you. When you read <code>Date.now</code> it is automatically set to the current date and time. So, when we create our <code>wakeUp</code> property with a new date, the default wake up time will be whatever time it is right now.</p><p>Although the app needs to be able to handle any sort of times ‚Äì we don‚Äôt want to exclude folks on night shift, for example ‚Äì I think it‚Äôs safe to say that a default wake up time somewhere between 6am and 8am is going to be more useful to the vast majority of users.</p><p>To fix this we‚Äôre going to add a computed property to our <code>ContentView</code> struct that contains a <code>Date</code> value referencing 7am of the current day. This is surprisingly easy: we can just create a new <code>DateComponents</code> of our own, and use <code>Calendar.current.date(from:)</code> to convert those components into a full date.</p><p>So, add this property to <code>ContentView</code> now:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">var</span> defaultWakeTime<span class="token punctuation">:</span> <span class="token class-name">Date</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> components <span class="token operator">=</span> <span class="token class-name">DateComponents</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    components<span class="token punctuation">.</span>hour <span class="token operator">=</span> <span class="token number">7</span></span>
<span class="line">    components<span class="token punctuation">.</span>minute <span class="token operator">=</span> <span class="token number">0</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token class-name">Calendar</span><span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span>from<span class="token punctuation">:</span> components<span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token class-name">Date</span><span class="token punctuation">.</span>now</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>And now we can use that for the default value of <code>wakeUp</code> in place of <code>Date.now</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> wakeUp <span class="token operator">=</span> defaultWakeTime</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>If you try compiling that code you‚Äôll see it fails, and the reason is that we‚Äôre accessing one property from inside another ‚Äì Swift doesn‚Äôt know which order the properties will be created in, so this isn‚Äôt allowed.</p><p>The fix here is simple: we can make <code>defaultWakeTime</code> a static variable, which means it belongs to the <code>ContentView</code> struct itself rather than a single instance of that struct. This in turn means <code>defaultWakeTime</code> can be read whenever we want, because it doesn‚Äôt rely on the existence of any other properties.</p><p>So, change the property definition to this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">static</span> <span class="token keyword">var</span> defaultWakeTime<span class="token punctuation">:</span> <span class="token class-name">Date</span> <span class="token punctuation">{</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>That fixes our usability problem, because the majority of users will find the default wake up time is close to what they want to choose.</p><p>As for our styling, this requires more effort. A simple change to make is to switch to a <code>Form</code> rather than a <code>VStack</code>. So, find this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">NavigationView</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">VStack</span> <span class="token punctuation">{</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>And replace it with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">NavigationView</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Form</span> <span class="token punctuation">{</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>That immediately makes the UI look better ‚Äì we get a clearly segmented table of inputs, rather than some controls centered in a white space.</p><p>There‚Äôs still an annoyance in our form: every view inside the form is treated as a row in the list, when really all the text views form part of the same logical form section.</p><p>We <em>could</em> use <code>Section</code> views here, with our text views as titles ‚Äì you‚Äôll get to experiment with that in the challenges. Instead, we‚Äôre going to wrap each pair of text view and control with a <code>VStack</code> so they are seen as a single row each.</p><p>Go ahead and wrap each of the pairs in a <code>VStack</code> now, using <code>.leading</code> for the alignment and 0 for spacing. For example, you‚Äôd take these two views:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Desired amount of sleep&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>headline<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name">Stepper</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;</span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">sleepAmount<span class="token punctuation">.</span><span class="token function">formatted</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token interpolation-punctuation punctuation">)</span><span class="token string"> hours&quot;</span></span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> $sleepAmount<span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token operator">...</span><span class="token number">12</span><span class="token punctuation">,</span> step<span class="token punctuation">:</span> <span class="token number">0.25</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>And wrap them in a <code>VStack</code> like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">VStack</span><span class="token punctuation">(</span>alignment<span class="token punctuation">:</span> <span class="token punctuation">.</span>leading<span class="token punctuation">,</span> spacing<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Desired amount of sleep&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>headline<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token class-name">Stepper</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;</span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">sleepAmount<span class="token punctuation">.</span><span class="token function">formatted</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token interpolation-punctuation punctuation">)</span><span class="token string"> hours&quot;</span></span><span class="token punctuation">,</span> value<span class="token punctuation">:</span> $sleepAmount<span class="token punctuation">,</span> <span class="token keyword">in</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token operator">...</span><span class="token number">12</span><span class="token punctuation">,</span> step<span class="token punctuation">:</span> <span class="token number">0.25</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>And now run the app one last time, because it‚Äôs done ‚Äì good job!</p>`,25),V={class:"hint-container tip"},W=n("p",{class:"hint-container-title"},"Note",-1),B={href:"https://www.youtube.com/watch?v=a905KIBw1hs",target:"_blank",rel:"noopener noreferrer"},L=n("hr",null,null,-1);function P(u,N){const a=l("router-link"),t=l("VPCard"),r=l("VidStack"),d=l("FontIcon");return w(),m("div",null,[n("h1",f,[n("a",b,[n("span",null,k(u.$frontmatter.title)+" Í¥ÄÎ†®",1)])]),n("nav",v,[n("ul",null,[n("li",null,[e(a,{to:"#project-4-part-2"},{default:o(()=>[s("Project 4, part 2")]),_:1}),n("ul",null,[n("li",null,[e(a,{to:"#building-a-basic-layout"},{default:o(()=>[s("Building a basic layout")]),_:1})]),n("li",null,[e(a,{to:"#connecting-swiftui-to-core-ml"},{default:o(()=>[s("Connecting SwiftUI to Core ML")]),_:1})]),n("li",null,[e(a,{to:"#cleaning-up-the-user-interface"},{default:o(()=>[s("Cleaning up the user interface")]),_:1})])])])])]),y,e(t,i(p({title:"100 Days of SwiftUI - Day 27",desc:"Project 4, part 2",link:"https://www.hackingwithswift.com/100/swiftui/27",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),S,n("details",_,[x,e(t,i(p({title:"100 Days of SwiftUI - Day 27 - Building a basic layout",desc:"Building a basic layout",link:"https://hackingwithswift.com/books/ios-swiftui/building-a-basic-layout",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),e(r,{src:"youtube/pvKF78fOMQ4"}),C]),T,n("details",j,[D,e(t,i(p({title:"100 Days of SwiftUI - Day 27 - Connecting SwiftUI to Core ML",desc:"Connecting SwiftUI to Core ML",link:"https://hackingwithswift.com/books/ios-swiftui/connecting-swiftui-to-core-ml",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),e(r,{src:"youtube/554iAZE0Qq8"}),I]),A,n("details",q,[M,e(t,i(p({title:"100 Days of SwiftUI - Day 27 - Cleaning up the user interface",desc:"Cleaning up the user interface",link:"https://hackingwithswift.com/books/ios-swiftui/cleaning-up-the-user-interface",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),e(r,{src:"youtube/b--usZU6kM8"}),U]),n("div",V,[W,n("p",null,[s("If you‚Äôre keen to learn more about Create ML, I have a video you might enjoy ‚Äì "),n("a",B,[e(d,{icon:"fa-brands fa-youtube"}),s("click here to check it out")])])]),L])}const K=h(g,[["render",P],["__file","27.html.vue"]]),R=JSON.parse('{"path":"/swift/100-days-of-swiftui/27.html","title":"Day 27","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Day 27","description":"100 Days of SwiftUI > Day 27","category":["Swift"],"tag":["crashcourse","paul-hudson","swift","swiftui","hacking-with-swift","xcode","appstore"],"head":[[{"meta":null},{"property":"og:title","content":"100 Days of SwiftUI > Day 27"},{"property":"og:description","content":"Day 27"},{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/swift/100-days-of-swiftui/27.html"}],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/crashcourse/swift/100-days-of-swiftui/27.html"}],["meta",{"property":"og:site_name","content":"ü•ÅCrashcourse"}],["meta",{"property":"og:title","content":"Day 27"}],["meta",{"property":"og:description","content":"100 Days of SwiftUI > Day 27"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"og:updated_time","content":"2024-10-03T01:20:13.000Z"}],["meta",{"property":"article:tag","content":"crashcourse"}],["meta",{"property":"article:tag","content":"paul-hudson"}],["meta",{"property":"article:tag","content":"swift"}],["meta",{"property":"article:tag","content":"swiftui"}],["meta",{"property":"article:tag","content":"hacking-with-swift"}],["meta",{"property":"article:tag","content":"xcode"}],["meta",{"property":"article:tag","content":"appstore"}],["meta",{"property":"article:modified_time","content":"2024-10-03T01:20:13.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Day 27\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-10-03T01:20:13.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"Project 4, part 2","slug":"project-4-part-2","link":"#project-4-part-2","children":[{"level":3,"title":"Building a basic layout","slug":"building-a-basic-layout","link":"#building-a-basic-layout","children":[]},{"level":3,"title":"Connecting SwiftUI to Core ML","slug":"connecting-swiftui-to-core-ml","link":"#connecting-swiftui-to-core-ml","children":[]},{"level":3,"title":"Cleaning up the user interface","slug":"cleaning-up-the-user-interface","link":"#cleaning-up-the-user-interface","children":[]}]}],"git":{"createdTime":1703642364000,"updatedTime":1727918413000,"contributors":[{"name":"chanhi2000","email":"chanhi2000@gmail.com","commits":9}]},"readingTime":{"minutes":10.24,"words":3071},"filePathRelative":"swift/100-days-of-swiftui/27.md","localizedDate":"2023ÎÖÑ 12Ïõî 27Ïùº","excerpt":"\\n\\n<hr>\\n"}');export{K as comp,R as data};

import{_ as h}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as m,a as n,t as k,b as s,w as p,n as c,g as l,d as a,e,r,o as w}from"./app-U_bew1in.js";const g={},f={id:"frontmatter-title-관련",tabindex:"-1"},v={class:"header-anchor",href:"#frontmatter-title-관련"},b={class:"table-of-contents"},y=n("hr",null,null,-1),I=e('<h2 id="project-16-part-5" tabindex="-1"><a class="header-anchor" href="#project-16-part-5"><span>Project 16, part 5</span></a></h2><p>There’s a classic computer science book called <em>Structure and Interpretation of Computer Programs</em>, and in the preface the authors write some important words: “programs must be written for people to read, and only incidentally for machines to execute.”</p><p>It’s worth reading that a few times, because it has a massive impact on the way we write software. Why do we force ourselves to use data types when languages such as JavaScript let you mix and match strings, integers, and even arrays freely? Why do we add comments to our code? Why do we try to break things up into functions? Why do we have access control?</p><p>All those and many more can be answered by that single quote: because our goal must always be to make our intent clear to ourselves and other developers. The CPU running our code doesn’t care about data types, comments, access control, and more, but if you want to write great software that is scalable, testable, and maintainable, you need to add some rules.</p><p>So, perhaps today try and think a little more about the way you write your code – would adding some more comments help you remember a topic in a few months? Writing good comments is as much of a skill as writing good code!</p><p><strong>Today you have three topics to work through, in which you’ll write the “Me” tab, scan a QR code, add swipe actions to our app, and more.</strong></p><h3 id="generating-and-scaling-up-a-qr-code" tabindex="-1"><a class="header-anchor" href="#generating-and-scaling-up-a-qr-code"><span>Generating and scaling up a QR code</span></a></h3>',7),S={class:"hint-container details"},_=n("summary",null,"Generating and scaling up a QR code",-1),x=e(`<p>Core Image lets us generate a QR code from any input string, and do so extremely quickly. However, there’s a problem: the image it generates is very small because it’s only as big as the pixels required to show its data.</p><p>It’s trivial to make the QR code larger, but to make it look <em>good</em> we also need to adjust SwiftUI’s image interpolation. So, in this step we’re going to ask the user to enter their name and email address in a form, use those two pieces of information to generate a QR code identifying them, and scale up the code without making it fuzzy.</p><p>We already have a simple <code>MeView</code> struct that we made as a placeholder earlier, so our first job will be to add a couple of text fields and their string bindings.</p><p>First, add these two new pieces of state to hold a name and email address:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@AppStorage</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;name&quot;</span></span><span class="token punctuation">)</span> <span class="token keyword">private</span> <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;Anonymous&quot;</span></span></span>
<span class="line"><span class="token attribute atrule">@AppStorage</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;emailAddress&quot;</span></span><span class="token punctuation">)</span> <span class="token keyword">private</span> <span class="token keyword">var</span> emailAddress <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;you@yoursite.com&quot;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>When it comes to the body of the view we’re going to use two text fields with large fonts, but this time we’re going to attach a small but useful modifier to the text fields called <code>textContentType()</code> – it tells iOS what kind of information we’re asking the user for. This should allow iOS to provide autocomplete data on behalf of the user, which makes the app nicer to use.</p><p>Replace your current body with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">NavigationStack</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Form</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Name&quot;</span></span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> $name<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">textContentType</span><span class="token punctuation">(</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token class-name">TextField</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Email address&quot;</span></span><span class="token punctuation">,</span> text<span class="token punctuation">:</span> $emailAddress<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">textContentType</span><span class="token punctuation">(</span><span class="token punctuation">.</span>emailAddress<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">navigationTitle</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Your code&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We’re going to use the name and email address fields to generate a QR code, which is a square collection of black and white pixels that can be scanned by phones and other devices. Core Image has a filter for this built in, and as you’ve learned how to use Core Image filters previously you’ll find this is very similar.</p><p>First, we need to bring in all the Core Image filters using a new import:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token class-name">CoreImage</span><span class="token punctuation">.</span><span class="token class-name">CIFilterBuiltins</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Second, we need two properties to store an active Core Image context and an instance of Core Image’s QR code generator filter. So, add these two to <code>MeView</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> context <span class="token operator">=</span> <span class="token class-name">CIContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">let</span> filter <span class="token operator">=</span> <span class="token class-name">CIFilter</span><span class="token punctuation">.</span><span class="token function">qrCodeGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Now for the interesting part: making the QR code itself. If you remember, working with Core Image filters requires us to provide some input data, then convert the output CIImage into a <code>CGImage</code>, then that <code>CGImage</code> into a <code>UIImage</code>. We’ll be following the same steps here, except:</p><ol><li>Our input for the filter will be a string, but the input for the filter is <code>Data</code>, so we need to convert that.</li><li>If conversion fails for any reason we’ll send back the “xmark.circle” image from SF Symbols.</li><li>If <em>that</em> can’t be read – which is theoretically possible because SF Symbols is stringly typed – then we’ll send back an empty <code>UIImage</code>.</li></ol><p>So, add this method to the <code>MeView</code> struct now:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">generateQRCode</span><span class="token punctuation">(</span>from string<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">UIImage</span> <span class="token punctuation">{</span></span>
<span class="line">    filter<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token class-name">Data</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span>utf8<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">if</span> <span class="token keyword">let</span> outputImage <span class="token operator">=</span> filter<span class="token punctuation">.</span>outputImage <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token keyword">let</span> cgImage <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">createCGImage</span><span class="token punctuation">(</span>outputImage<span class="token punctuation">,</span> from<span class="token punctuation">:</span> outputImage<span class="token punctuation">.</span>extent<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token class-name">UIImage</span><span class="token punctuation">(</span>cgImage<span class="token punctuation">:</span> cgImage<span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">return</span> <span class="token class-name">UIImage</span><span class="token punctuation">(</span>systemName<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;xmark.circle&quot;</span></span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token class-name">UIImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Isolating all that functionality in a method works really well in SwiftUI, because it means the code we put in the <code>body</code> property stays as simple as possible. In fact, we can just use <code>Image(uiImage:)</code> directly with a call to <code>generateQRCode(from:)</code>, then scale it up to a sensible size onscreen – SwiftUI will make sure the method gets called every time <code>name</code> or <code>emailAddress</code> changes.</p><p>In terms of the string to pass <em>in</em> to <code>generateQRCode(from:)</code>, we’ll be using the name and email address entered by the user, separated by a line break. This is a nice and simple format, and it’s easy to reverse when it comes to scanning these codes later on.</p><p>Add this new <code>Image</code> view directly below the second text field:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Image</span><span class="token punctuation">(</span>uiImage<span class="token punctuation">:</span> <span class="token function">generateQRCode</span><span class="token punctuation">(</span>from<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;</span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">name</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">\\n</span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">emailAddress</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">resizable</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">scaledToFit</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>width<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If you run the code you’ll see it works pretty well – you’ll see a default QR code, but you can also type into either of the two text fields to make the QR code change dynamically.</p><p>However, take a close look at the QR code – do you notice how it’s fuzzy? This is because Core Image is generating a tiny image, and SwiftUI is trying to smooth out the pixels as we scale it up.</p><p>Line art like QR codes and bar codes is a great candidate for disabling image interpolation. Try adding this modifier to the image to see what I mean:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token punctuation">.</span><span class="token function">interpolation</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token keyword">none</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Now the QR code will be rendered nice and sharp, because SwiftUI will just repeat pixels rather than try to blend them neatly. I would imagine cameras don’t care which gets used, but it looks better to users!</p>`,26),q=n("h3",{id:"scanning-qr-codes-with-swiftui",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#scanning-qr-codes-with-swiftui"},[n("span",null,"Scanning QR codes with SwiftUI")])],-1),C={class:"hint-container details"},R=n("summary",null,"Scanning QR codes with SwiftUI",-1),j=n("p",null,"Scanning a QR code – or indeed any kind of visible code such as barcodes – can be done by Apple’s AVFoundation library. This doesn’t integrate into SwiftUI terribly smoothly, so to skip over a whole lot of pain I’ve packaged up a QR code reader into a Swift package that we can add and use directly inside Xcode.",-1),T={href:"https://github.com/twostraws/CodeScanner",target:"_blank",rel:"noopener noreferrer"},U=n("code",null,"twostraws/CodeScanner",-1),Q=n("code",null,"[File]",-1),A=n("code",null,"[Add Package Dependencies]",-1),D={href:"https://github.com/twostraws/CodeScanner",target:"_blank",rel:"noopener noreferrer"},P=n("code",null,"twostraws/CodeScanner",-1),V=n("li",null,"For the version rules, leave “Up to Next Major” selected, which means you’ll get any bug fixes and additional features but not any breaking changes.",-1),W=n("li",null,"Press Add Package to import the finished package into your project.",-1),B=e(`<p>The CodeScanner package gives us one <code>CodeScannerView</code> SwiftUI view to use, which can be presented in a sheet and handle code scanning in a clean, isolated way. I know I keep repeating myself, but I hope you can see the continuing theme: the best way to write SwiftUI is to isolate functionality in discrete methods and wrappers, so that all you expose to your SwiftUI layouts is clean, clear, and unambiguous.</p><p>We already have a “Scan” button in <code>ProspectsView</code>, and we’re going to use that trigger QR scanning. So, start by adding this new <code>@State</code> property to <code>ProspectsView</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> isShowingScanner <span class="token operator">=</span> <span class="token boolean">false</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Earlier we added some test functionality to the “Scan” button so we could insert some sample data, but we don’t need that any more because we’re about to scan real QR codes. So, replace the action code for the toolbar button with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line">isShowingScanner <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>When it comes to handling the result of the QR scanning, I’ve made the CodeScanner package do literally all the work of figuring out what the code is and how to send it back, so all we need to do here is catch the result and process it somehow.</p><p>When the <code>CodeScannerView</code> finds a code, it will call a completion closure with a <code>Result</code> instance either containing details about the code that was found or an error saying what the problem was – perhaps the camera wasn’t available, or the camera wasn’t able to scan codes, for example. Regardless of what code or error comes back, we’re just going to dismiss the view; we’ll add more code shortly to do more work.</p>`,7),F=n("code",null,"ProspectsView.swift",-1),N=e(`<div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token class-name">CodeScanner</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Now add this method to <code>ProspectsView</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">handleScan</span><span class="token punctuation">(</span>result<span class="token punctuation">:</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">ScanResult</span><span class="token punctuation">,</span> <span class="token class-name">ScanError</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">   isShowingScanner <span class="token operator">=</span> <span class="token boolean">false</span></span>
<span class="line">   <span class="token comment">// more code to come</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Before we show the scanner and try to handle its result, we need to ask the user for permission to use the camera:</p>`,4),G=n("li",null,"Go to your target’s configuration options under its Info tab.",-1),M=n("li",null,"Right-click on an existing key and select Add Row.",-1),z=n("code",null,"[“Privacy - Camera Usage Description”]",-1),E=n("li",null,"For the value enter “We need to scan QR codes.”",-1),L=e(`<p>And now we’re ready to scan some QR codes! We already have the <code>isShowingScanner</code> state that determines whether to show a code scanner or not, so we can now attach a <code>sheet()</code> modifier to present our scanner UI.</p><p>Creating a <code>CodeScannerView</code> takes at least three parameters:</p><ol><li>An array of the types of codes we want to scan. We’re only scanning QR codes in this app so <code>[.qr]</code> is fine, but iOS supports lots of other types too.</li><li>A string to use as simulated data. Xcode’s simulator doesn’t support using the camera to scan codes, so <code>CodeScannerView</code> automatically presents a replacement UI so we can still test that things work. This replacement UI will automatically send back whatever we pass in as simulated data.</li><li>A completion function to use. This could be a closure, but we just wrote the <code>handleScan()</code> method so we’ll use that.</li></ol><p>So, add this below the existing <code>toolbar()</code> modifier in <code>ProspectsView</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token punctuation">.</span><span class="token function">sheet</span><span class="token punctuation">(</span>isPresented<span class="token punctuation">:</span> $isShowingScanner<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">CodeScannerView</span><span class="token punctuation">(</span>codeTypes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">.</span>qr<span class="token punctuation">]</span><span class="token punctuation">,</span> simulatedData<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Paul Hudson\\npaul@hackingwithswift.com&quot;</span></span><span class="token punctuation">,</span> completion<span class="token punctuation">:</span> handleScan<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That’s enough to get most of this screen working, but there is one last step: replacing the <code>// more code to come</code> comment in <code>handleScan()</code> with some actual functionality to process the data we found.</p><p>If you recall, the QR codes we’re generating are a name, then a line break, then an email address, so if our scanning result comes back successfully then we can pull apart the code string into those components and use them to create a new <code>Prospect</code>. If code scanning failed, we’ll just print an error – you’re welcome to show some more interesting UI if you want!</p><p>Replace the <code>// more code to come</code> comment with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">switch</span> result <span class="token punctuation">{</span></span>
<span class="line"><span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token keyword">let</span> result<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token keyword">let</span> details <span class="token operator">=</span> result<span class="token punctuation">.</span>string<span class="token punctuation">.</span><span class="token function">components</span><span class="token punctuation">(</span>separatedBy<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;\\n&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">guard</span> details<span class="token punctuation">.</span>count <span class="token operator">==</span> <span class="token number">2</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token class-name">Prospect</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> details<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> emailAddress<span class="token punctuation">:</span> details<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> isContacted<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    modelContext<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">case</span> <span class="token punctuation">.</span><span class="token function">failure</span><span class="token punctuation">(</span><span class="token keyword">let</span> error<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Scanning failed: </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">error<span class="token punctuation">.</span>localizedDescription</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Go ahead and run the code now. If you’re using the simulator you’ll see a test UI appear, and tapping anywhere will dismiss the view and send back our simulated data.</p><p>If you’re using a real device you’ll see a permission message asking the user to allow camera use, and you grant that you’ll see a scanner view. To test out scanning on a real device, simultaneously launch the app in the simulator and switch to the Me tab – your phone should be able to scan the simulator screen on your computer.</p>`,11),O=n("h3",{id:"adding-options-with-swipe-actions",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#adding-options-with-swipe-actions"},[n("span",null,"Adding options with swipe actions")])],-1),H={class:"hint-container details"},$=n("summary",null,"Adding options with swipe actions",-1),K=e(`<p>We need a way to move people between the Contacted and Uncontacted tabs, and the easiest thing to do is add a swipe action to the <code>VStack</code> in <code>ProspectsView</code>. This will allow users to swipe on any person in the list, then tap a single option to move them between the tabs.</p><p>Now, remember that this view is shared in three places, so we need to make sure the swipe actions look correct no matter where it’s used. We <em>could</em> try and use a bunch of ternary conditional operators, but later on we’ll add a second button so the ternary operator approach won’t really help much. Instead, we’ll just wrap the button inside a simple condition – add this to the <code>VStack</code> now:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token punctuation">.</span>swipeActions <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> prospect<span class="token punctuation">.</span>isContacted <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Mark Uncontacted&quot;</span></span><span class="token punctuation">,</span> systemImage<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;person.crop.circle.badge.xmark&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            prospect<span class="token punctuation">.</span>isContacted<span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">tint</span><span class="token punctuation">(</span><span class="token punctuation">.</span>blue<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Mark Contacted&quot;</span></span><span class="token punctuation">,</span> systemImage<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;person.crop.circle.fill.badge.checkmark&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            prospect<span class="token punctuation">.</span>isContacted<span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">.</span><span class="token function">tint</span><span class="token punctuation">(</span><span class="token punctuation">.</span>green<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Thanks to SwiftUI and SwiftData&#39;s tight integration, just calling <code>toggle()</code> on our property will flip the Boolean, update our view, and save the change to permanent storage – all in just one line of code.</p><p>If you run the app now you’ll see it works great now – scan a user, then bring up the context menu and tap its action to see the user move between the Contacted and Uncontacted tabs.</p><p>Now, swipe actions are a great feature for adding extra functionality to your SwiftUI app, but they <em>don&#39;t</em> play nicely with the <code>onDelete()</code> modifier we used previously. So, we need to make deletion work by hand, and we&#39;re going to do this in two ways at the same time: individual swipe to delete like we had with <code>onDelete()</code>, but also a multiple selection mode that lets users remove many entries at the same time.</p><p>Getting a swipe to delete equivalent is straightforward, because we can just add another button to our existing swipe actions. Make sure and add this <em>first</em> in the list of buttons, so that it automatically gets the &quot;swipe fully to activate&quot; functionality:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Delete&quot;</span></span><span class="token punctuation">,</span> systemImage<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;trash&quot;</span></span><span class="token punctuation">,</span> role<span class="token punctuation">:</span> <span class="token punctuation">.</span>destructive<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    modelContext<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>prospect<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Tip: When used by itself, the regular swipe to delete action uses the word &quot;Delete&quot; rather than a trash icon, but when used alongside other swipe actions Apple prefers to add the icon to avoid mixing icons and words.</p><p>The second approach we&#39;ll add is to let users select multiple rows at the same time and delete them in one go. That means adding some new local state to store their active selection:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> selectedProspects <span class="token operator">=</span> <span class="token class-name">Set</span><span class="token operator">&lt;</span><span class="token class-name">Prospect</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Then binding that selection to our list:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">List</span><span class="token punctuation">(</span>prospects<span class="token punctuation">,</span> selection<span class="token punctuation">:</span> $selectedProspects<span class="token punctuation">)</span> <span class="token punctuation">{</span> prospect <span class="token keyword">in</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Important: To help SwiftUI understand that each row in our <code>List</code> corresponds to a single prospect, it&#39;s important to add the following code after the swipe actions:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token punctuation">.</span><span class="token function">tag</span><span class="token punctuation">(</span>prospect<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Now we just need to decide what kind of UI to build to make selection and deletion possible. There are a few different options here, and of course you&#39;re welcome to experiment, but I think the easiest is to show an edit button the top-leading part of our navigation bar, which is where it normally lives in Apple&#39;s own apps. We can then activate mass deletion by adding a second button, and Apple usually has <em>that</em> button in a special toolbar at the bottom.</p><p>First, we need a method to call that will delete all the rows we selected:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">for</span> prospect <span class="token keyword">in</span> selectedProspects <span class="token punctuation">{</span></span>
<span class="line">        modelContext<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>prospect<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>And now we can add two new toolbar items to the existing <code>toolbar()</code> modifier, one to create the edit button:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">ToolbarItem</span><span class="token punctuation">(</span>placement<span class="token punctuation">:</span> <span class="token punctuation">.</span>topBarLeading<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">EditButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>And then another one to create the delete button, but only when there are actually selections to delete:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">if</span> selectedProspects<span class="token punctuation">.</span>isEmpty <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">ToolbarItem</span><span class="token punctuation">(</span>placement<span class="token punctuation">:</span> <span class="token punctuation">.</span>bottomBar<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Delete Selected&quot;</span></span><span class="token punctuation">,</span> action<span class="token punctuation">:</span> delete<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>With that in place we&#39;re giving users two ways to access the same thing: the regular swipe to delete they expect to see, but also a clear Edit/Done button to aid discoverability.</p><p><strong>Important</strong>: Now that we&#39;re using <code>ToolbarItem</code> in our toolbar, you need to wrap the previous code in a <code>ToolbarItem</code> too, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">ToolbarItem</span><span class="token punctuation">(</span>placement<span class="token punctuation">:</span> <span class="token punctuation">.</span>topBarTrailing<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Scan&quot;</span></span><span class="token punctuation">,</span> systemImage<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;qrcode.viewfinder&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        isShowingScanner <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now go ahead and run the app – you should be able to add and delete prospects freely!</p>`,26),X=n("hr",null,null,-1);function Z(d,J){const o=r("router-link"),i=r("VPCard"),u=r("VidStack"),t=r("FontIcon");return w(),m("div",null,[n("h1",f,[n("a",v,[n("span",null,k(d.$frontmatter.title)+" 관련",1)])]),n("nav",b,[n("ul",null,[n("li",null,[s(o,{to:"#project-16-part-5"},{default:p(()=>[a("Project 16, part 5")]),_:1}),n("ul",null,[n("li",null,[s(o,{to:"#generating-and-scaling-up-a-qr-code"},{default:p(()=>[a("Generating and scaling up a QR code")]),_:1})]),n("li",null,[s(o,{to:"#scanning-qr-codes-with-swiftui"},{default:p(()=>[a("Scanning QR codes with SwiftUI")]),_:1})]),n("li",null,[s(o,{to:"#adding-options-with-swipe-actions"},{default:p(()=>[a("Adding options with swipe actions")]),_:1})])])])])]),y,s(i,c(l({title:"100 Days of SwiftUI - Day 83",desc:"Project 16, part 5",link:"https://www.hackingwithswift.com/100/swiftui/83",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),I,n("details",S,[_,s(i,c(l({title:"100 Days of SwiftUI - Day 83 - Generating and scaling up a QR code",desc:"Generating and scaling up a QR code",link:"https://hackingwithswift.com/books/ios-swiftui/generating-and-scaling-up-a-qr-code",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),s(u,{src:"youtube/OTjSpxqbeBI"}),x]),q,n("details",C,[R,s(i,c(l({title:"100 Days of SwiftUI - Day 83 - Scanning QR codes with SwiftUI",desc:"Scanning QR codes with SwiftUI",link:"https://hackingwithswift.com/books/ios-swiftui/scanning-qr-codes-with-swiftui",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),s(u,{src:"youtube/g06t8LP7zrQ"}),j,n("p",null,[a("My package is called CodeScanner, and it's available on GitHub under the MIT license at "),n("a",T,[s(t,{icon:"iconfont icon-github"}),U]),a(" – you’re welcome to inspect and/or edit the source code if you want. Here, though, we’re just going to add it to Xcode by following these steps:")]),n("ol",null,[n("li",null,[a("Go to "),s(t,{icon:"iconfont icon-select"}),Q,a(" > "),A,a(".")]),n("li",null,[a("Enter "),n("a",D,[s(t,{icon:"iconfont icon-github"}),P]),a(" as the package repository URL.")]),V,W]),B,n("p",null,[a("Start by adding this new import near the top of "),s(t,{icon:"fa-brands fa-swift"}),F,a(":")]),N,n("ol",null,[G,M,n("li",null,[a("Select "),s(t,{icon:"iconfont icon-select"}),z,a(" for the key.")]),E]),L]),O,n("details",H,[$,s(i,c(l({title:"100 Days of SwiftUI - Day 83 - Adding options with swipe actions",desc:"Adding options with swipe actions",link:"https://hackingwithswift.com/books/ios-swiftui/adding-options-with-swipe-actions",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),s(u,{src:"youtube/9TkzkAMq6-o"}),K]),X])}const sn=h(g,[["render",Z],["__file","83.html.vue"]]),an=JSON.parse('{"path":"/swift/100-days-of-swiftui/83.html","title":"Day 83","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Day 83","description":"100 Days of SwiftUI > Day 83","category":["Swift"],"tag":["crashcourse","paul-hudson","swift","swiftui","hacking-with-swift","xcode","appstore"],"head":[[{"meta":null},{"property":"og:title","content":"100 Days of SwiftUI > Day 83"},{"property":"og:description","content":"Day 83"},{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/swift/100-days-of-swiftui/83.html"}],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/crashcourse/swift/100-days-of-swiftui/83.html"}],["meta",{"property":"og:site_name","content":"🥁Crashcourse"}],["meta",{"property":"og:title","content":"Day 83"}],["meta",{"property":"og:description","content":"100 Days of SwiftUI > Day 83"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"og:updated_time","content":"2024-10-03T01:20:13.000Z"}],["meta",{"property":"article:tag","content":"crashcourse"}],["meta",{"property":"article:tag","content":"paul-hudson"}],["meta",{"property":"article:tag","content":"swift"}],["meta",{"property":"article:tag","content":"swiftui"}],["meta",{"property":"article:tag","content":"hacking-with-swift"}],["meta",{"property":"article:tag","content":"xcode"}],["meta",{"property":"article:tag","content":"appstore"}],["meta",{"property":"article:modified_time","content":"2024-10-03T01:20:13.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Day 83\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-10-03T01:20:13.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"Project 16, part 5","slug":"project-16-part-5","link":"#project-16-part-5","children":[{"level":3,"title":"Generating and scaling up a QR code","slug":"generating-and-scaling-up-a-qr-code","link":"#generating-and-scaling-up-a-qr-code","children":[]},{"level":3,"title":"Scanning QR codes with SwiftUI","slug":"scanning-qr-codes-with-swiftui","link":"#scanning-qr-codes-with-swiftui","children":[]},{"level":3,"title":"Adding options with swipe actions","slug":"adding-options-with-swipe-actions","link":"#adding-options-with-swipe-actions","children":[]}]}],"git":{"createdTime":1708602914000,"updatedTime":1727918413000,"contributors":[{"name":"chanhi2000","email":"chanhi2000@gmail.com","commits":6}]},"readingTime":{"minutes":10.17,"words":3050},"filePathRelative":"swift/100-days-of-swiftui/83.md","localizedDate":"2024년 2월 22일","excerpt":"\\n\\n<hr>\\n"}');export{sn as comp,an as data};

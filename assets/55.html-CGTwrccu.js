import{_ as d}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as k,a as n,t as h,b as s,w as o,n as i,g as p,e as l,d as a,r,o as m}from"./app-U_bew1in.js";const w={},g={id:"frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´",tabindex:"-1"},v={class:"header-anchor",href:"#frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´"},f={class:"table-of-contents"},b=n("hr",null,null,-1),y=n("h2",{id:"project-11-part-3",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#project-11-part-3"},[n("span",null,"Project 11, part 3")])],-1),S=l('<p>As we finish our app today, I hope you‚Äôre able to stop and realize just how much SwiftUI you already know. For example, to build the detail screen for our app will leverage SwiftData, <code>VStack</code> and <code>ZStack</code>, clip shapes, spacers, and more ‚Äì things you should now be more than comfortable with, which shows how far you have come.</p><p>Still, there are always new things to learn, which today will include how to delete SwiftData objects, how to sort queries using <code>SortDescriptor</code>, and how to add custom buttons to alerts. As the American philosopher Vernon Howard said, ‚ÄúAlways walk through life as if you have something new to learn, and you will‚Äù ‚Äì I drop in these small extra things into projects to keep you on your toes, but going over the old stuff is often just as important!</p><p><strong>Today you have three topics to work through, in which you‚Äôll upgrade your app to support sorting, deleting, and more.</strong></p><h3 id="showing-book-details" tabindex="-1"><a class="header-anchor" href="#showing-book-details"><span>Showing book details</span></a></h3>',4),D={class:"hint-container details"},_=n("summary",null,"Showing book details",-1),x=l(`<p>When the user taps a book in <code>ContentView</code> we‚Äôre going to present a detail view with some more information ‚Äì the genre of the book, their brief review, and more. We‚Äôre also going to reuse our new <code>RatingView</code>, and even customize it so you can see just how flexible SwiftUI is.</p><p>To make this screen more interesting, we‚Äôre going to add some artwork that represents each category in our app. I‚Äôve picked out some artwork already from Unsplash, and placed it into the project11-files folder for this book ‚Äì if you haven‚Äôt downloaded them, please do so now and then drag them into your asset catalog.</p><p>Unsplash has a license that allows us to use pictures commercially or non-commercially, with or without attribution, although attribution is appreciated. The pictures I‚Äôve added are by Ryan Wallace, Eugene Triguba, Jamie Street, Alvaro Serrano, Joao Silas, David Dilbert, and Casey Horner ‚Äì you can get the originals from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">https://unsplash.com</a> if you want.</p><p>Next, create a new SwiftUI view called ‚ÄúDetailView‚Äù, then give it an import for SwiftData. This new view only needs one property, which is the book it should show, so please add that now:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> book<span class="token punctuation">:</span> <span class="token class-name">Book</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Even just having that property is enough to break the preview code at the bottom of DetailView.swift. Previously this was easy to fix because we just sent in an example object, but with SwiftData involved things are messier: creating a new book also means having a view context to create it inside.</p><p>This is the first thing that&#39;s actually tricky in SwiftData; we need to get things exactly right in order for it to work:</p><ol><li>In order to create a sample <code>Book</code> object, we must first create a model context.</li><li>That model context comes from creating a model container.</li><li>If we create a model container, we <em>don&#39;t</em> want it to actually store anything, so we can create a custom configuration that tells SwiftData to store its information in memory only. That means everything is temporary.</li></ol><p>I know that sounds a lot, but in practice it&#39;s only a few lines of code ‚Äì we need to make our model container by hand, and do so using a new type called <code>ModelConfiguration</code> that lets us request temporary in-memory storage. Once we have that, we can create a <code>Book</code> object as normal, then send it into <code>DetailView</code> along with the model container itself.</p><p>Replace your current preview code with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token other-directive property">#Preview</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">do</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">let</span> config <span class="token operator">=</span> <span class="token class-name">ModelConfiguration</span><span class="token punctuation">(</span>isStoredInMemoryOnly<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">let</span> container <span class="token operator">=</span> <span class="token keyword">try</span> <span class="token class-name">ModelContainer</span><span class="token punctuation">(</span><span class="token keyword">for</span><span class="token punctuation">:</span> <span class="token class-name">Book</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">,</span> configurations<span class="token punctuation">:</span> config<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">let</span> example <span class="token operator">=</span> <span class="token class-name">Book</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Test Book&quot;</span></span><span class="token punctuation">,</span> author<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Test Author&quot;</span></span><span class="token punctuation">,</span> genre<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Fantasy&quot;</span></span><span class="token punctuation">,</span> review<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;This was a great book; I really enjoyed it.&quot;</span></span><span class="token punctuation">,</span> rating<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">return</span> <span class="token class-name">DetailView</span><span class="token punctuation">(</span>book<span class="token punctuation">:</span> example<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">modelContainer</span><span class="token punctuation">(</span>container<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Failed to create preview: </span><span class="token interpolation-punctuation punctuation">\\(</span><span class="token interpolation">error<span class="token punctuation">.</span>localizedDescription</span><span class="token interpolation-punctuation punctuation">)</span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Yes, creating the <code>Book</code> instance doesn&#39;t actually mention the model container or configuration anywhere, but it does matter: trying to create a SwiftData model object without a container around is likely to make your code crash.</p><p>With that done we can turn our attention to more interesting problems, namely designing the view itself. To start with, we‚Äôre going to place the category image and genre inside a <code>ZStack</code>, so we can put one on top of the other nicely. I‚Äôve picked out some styling that I think looks good, but you‚Äôre welcome to experiment with the styling all you want ‚Äì the only thing I‚Äôd recommend you definitely keep is the <code>ScrollView</code>, which ensures our review will fit fully onto the screen no matter how long it is, what device the user has, or whether they have adjusted their font sizes or not.</p><p>Replace the current <code>body</code> property with this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">ScrollView</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">ZStack</span><span class="token punctuation">(</span>alignment<span class="token punctuation">:</span> <span class="token punctuation">.</span>bottomTrailing<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">Image</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>genre<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">resizable</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">scaledToFit</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token class-name">Text</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>genre<span class="token punctuation">.</span><span class="token function">uppercased</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>caption<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">fontWeight</span><span class="token punctuation">(</span><span class="token punctuation">.</span>black<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>white<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">background</span><span class="token punctuation">(</span><span class="token punctuation">.</span>black<span class="token punctuation">.</span><span class="token function">opacity</span><span class="token punctuation">(</span><span class="token number">0.75</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">clipShape</span><span class="token punctuation">(</span><span class="token punctuation">.</span>capsule<span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">.</span><span class="token function">navigationTitle</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>title<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">.</span><span class="token function">navigationBarTitleDisplayMode</span><span class="token punctuation">(</span><span class="token punctuation">.</span>inline<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">.</span><span class="token function">scrollBounceBehavior</span><span class="token punctuation">(</span><span class="token punctuation">.</span>basedOnSize<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That places the genre name in the bottom-right corner of the <code>ZStack</code>, with a background color, bold font, and a little padding to help it stand out.</p><p>Below that <code>ZStack</code> we‚Äôre going to add the author, review, and rating. We don‚Äôt want users to be able to adjust the rating here, so instead we can use another constant binding to turn this into a simple read-only view. Even better, because we used SF Symbols to create the rating image, we can scale them up seamlessly with a simple <code>font()</code> modifier, to make better use of all the space we have.</p><p>So, add these views directly below the previous <code>ZStack</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">Text</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>author<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">foregroundStyle</span><span class="token punctuation">(</span><span class="token punctuation">.</span>secondary<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name">Text</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>review<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name">RatingView</span><span class="token punctuation">(</span>rating<span class="token punctuation">:</span> <span class="token punctuation">.</span><span class="token function">constant</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>rating<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">font</span><span class="token punctuation">(</span><span class="token punctuation">.</span>largeTitle<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That completes <code>DetailView</code>, so we can head back to ContentView.swift to add a navigation destination to the List view:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token punctuation">.</span><span class="token function">navigationDestination</span><span class="token punctuation">(</span><span class="token keyword">for</span><span class="token punctuation">:</span> <span class="token class-name">Book</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> book <span class="token keyword">in</span></span>
<span class="line">    <span class="token class-name">DetailView</span><span class="token punctuation">(</span>book<span class="token punctuation">:</span> book<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now run the app again, because you should be able to tap any of the books you‚Äôve entered to show them in our new detail view.</p>`,22),j=n("h3",{id:"sorting-swiftdata-queries-using-sortdescriptor",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#sorting-swiftdata-queries-using-sortdescriptor"},[n("span",null,[a("Sorting SwiftData queries using "),n("code",null,"SortDescriptor")])])],-1),q={class:"hint-container details"},T=n("summary",null,"Sorting SwiftData queries using SortDescriptor",-1),B=l(`<p>When you use <code>@Query</code> to pull objects out of SwiftData, you get to specify how you want the data to be sorted ‚Äì should it be alphabetically by one of the fields? Or numerically with the highest numbers first? Regardless of what you choose, it&#39;s always a good idea to choose <em>something</em> so your users have a predictable experience.</p><p>In this project we have various fields that might be useful for sorting purposes: the title of the book, the author, or the rating are all sensible and would be good choices, but we don&#39;t have to rely on just one ‚Äì you can specify multiple, so that you might ask for highest-rated books first, then use their names for a tiebreaker.</p><p>Query sorting can be done in two ways: a simple option that allows just one sort field, and a more advanced version that allows an array of a new type called <code>SortDescriptor</code>.</p><p>Using the simple version, we might ask for our books to be provided in alphabetical order based on their title:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@Query</span><span class="token punctuation">(</span>sort<span class="token punctuation">:</span> <span class="token punctuation">\\</span><span class="token class-name">Book</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span> <span class="token keyword">var</span> books<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Book</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Or we could ask for them to be sorted by rating, highest to lowest:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@Query</span><span class="token punctuation">(</span>sort<span class="token punctuation">:</span> <span class="token punctuation">\\</span><span class="token class-name">Book</span><span class="token punctuation">.</span>rating<span class="token punctuation">,</span> order<span class="token punctuation">:</span> <span class="token punctuation">.</span>reverse<span class="token punctuation">)</span> <span class="token keyword">var</span> books<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Book</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>That works well when you want just one single field, but generally I&#39;d say it&#39;s a better idea to have a backup field too ‚Äì to say &quot;sort by rating, then by title&quot; adds an extra level of predictability to your app, which is always a good thing.</p><p>This is done using the <code>SortDescriptor</code> type, which we can create them from either one or two values: the property we want to sort on, and optionally whether it should be reversed or not. For example, we can alphabetically sort on the title property like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@Query</span><span class="token punctuation">(</span>sort<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">SortDescriptor</span><span class="token punctuation">(</span><span class="token punctuation">\\</span><span class="token class-name">Book</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">var</span> books<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Book</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Like the simpler approach to sorting, sorting results using <code>SortDescriptor</code> is done in ascending order by default, meaning alphabetical order for text, but if you wanted to <em>reverse</em> the sort order you‚Äôd use this instead:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@Query</span><span class="token punctuation">(</span>sort<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">SortDescriptor</span><span class="token punctuation">(</span><span class="token punctuation">\\</span><span class="token class-name">Book</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span> order<span class="token punctuation">:</span> <span class="token punctuation">.</span>reverse<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">var</span> books<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Book</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>You can specify more than one sort descriptor, and they will be applied in the order you provide them. For example, if the user added the book ‚ÄúForever‚Äù by Pete Hamill, then added ‚ÄúForever‚Äù by Judy Blume ‚Äì an entirely different book that just happens to have the same title ‚Äì then specifying a second sort field is helpful.</p><p>So, we might ask for book title to be sorted ascending first, followed by book author ascending second, like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@Query</span><span class="token punctuation">(</span>sort<span class="token punctuation">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token class-name">SortDescriptor</span><span class="token punctuation">(</span><span class="token punctuation">\\</span><span class="token class-name">Book</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token class-name">SortDescriptor</span><span class="token punctuation">(</span><span class="token punctuation">\\</span><span class="token class-name">Book</span><span class="token punctuation">.</span>author<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">var</span> books<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token class-name">Book</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Having a second or even third sort field has little to no performance impact unless you have lots of data with similar values. With our books data, for example, almost every book will have a unique title, so having a secondary sort field is more or less irrelevant in terms of performance.</p>`,16),I=n("h3",{id:"deleting-from-a-swiftdata-query",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#deleting-from-a-swiftdata-query"},[n("span",null,"Deleting from a SwiftData query")])],-1),V={class:"hint-container details"},C=n("summary",null,"Deleting from a SwiftData query",-1),U=l(`<p>We already used <code>@Query</code> to place SwiftData objects into a SwiftUI <code>List</code>, and with only a little more work we can enable both swipe to delete and a dedicated Edit/Done button.</p><p>Just as with regular arrays of data, most of the work is done by attaching an <code>onDelete(perform:)</code> modifier to <code>ForEach</code>, but rather than just removing items from an array we instead need to find the requested object in our query then use it to call <code>delete()</code> on our model context. Once all the objects are deleted, SwiftData&#39;s autosave system will kick in and apply the changes permanently.</p><p>So, start by adding this method to <code>ContentView</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">deleteBooks</span><span class="token punctuation">(</span>at offsets<span class="token punctuation">:</span> <span class="token class-name">IndexSet</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">for</span> offset <span class="token keyword">in</span> offsets <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// find this book in our query</span></span>
<span class="line">        <span class="token keyword">let</span> book <span class="token operator">=</span> books<span class="token punctuation">[</span>offset<span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// delete it from the context</span></span>
<span class="line">        modelContext<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We can trigger that by adding an <code>onDelete(perform:)</code> modifier to the <code>ForEach</code> of <code>ContentView</code>, but remember: it needs to go on the <code>ForEach</code> and <em>not</em> the <code>List</code>.</p><p>Add this modifier now:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token punctuation">.</span><span class="token function">onDelete</span><span class="token punctuation">(</span>perform<span class="token punctuation">:</span> deleteBooks<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>That gets us swipe to delete, and we can go one better by adding an Edit/Done button too. Find the <code>toolbar()</code> modifier in <code>ContentView</code>, and add another <code>ToolbarItem</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token class-name">ToolbarItem</span><span class="token punctuation">(</span>placement<span class="token punctuation">:</span> <span class="token punctuation">.</span>topBarLeading<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">EditButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That completes <code>ContentView</code>, so try running the app ‚Äì you should be able to add and delete books freely now, and can delete by using swipe to delete or using the edit button.</p>`,10),A=n("h3",{id:"using-an-alert-to-pop-a-navigationlink-programmatically",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#using-an-alert-to-pop-a-navigationlink-programmatically"},[n("span",null,[a("Using an alert to pop a "),n("code",null,"NavigationLink"),a(" programmatically")])])],-1),N={class:"hint-container details"},F=n("summary",null,"Using an alert to pop a NavigationLink programmatically",-1),P=l(`<p>You‚Äôve already seen how <code>NavigationLink</code> lets us push to a detail screen, which might be a custom view or one of SwiftUI‚Äôs built-in types such as <code>Text</code> or <code>Image</code>. Because we‚Äôre inside a <code>NavigationStack</code>, iOS automatically provides a ‚ÄúBack‚Äù button to let users get back to the previous screen, and they can also swipe from the left edge to go back. However, sometimes it‚Äôs useful to programmatically go back ‚Äì i.e., to move back to the previous screen when we want rather than when the user swipes.</p><p>We&#39;ve looked at this before, so hopefully this is just good practice for you: we‚Äôre going to add one last feature to our app that deletes whatever book the user is currently looking at. To do this we need to show an alert asking the user if they really want to delete the book, then delete the book from the current model context if that‚Äôs what they want. Once that‚Äôs done, there‚Äôs no point staying on the current screen because its associated book doesn‚Äôt exist any more, so we‚Äôre going to pop the current view ‚Äì remove it from the top of the <code>NavigationStack</code> stack, so we move back to the previous screen.</p><p>First, we need three new properties in our <code>DetailView</code> struct: one to hold our SwiftData model context (so we can delete stuff), one to hold our dismiss action (so we can pop the view off the navigation stack), and one to control whether we‚Äôre showing the delete confirmation alert or not.</p><p>So, start by adding these three new properties to <code>DetailView</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token attribute atrule">@Environment</span><span class="token punctuation">(</span><span class="token punctuation">\\</span><span class="token punctuation">.</span>modelContext<span class="token punctuation">)</span> <span class="token keyword">var</span> modelContext</span>
<span class="line"><span class="token attribute atrule">@Environment</span><span class="token punctuation">(</span><span class="token punctuation">\\</span><span class="token punctuation">.</span>dismiss<span class="token punctuation">)</span> <span class="token keyword">var</span> dismiss</span>
<span class="line"><span class="token attribute atrule">@State</span> <span class="token keyword">private</span> <span class="token keyword">var</span> showingDeleteAlert <span class="token operator">=</span> <span class="token boolean">false</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The second step is writing a method that deletes the current book from our model context, and dismisses the current view. It doesn‚Äôt matter that this view is being shown using a navigation link rather than a sheet ‚Äì we still use the same <code>dismiss()</code> code.</p><p>Add this method to <code>DetailView</code> now:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">deleteBook</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    modelContext<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span></span>
<span class="line">    <span class="token function">dismiss</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The third step is to add an <code>alert()</code> modifier that watches <code>showingDeleteAlert</code>, and asks the user to confirm the action. So far we‚Äôve been using simple alerts with a dismiss button, but here we need two buttons: one button to delete the book, and another to cancel. Both of these have specific button roles that automatically make them look correct, so we‚Äôll use those.</p><p>Apple provides very clear guidance on how we should label alert text, but it comes down to this: if it‚Äôs a simple ‚ÄúI understand‚Äù acceptance then ‚ÄúOK‚Äù is good, but if you want users to make a choice then you should avoid titles like ‚ÄúYes‚Äù and ‚ÄúNo‚Äù and instead use verbs such as ‚ÄúIgnore‚Äù, ‚ÄúReply‚Äù, and ‚ÄúConfirm‚Äù.</p><p>In this instance, we‚Äôre going to use ‚ÄúDelete‚Äù for the destructive button, then provide a cancel button next to it so users can back out of deleting if they want. So, add this modifier to the <code>ScrollView</code> in <code>DetailView</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Delete book&quot;</span></span><span class="token punctuation">,</span> isPresented<span class="token punctuation">:</span> $showingDeleteAlert<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Delete&quot;</span></span><span class="token punctuation">,</span> role<span class="token punctuation">:</span> <span class="token punctuation">.</span>destructive<span class="token punctuation">,</span> action<span class="token punctuation">:</span> deleteBook<span class="token punctuation">)</span></span>
<span class="line">    <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Cancel&quot;</span></span><span class="token punctuation">,</span> role<span class="token punctuation">:</span> <span class="token punctuation">.</span>cancel<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span> message<span class="token punctuation">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Are you sure?&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The final step is to add a toolbar item that starts the deletion process ‚Äì this just needs to flip the <code>showingDeleteAlert</code> Boolean, because our <code>alert()</code> modifier is already watching it. So, add this one last modifier to the <code>ScrollView</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token punctuation">.</span>toolbar <span class="token punctuation">{</span></span>
<span class="line">    <span class="token class-name">Button</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Delete this book&quot;</span></span><span class="token punctuation">,</span> systemImage<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;trash&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        showingDeleteAlert <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can now delete books in <code>ContentView</code> using swipe to delete or the edit button, or navigate into <code>DetailView</code> then tap the dedicated delete button in there ‚Äì it should delete the book, update the list in <code>ContentView</code>, then automatically dismiss the detail view.</p><p>That‚Äôs another app complete ‚Äì good job!</p>`,16),E=n("p",null,"That‚Äôs another app finished ‚Äì keep going!",-1),L=n("hr",null,null,-1);function R(u,W){const t=r("router-link"),e=r("VPCard"),c=r("VidStack");return m(),k("div",null,[n("h1",g,[n("a",v,[n("span",null,h(u.$frontmatter.title)+" Í¥ÄÎ†®",1)])]),n("nav",f,[n("ul",null,[n("li",null,[s(t,{to:"#project-11-part-3"},{default:o(()=>[a("Project 11, part 3")]),_:1}),n("ul",null,[n("li",null,[s(t,{to:"#showing-book-details"},{default:o(()=>[a("Showing book details")]),_:1})]),n("li",null,[s(t,{to:"#sorting-swiftdata-queries-using-sortdescriptor"},{default:o(()=>[a("Sorting SwiftData queries using SortDescriptor")]),_:1})]),n("li",null,[s(t,{to:"#deleting-from-a-swiftdata-query"},{default:o(()=>[a("Deleting from a SwiftData query")]),_:1})]),n("li",null,[s(t,{to:"#using-an-alert-to-pop-a-navigationlink-programmatically"},{default:o(()=>[a("Using an alert to pop a NavigationLink programmatically")]),_:1})])])])])]),b,y,s(e,i(p({title:"100 Days of SwiftUI - Day 55",desc:"Project 11, part 3",link:"https://www.hackingwithswift.com/100/swiftui/55",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),S,n("details",D,[_,s(e,i(p({title:"100 Days of SwiftUI - Day 55 - Showing book details",desc:"Showing book details",link:"https://www.hackingwithswift.com/books/ios-swiftui/showing-book-details",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),s(c,{src:"youtube/xI7El05optA"}),x]),j,n("details",q,[T,s(e,i(p({title:"100 Days of SwiftUI - Day 55 - Sorting SwiftData queries using SortDescriptor",desc:"Sorting SwiftData queries using SortDescriptor",link:"https://www.hackingwithswift.com/books/ios-swiftui/sorting-swiftdata-queries-using-sortdescriptor",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),s(c,{src:"youtube/xSw_ftbtSgM"}),B]),I,n("details",V,[C,s(e,i(p({title:"100 Days of SwiftUI - Day 55 - Deleting from a SwiftData query",desc:"Deleting from a SwiftData query",link:"https://www.hackingwithswift.com/books/ios-swiftui/deleting-from-a-swiftdata-query",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),s(c,{src:"youtube/K0TyIJpZHv8"}),U]),A,n("details",N,[F,s(e,i(p({title:"100 Days of SwiftUI - Day 55 - Using an alert to pop a NavigationLink programmatically",desc:"Using an alert to pop a NavigationLink programmatically",link:"https://www.hackingwithswift.com/books/ios-swiftui/using-an-alert-to-pop-a-navigationlink-programmatically",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(54,94,226,0.2)"})),null,16),s(c,{src:"youtube/rMS8UBcQxeI"}),P]),E,L])}const Q=d(w,[["render",R],["__file","55.html.vue"]]),z=JSON.parse('{"path":"/swift/100-days-of-swiftui/55.html","title":"Day 55","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Day 55","description":"100 Days of SwiftUI > Day 55","category":["Swift"],"tag":["crashcourse","paul-hudson","swift","swiftui","hacking-with-swift","xcode","appstore"],"head":[[{"meta":null},{"property":"og:title","content":"100 Days of SwiftUI > Day 55"},{"property":"og:description","content":"Day 55"},{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/swift/100-days-of-swiftui/55.html"}],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/crashcourse/swift/100-days-of-swiftui/55.html"}],["meta",{"property":"og:site_name","content":"ü•ÅCrashcourse"}],["meta",{"property":"og:title","content":"Day 55"}],["meta",{"property":"og:description","content":"100 Days of SwiftUI > Day 55"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"og:updated_time","content":"2024-10-03T01:20:13.000Z"}],["meta",{"property":"article:tag","content":"crashcourse"}],["meta",{"property":"article:tag","content":"paul-hudson"}],["meta",{"property":"article:tag","content":"swift"}],["meta",{"property":"article:tag","content":"swiftui"}],["meta",{"property":"article:tag","content":"hacking-with-swift"}],["meta",{"property":"article:tag","content":"xcode"}],["meta",{"property":"article:tag","content":"appstore"}],["meta",{"property":"article:modified_time","content":"2024-10-03T01:20:13.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Day 55\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-10-03T01:20:13.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"Project 11, part 3","slug":"project-11-part-3","link":"#project-11-part-3","children":[{"level":3,"title":"Showing book details","slug":"showing-book-details","link":"#showing-book-details","children":[]},{"level":3,"title":"Sorting SwiftData queries using SortDescriptor","slug":"sorting-swiftdata-queries-using-sortdescriptor","link":"#sorting-swiftdata-queries-using-sortdescriptor","children":[]},{"level":3,"title":"Deleting from a SwiftData query","slug":"deleting-from-a-swiftdata-query","link":"#deleting-from-a-swiftdata-query","children":[]},{"level":3,"title":"Using an alert to pop a NavigationLink programmatically","slug":"using-an-alert-to-pop-a-navigationlink-programmatically","link":"#using-an-alert-to-pop-a-navigationlink-programmatically","children":[]}]}],"git":{"createdTime":1703642364000,"updatedTime":1727918413000,"contributors":[{"name":"chanhi2000","email":"chanhi2000@gmail.com","commits":8}]},"readingTime":{"minutes":8.9,"words":2670},"filePathRelative":"swift/100-days-of-swiftui/55.md","localizedDate":"2023ÎÖÑ 12Ïõî 27Ïùº","excerpt":"\\n\\n<hr>\\n<h2>Project 11, part 3</h2>\\n"}');export{Q as comp,z as data};

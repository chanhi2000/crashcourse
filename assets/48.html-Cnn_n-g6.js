import{_ as u}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as h,a as e,t as k,b as s,w as o,n as i,g as c,e as l,d as a,r,o as g}from"./app-U_bew1in.js";const f={},y={id:"frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´",tabindex:"-1"},w={class:"header-anchor",href:"#frontmatter-title-·ÑÄ·Ö™·Ü´·ÑÖ·Öß·Ü´"},m={class:"table-of-contents"},b=e("hr",null,null,-1),v=l('<h2 id="project-12-part-one" tabindex="-1"><a class="header-anchor" href="#project-12-part-one"><span>Project 12, part one</span></a></h2><p>Douglas Adams once said, ‚Äúmost of the time spent wrestling with technologies that don&#39;t quite work yet is just not worth the effort for end users, however much fun it is for nerds like us.‚Äù And of course he was right: when software doesn‚Äôt quite work we sometimes see it as a challenge to find a workaround, whereas everyone else in the world just gets annoyed or gives up.</p><p>Think about how often you see a Save button in iOS. Hardly ever, right? This isn‚Äôt an accident: iOS makes it look like all apps are running all the time when really they get backgrounded or even terminated all the time, but users don‚Äôt want to have to think about saving files before a program is quit.</p><p>This behavior is a great example of how Apple takes away the annoyance for end users ‚Äì they don‚Äôt have to expend the effort of managing data or worrying about programs, which means they can instead focus on just using their device for the things they <em>actually</em> care about.</p><p>Now it falls to us. Project 10 worked great, except that it doesn‚Äôt save the pictures users add. Today you‚Äôre going to learn one of the ways we can fix that, and we‚Äôll look at a different option tomorrow.</p><p><strong>Today you have three topics to work through, and you‚Äôll learn about <code>UserDefaults</code>, <code>NSCoding</code> and more.</strong></p><h3 id="setting-up" tabindex="-1"><a class="header-anchor" href="#setting-up"><span>Setting up</span></a></h3>',7),j={class:"hint-container details"},S=e("summary",null,"Setting up",-1),D=l("<p>This is our fourth technique project, and we&#39;re going to go back to project 10 and fix its glaring bug: all the names and faces you add to the app don&#39;t get saved, which makes the app rather pointless!</p><p>We&#39;re going to fix this using a new class called <code>UserDefaults</code> and a new protocol <code>NSCoding</code> ‚Äì it‚Äôs similar in intent to the <code>Codable</code> protocol we used when working with JSON, but the former is available only to Swift developers whereas the latter is also available to Objective-C developers.</p><p>Along the way you‚Äôll also use the classes <code>NSKeyedArchiver</code> and <code>NSKeyedUnarchiver</code> (for use with <code>NSCoding</code>), and <code>JSONEncoder</code> and <code>JSONDecoder</code> (for use with <code>Codable</code>), all of which are there to convert custom objects into data that can be written to disk.</p><p>Putting all that together, we&#39;re going to update project 10 so that it saves its <code>people</code> array whenever anything is changed, then loads when the app runs.</p><p>We&#39;re going to be modifying project 10 twice over, once for each method of solving the problem, so I suggest you take a copy of the project 10 folder twice ‚Äì call the copies project12a and project12b.</p>",5),q=e("h3",{id:"reading-and-writing-basics-userdefaults",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#reading-and-writing-basics-userdefaults"},[e("span",null,[a("Reading and writing basics: "),e("code",null,"UserDefaults")])])],-1),_={class:"hint-container details"},x=e("summary",null,"Reading and writing basics: UserDefaults",-1),N=l(`<p>You can use <code>UserDefaults</code> to store any basic data type for as long as the app is installed. You can write basic types such as <code>Bool</code>, <code>Float</code>, <code>Double</code>, <code>Int</code>, <code>String</code>, or <code>URL</code>, but you can also write more complex types such as arrays, dictionaries and <code>Date</code> ‚Äì and even <code>Data</code> values.</p><p>When you write data to <code>UserDefaults</code>, it automatically gets loaded when your app runs so that you can read it back again. This makes using it really easy, but you need to know that it&#39;s a bad idea to store lots of data in there because it will slow loading of your app. If you think your saved data would take up more than say 100KB, <code>UserDefaults</code> is almost certainly the wrong choice.</p><p>Before we get into modifying project 10, we&#39;re going to do a little bit of test coding first to try out what <code>UserDefaults</code> lets us do. You might find it useful to create a fresh Single View App project just so you can test out the code.</p><p>To get started with <code>UserDefaults</code>, you create a new instance of the class like this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> defaults <span class="token operator">=</span> <span class="token class-name">UserDefaults</span><span class="token punctuation">.</span>standard</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Once that&#39;s done, it&#39;s easy to set a variety of values ‚Äì you just need to give each one a unique key so you can reference it later. These values nearly always have no meaning outside of what you use them for, so just make sure the key names are memorable.</p><p>Here are some examples:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> defaults <span class="token operator">=</span> <span class="token class-name">UserDefaults</span><span class="token punctuation">.</span>standard</span>
<span class="line">defaults<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Age&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">defaults<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;UseTouchID&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">defaults<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token class-name">CGFloat</span><span class="token punctuation">.</span>pi<span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Pi&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can also use the <code>set()</code> to store strings, arrays, dictionaries and dates. Now, here&#39;s a curiosity that&#39;s worth explaining briefly: in Swift, strings, arrays and dictionaries are all structs, not objects. But <code>UserDefaults</code> was written for <code>NSString</code> and friends ‚Äì all of which are 100% interchangeable with Swift their equivalents ‚Äì which is why this code works.</p><p>Using <code>set()</code> for these advanced types is just the same as using the other data types:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line">defaults<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;Paul Hudson&quot;</span></span><span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Name&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">defaults<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;LastRun&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Even if you&#39;re trying to save complex types such as arrays and dictionaries, <code>UserDefaults</code> laps it up:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;Hello&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;World&quot;</span></span><span class="token punctuation">]</span></span>
<span class="line">defaults<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;SavedArray&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">let</span> dict <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;Name&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;Paul&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;Country&quot;</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;UK&quot;</span></span><span class="token punctuation">]</span></span>
<span class="line">defaults<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>dict<span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;SavedDict&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>That&#39;s enough about writing for now; let&#39;s take a look at reading.</p><p>When you&#39;re reading values from <code>UserDefaults</code> you need to check the return type carefully to ensure you know what you&#39;re getting. Here&#39;s what you need to know:</p><ul><li><code>integer(forKey:)</code> returns an integer if the key existed, or 0 if not.</li><li><code>bool(forKey:)</code> returns a boolean if the key existed, or false if not.</li><li><code>float(forKey:)</code> returns a float if the key existed, or 0.0 if not.</li><li><code>double(forKey:)</code> returns a double if the key existed, or 0.0 if not.</li><li><code>object(forKey:)</code> returns <code>Any?</code> so you need to conditionally typecast it to your data type.</li></ul><p>Knowing the return values are important, because if you use <code>bool(forKey:)</code> and get back &quot;false&quot;, does that mean the key didn&#39;t exist, or did it perhaps exist and you just set it to be false?</p><p>It&#39;s <code>object(forKey:)</code> that will cause you the most bother, because you get an optional object back. You&#39;re faced with two options, one of which isn&#39;t smart so you realistically have only one option!</p><p>Your options:</p><ul><li>Use <code>as!</code> to force typecast your object to the data type it should be.</li><li>Use <code>as?</code> to optionally typecast your object to the type it should be.</li></ul><p>If you use <code>as!</code> and <code>object(forKey:)</code> returned <code>nil</code>, you&#39;ll get a crash, so I really don&#39;t recommend it unless you&#39;re absolutely sure. But equally, using <code>as?</code> is annoying because you then have to unwrap the optional or create a default value.</p><p>There is a solution here, and it has the catchy name of <em>the nil coalescing operator</em>, and it looks like this: <code>??</code>. This does two things at once: if the object on the left is optional and exists, it gets unwrapped into a non-optional value; if it does not exist, it uses the value on the right instead.</p><p>This means we can use <code>object(forKey:)</code> and <code>as?</code> to get an optional object, then use <code>??</code> to either unwrap the object or set a default value, all in one line.</p><p>For example, let&#39;s say we want to read the array we saved earlier with the key name <code>SavedArray</code>. Here&#39;s how to do that with the <code>nil</code> coalescing operator:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> array <span class="token operator">=</span> defaults<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span>forKey<span class="token punctuation">:</span><span class="token string-literal"><span class="token string">&quot;SavedArray&quot;</span></span><span class="token punctuation">)</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>So, if <code>SavedArray</code> exists and is a string array, it will be placed into the <code>array</code> constant. If it doesn&#39;t exist (or if it does exist and isn&#39;t a string array), then <code>array</code> gets set to be a new string array.</p><p>This technique also works for dictionaries, but obviously you need to typecast it correctly. To read the dictionary we saved earlier, we&#39;d use this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> dict <span class="token operator">=</span> defaults<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span>forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;SavedDict&quot;</span></span><span class="token punctuation">)</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token punctuation">[</span><span class="token class-name">String</span><span class="token punctuation">:</span> <span class="token class-name">St</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,28),U=e("h3",{id:"fixing-project-10-nscoding",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#fixing-project-10-nscoding"},[e("span",null,[a("Fixing Project 10: "),e("code",null,"NSCoding")])])],-1),K={class:"hint-container details"},C=e("summary",null,"Fixing Project 10: NSCoding",-1),T=l(`<p>You&#39;ve just learned all the core basics of working with <code>UserDefaults</code>, but we&#39;re just getting started. You see, above and beyond integers, dates, strings, arrays and so on, you can also save any kind of data inside <code>UserDefaults</code> as long as you follow some rules.</p><p>What happens is simple: you use the <code>archivedData()</code> method of <code>NSKeyedArchiver</code>, which turns an object graph into a <code>Data</code> object, then write that to <code>UserDefaults</code> as if it were any other object. If you were wondering, ‚Äúobject graph‚Äù means ‚Äúyour object, plus any objects it refers to, plus any objects those objects refer to, and so on.‚Äù</p><p>The rules are very simple:</p><ol><li>All your data types must be one of the following: boolean, integer, float, double, string, array, dictionary, <code>Date</code>, or a class that fits rule 2.</li><li>If your data type is a class, it must conform to the <code>NSCoding</code> protocol, which is used for archiving object graphs.</li><li>If your data type is an array or dictionary, all the keys and values must match rule 1 or rule 2.</li></ol><p>Many of Apple&#39;s own classes support <code>NSCoding</code>, including but not limited to: <code>UIColor</code>, <code>UIImage</code>, <code>UIView</code>, <code>UILabel</code>, <code>UIImageView</code>, <code>UITableView</code>, <code>SKSpriteNode</code> and many more. But your own classes do not, at least not by default. If we want to save the <code>people</code> array to <code>UserDefaults</code> we&#39;ll need to conform to the <code>NSCoding</code> protocol.</p><p>The first step is to modify your <code>Person</code> class to this:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span> <span class="token class-name">NSObject</span><span class="token punctuation">,</span> <span class="token class-name">NSCoding</span> <span class="token punctuation">{</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>When we were working on this code in project 10, there were two outstanding questions:</p><ul><li>Why do we need a class here when a struct will do just as well? (And in fact better, because structs come with a default initializer!)</li><li>Why do we need to inherit from <code>NSObject</code>?</li></ul><p>It&#39;s time for the answers to become clear. You see, working with <code>NSCoding</code> requires you to use objects, or, in the case of strings, arrays and dictionaries, structs that are interchangeable with objects. If we made the <code>Person</code> class into a struct, we couldn&#39;t use it with <code>NSCoding</code>.</p><p>The reason we inherit from <code>NSObject</code> is again because it&#39;s required to use <code>NSCoding</code> ‚Äì although cunningly Swift won&#39;t mention that to you, your app will just crash.</p><p>Once you conform to the <code>NSCoding</code> protocol, you&#39;ll get compiler errors because the protocol requires you to implement two methods: a new initializer and <code>encode()</code>.</p><p>We need to write some more code to fix the problems, and although the code is very similar to what you&#39;ve already seen in <code>UserDefaults</code>, it has two new things you need to know about.</p><p>First, you&#39;ll be using a new class called <code>NSCoder</code>. This is responsible for both encoding (writing) and decoding (reading) your data so that it can be used with <code>UserDefaults</code>.</p><p>Second, the new initializer must be declared with the <code>required</code> keyword. This means &quot;if anyone tries to subclass this class, they are required to implement this method.&quot; An alternative to using <code>required</code> is to declare that your class can never be subclassed, known as a <em>final class</em>, in which case you don&#39;t need <code>required</code> because subclassing isn&#39;t possible. We&#39;ll be using <code>required</code> here.</p><p>Add these two methods to the <code>Person</code> class:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">required</span> <span class="token keyword">init</span><span class="token punctuation">(</span>coder aDecoder<span class="token punctuation">:</span> <span class="token class-name">NSCoder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    name <span class="token operator">=</span> aDecoder<span class="token punctuation">.</span><span class="token function">decodeObject</span><span class="token punctuation">(</span>forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;name&quot;</span></span><span class="token punctuation">)</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token class-name">String</span> <span class="token operator">??</span> <span class="token string-literal"><span class="token string">&quot;&quot;</span></span></span>
<span class="line">    image <span class="token operator">=</span> aDecoder<span class="token punctuation">.</span><span class="token function">decodeObject</span><span class="token punctuation">(</span>forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;image&quot;</span></span><span class="token punctuation">)</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token class-name">String</span> <span class="token operator">??</span> <span class="token string-literal"><span class="token string">&quot;&quot;</span></span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">func</span> <span class="token function-definition function">encode</span><span class="token punctuation">(</span>with aCoder<span class="token punctuation">:</span> <span class="token class-name">NSCoder</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    aCoder<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;name&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    aCoder<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;image&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The initializer is used when loading objects of this class, and <code>encode()</code> is used when saving. The code is very similar to using <code>UserDefaults</code>, but here we‚Äôre adding <code>as?</code> typecasting and nil coalescing just in case we get invalid data back.</p><p>With those changes, the <code>Person</code> class now conforms to <code>NSCoding</code>, so we can go back to ViewController.swift and add code to load and save the <code>people</code> array.</p><p>Let&#39;s start with writing, because once you understand that the reading code will make much more sense. As I said earlier, you can write <code>Data</code> objects to <code>UserDefaults</code>, but we don&#39;t currently have a <code>Data</code> object ‚Äì we just have an array.</p><p>Fortunately, the <code>archivedData()</code> method of <code>NSKeyedArchiver</code> turns an object graph into a <code>Data</code> object using those <code>NSCoding</code> methods we just added to our class. Because we make changes to the array by adding people or by renaming them, let&#39;s create a single <code>save()</code> method we can use anywhere that&#39;s needed:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">func</span> <span class="token function-definition function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token keyword">let</span> savedData <span class="token operator">=</span> <span class="token keyword">try</span><span class="token operator">?</span> <span class="token class-name">NSKeyedArchiver</span><span class="token punctuation">.</span><span class="token function">archivedData</span><span class="token punctuation">(</span>withRootObject<span class="token punctuation">:</span> people<span class="token punctuation">,</span> requiringSecureCoding<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">let</span> defaults <span class="token operator">=</span> <span class="token class-name">UserDefaults</span><span class="token punctuation">.</span>standard</span>
<span class="line">        defaults<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>savedData<span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;people&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>So: line 1 is what converts our array into a <code>Data</code> object, then lines 2 and 3 save that data object to <code>UserDefaults</code>. You now just need to call that <code>save()</code> method when we change a person&#39;s name or when we import a new picture.</p><p>You need to modify our collection view&#39;s <code>didSelectItemAt</code> method so that you call <code>self.save()</code> just after calling <code>self.collectionView.reloadData()</code>. Remember, the <code>self</code> is required because we&#39;re inside a closure. You then need to modify the image picker&#39;s <code>didFinishPickingMediaWithInfo</code> method so that it calls <code>save()</code> just before the end of the method.</p><p>And that&#39;s it ‚Äì we only change the data in two places, and both now have a call to <code>save()</code>.</p><p>Finally, we need to load the array back from disk when the app runs, so add this code to <code>viewDidLoad()</code>:</p><div class="language-swift line-numbers-mode" data-highlighter="prismjs" data-ext="swift" data-title="swift"><pre><code><span class="line"><span class="token keyword">let</span> defaults <span class="token operator">=</span> <span class="token class-name">UserDefaults</span><span class="token punctuation">.</span>standard</span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> <span class="token keyword">let</span> savedPeople <span class="token operator">=</span> defaults<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span>forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;people&quot;</span></span><span class="token punctuation">)</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token class-name">Data</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token keyword">let</span> decodedPeople <span class="token operator">=</span> <span class="token keyword">try</span><span class="token operator">?</span> <span class="token class-name">NSKeyedUnarchiver</span><span class="token punctuation">.</span><span class="token function">unarchiveTopLevelObjectWithData</span><span class="token punctuation">(</span>savedPeople<span class="token punctuation">)</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token punctuation">[</span><span class="token class-name">Person</span><span class="token punctuation">]</span> <span class="token punctuation">{</span></span>
<span class="line">        people <span class="token operator">=</span> decodedPeople</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This code is effectively the <code>save()</code> method in reverse: we use the <code>object(forKey:)</code> method to pull out an optional <code>Data</code>, using <code>if let</code> and <code>as?</code> to unwrap it. We then give that to the <code>unarchiveTopLevelObjectWithData()</code> method of <code>NSKeyedUnarchiver</code> to convert it back to an object graph ‚Äì i.e., our array of <code>Person</code> objects.</p>`,28),P=e("hr",null,null,-1);function I(d,A){const n=r("router-link"),t=r("VPCard"),p=r("VidStack");return g(),h("div",null,[e("h1",y,[e("a",w,[e("span",null,k(d.$frontmatter.title)+" Í¥ÄÎ†®",1)])]),e("nav",m,[e("ul",null,[e("li",null,[s(n,{to:"#project-12-part-one"},{default:o(()=>[a("Project 12, part one")]),_:1}),e("ul",null,[e("li",null,[s(n,{to:"#setting-up"},{default:o(()=>[a("Setting up")]),_:1})]),e("li",null,[s(n,{to:"#reading-and-writing-basics-userdefaults"},{default:o(()=>[a("Reading and writing basics: UserDefaults")]),_:1})]),e("li",null,[s(n,{to:"#fixing-project-10-nscoding"},{default:o(()=>[a("Fixing Project 10: NSCoding")]),_:1})])])])])]),b,s(t,i(c({title:"100 Days of Swift - Day 48",desc:"Project 12, part one",link:"https://www.hackingwithswift.com/100/48",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(213,52,58,0.2)"})),null,16),v,e("details",j,[S,s(t,i(c({title:"100 Days of Swift - Day 48 - Setting up",desc:"Setting up",link:"https://hackingwithswift.com/read/12/1/setting-up",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(213,52,58,0.2)"})),null,16),s(p,{src:"youtube/Lf_FCb3nMWU"}),D]),q,e("details",_,[x,s(t,i(c({title:"100 Days of Swift - Day 48 - Reading and writing basics: UserDefaults",desc:"Reading and writing basics: UserDefaults",link:"https://hackingwithswift.com/read/12/2/reading-and-writing-basics-userdefaults",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(213,52,58,0.2)"})),null,16),s(p,{src:"youtube/WHKLXI8baJk"}),N]),U,e("details",K,[C,s(t,i(c({title:"100 Days of Swift - Day 48 - Fixing Project 10: NSCoding",desc:"Fixing Project 10: NSCoding",link:"https://hackingwithswift.com/read/12/3/fixing-project-10-nscoding",logo:"https://www.hackingwithswift.com/favicon.svg",background:"rgba(213,52,58,0.2)"})),null,16),s(p,{src:"youtube/5H3J16QeNnI"}),T]),P])}const R=u(f,[["render",I],["__file","48.html.vue"]]),F=JSON.parse('{"path":"/swift/100-days-of-swift/48.html","title":"Day 48","lang":"ko-KR","frontmatter":{"lang":"ko-KR","title":"Day 48","description":"100 Days of Swift > Day 48","category":["Swift"],"tag":["crashcourse","paul-hudson","swift","hacking-with-swift","xcode","appstore"],"head":[[{"meta":null},{"property":"og:title","content":"100 Days of Swift > Day 48"},{"property":"og:description","content":"Day 48"},{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/swift/100-days-of-swift/48.html"}],["meta",{"property":"og:url","content":"https://chanhi2000.github.io/crashcourse/crashcourse/swift/100-days-of-swift/48.html"}],["meta",{"property":"og:site_name","content":"ü•ÅCrashcourse"}],["meta",{"property":"og:title","content":"Day 48"}],["meta",{"property":"og:description","content":"100 Days of Swift > Day 48"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"ko-KR"}],["meta",{"property":"og:updated_time","content":"2024-10-03T01:20:13.000Z"}],["meta",{"property":"article:tag","content":"crashcourse"}],["meta",{"property":"article:tag","content":"paul-hudson"}],["meta",{"property":"article:tag","content":"swift"}],["meta",{"property":"article:tag","content":"hacking-with-swift"}],["meta",{"property":"article:tag","content":"xcode"}],["meta",{"property":"article:tag","content":"appstore"}],["meta",{"property":"article:modified_time","content":"2024-10-03T01:20:13.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Day 48\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-10-03T01:20:13.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"Project 12, part one","slug":"project-12-part-one","link":"#project-12-part-one","children":[{"level":3,"title":"Setting up","slug":"setting-up","link":"#setting-up","children":[]},{"level":3,"title":"Reading and writing basics: UserDefaults","slug":"reading-and-writing-basics-userdefaults","link":"#reading-and-writing-basics-userdefaults","children":[]},{"level":3,"title":"Fixing Project 10: NSCoding","slug":"fixing-project-10-nscoding","link":"#fixing-project-10-nscoding","children":[]}]}],"git":{"createdTime":1703642364000,"updatedTime":1727918413000,"contributors":[{"name":"chanhi2000","email":"chanhi2000@gmail.com","commits":9}]},"readingTime":{"minutes":8.26,"words":2479},"filePathRelative":"swift/100-days-of-swift/48.md","localizedDate":"2023ÎÖÑ 12Ïõî 27Ïùº","excerpt":"\\n\\n<hr>\\n"}');export{R as comp,F as data};
